!function(window){"use strict";var EventManager=function(){function addAction(action,callback,priority,context){return"string"==typeof action&&"function"==typeof callback&&(priority=parseInt(priority||10,10),_addHook("actions",action,callback,priority,context)),MethodsAvailable}function doAction(){var args=Array.prototype.slice.call(arguments),action=args.shift();return"string"==typeof action&&_runHook("actions",action,args),MethodsAvailable}function removeAction(action,callback){return"string"==typeof action&&_removeHook("actions",action,callback),MethodsAvailable}function addFilter(filter,callback,priority){return"string"==typeof filter&&"function"==typeof callback&&(priority=parseInt(priority||10,10),_addHook("filters",filter,callback,priority)),MethodsAvailable}function applyFilters(){var args=Array.prototype.slice.call(arguments),filter=args.shift();return"string"==typeof filter?_runHook("filters",filter,args):MethodsAvailable}function removeFilter(filter,callback){return"string"==typeof filter&&_removeHook("filters",filter,callback),MethodsAvailable}function _removeHook(type,hook,callback,context){if(STORAGE[type][hook])if(callback){var i,handlers=STORAGE[type][hook];if(context)for(i=handlers.length;i--;){var handler=handlers[i];handler.callback===callback&&handler.context===context&&handlers.splice(i,1)}else for(i=handlers.length;i--;)handlers[i].callback===callback&&handlers.splice(i,1)}else STORAGE[type][hook]=[]}function _addHook(type,hook,callback,priority,context){var hookObject={callback:callback,priority:priority,context:context},hooks=STORAGE[type][hook];hooks?(hooks.push(hookObject),hooks=_hookInsertSort(hooks)):hooks=[hookObject],STORAGE[type][hook]=hooks}function _hookInsertSort(hooks){for(var tmpHook,j,prevHook,i=1,len=hooks.length;len>i;i++){for(tmpHook=hooks[i],j=i;(prevHook=hooks[j-1])&&prevHook.priority>tmpHook.priority;)hooks[j]=hooks[j-1],--j;hooks[j]=tmpHook}return hooks}function _runHook(type,hook,args){var handlers=STORAGE[type][hook];if(!handlers)return"filters"===type?args[0]:!1;var i=0,len=handlers.length;if("filters"===type)for(;len>i;i++)args[0]=handlers[i].callback.apply(handlers[i].context,args);else for(;len>i;i++)handlers[i].callback.apply(handlers[i].context,args);return"filters"===type?args[0]:!0}var MethodsAvailable={removeFilter:removeFilter,applyFilters:applyFilters,addFilter:addFilter,removeAction:removeAction,doAction:doAction,addAction:addAction},STORAGE={actions:{},filters:{}};return MethodsAvailable};window.wp=window.wp||{},window.wp.hooks=new EventManager}(window),window.Modernizr=function(window,document,undefined){function setCss(str){mStyle.cssText=str}function setCssAll(str1,str2){return setCss(prefixes.join(str1+";")+(str2||""))}function is(obj,type){return typeof obj===type}function contains(str,substr){return!!~(""+str).indexOf(substr)}function testProps(props,prefixed){for(var i in props){var prop=props[i];if(!contains(prop,"-")&&mStyle[prop]!==undefined)return"pfx"==prefixed?prop:!0}return!1}function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined)return elem===!1?props[i]:is(item,"function")?item.bind(elem||obj):item}return!1}function testPropsAll(prop,prefixed,elem){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+" "+cssomPrefixes.join(ucProp+" ")+ucProp).split(" ");return is(prefixed,"string")||is(prefixed,"undefined")?testProps(props,prefixed):(props=(prop+" "+domPrefixes.join(ucProp+" ")+ucProp).split(" "),testDOMProps(props,prefixed,elem))}var inputElem,featureName,hasOwnProp,version="2.8.3",Modernizr={},enableClasses=!0,docElement=document.documentElement,mod="modernizr",modElem=document.createElement(mod),mStyle=modElem.style,prefixes=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),omPrefixes="Webkit Moz O ms",cssomPrefixes=omPrefixes.split(" "),domPrefixes=omPrefixes.toLowerCase().split(" "),tests={},classes=[],slice=classes.slice,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement("div"),body=document.body,fakeBody=body||document.createElement("body");if(parseInt(nodes,10))for(;nodes--;)node=document.createElement("div"),node.id=testnames?testnames[nodes]:mod+(nodes+1),div.appendChild(node);return style=["&#173;",'<style id="s',mod,'">',rule,"</style>"].join(""),div.id=mod,(body?div:fakeBody).innerHTML+=style,fakeBody.appendChild(div),body||(fakeBody.style.background="",fakeBody.style.overflow="hidden",docOverflow=docElement.style.overflow,docElement.style.overflow="hidden",docElement.appendChild(fakeBody)),ret=callback(div,rule),body?div.parentNode.removeChild(div):(fakeBody.parentNode.removeChild(fakeBody),docElement.style.overflow=docOverflow),!!ret},isEventSupported=function(){function isEventSupported(eventName,element){element=element||document.createElement(TAGNAMES[eventName]||"div"),eventName="on"+eventName;var isSupported=eventName in element;return isSupported||(element.setAttribute||(element=document.createElement("div")),element.setAttribute&&element.removeAttribute&&(element.setAttribute(eventName,""),isSupported=is(element[eventName],"function"),is(element[eventName],"undefined")||(element[eventName]=undefined),element.removeAttribute(eventName))),element=null,isSupported}var TAGNAMES={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return isEventSupported}(),_hasOwnProperty={}.hasOwnProperty;hasOwnProp=is(_hasOwnProperty,"undefined")||is(_hasOwnProperty.call,"undefined")?function(object,property){return property in object&&is(object.constructor.prototype[property],"undefined")}:function(object,property){return _hasOwnProperty.call(object,property)},Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError;var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F,result=target.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return target.apply(that,args.concat(slice.call(arguments)))};return bound}),tests.touch=function(){var bool;return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?bool=!0:injectElementWithStyles(["@media (",prefixes.join("touch-enabled),("),mod,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(node){bool=9===node.offsetTop}),bool},tests.hashchange=function(){return isEventSupported("hashchange",window)&&(document.documentMode===undefined||document.documentMode>7)},tests.backgroundsize=function(){return testPropsAll("backgroundSize")},tests.opacity=function(){return setCssAll("opacity:.55"),/^0.55$/.test(mStyle.opacity)},tests.cssanimations=function(){return testPropsAll("animationName")},tests.csstransforms=function(){return!!testPropsAll("transform")},tests.csstransforms3d=function(){var ret=!!testPropsAll("perspective");return ret&&"webkitPerspective"in docElement.style&&injectElementWithStyles("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(node){ret=9===node.offsetLeft&&3===node.offsetHeight}),ret},tests.csstransitions=function(){return testPropsAll("transition")};for(var feature in tests)hasOwnProp(tests,feature)&&(featureName=feature.toLowerCase(),Modernizr[featureName]=tests[feature](),classes.push((Modernizr[featureName]?"":"no-")+featureName));return Modernizr.addTest=function(feature,test){if("object"==typeof feature)for(var key in feature)hasOwnProp(feature,key)&&Modernizr.addTest(key,feature[key]);else{if(feature=feature.toLowerCase(),Modernizr[feature]!==undefined)return Modernizr;test="function"==typeof test?test():test,"undefined"!=typeof enableClasses&&enableClasses&&(docElement.className+=" "+(test?"":"no-")+feature),Modernizr[feature]=test}return Modernizr},setCss(""),modElem=inputElem=null,Modernizr._version=version,Modernizr._prefixes=prefixes,Modernizr._domPrefixes=domPrefixes,Modernizr._cssomPrefixes=cssomPrefixes,Modernizr.hasEvent=isEventSupported,Modernizr.testProp=function(prop){return testProps([prop])},Modernizr.testAllProps=testPropsAll,Modernizr.testStyles=injectElementWithStyles,docElement.className=docElement.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(enableClasses?" js "+classes.join(" "):""),Modernizr}(this,this.document),function($,window){function animo(element,options,callback,other_cb){var defaults={duration:1,animation:null,iterate:1,timing:"linear",keep:!1,cleanse:!0};this.prefixes=["","-moz-","-o-animation-","-webkit-"],this.element=$(element),this.bare=element,this.queue=[],this.listening=!1;var cb="function"==typeof callback?callback:other_cb;switch(options){case"blur":defaults={amount:3,duration:.5,focusAfter:null},this.options=$.extend(defaults,callback),this._blur(cb);break;case"focus":this._focus();break;case"rotate":defaults={degrees:15,duration:.5},this.options=$.extend(defaults,callback),this._rotate(cb);break;case"cleanse":this.cleanse();break;default:this.options=$.extend(defaults,options),this.init(cb)}}animo.prototype={init:function(callback){var $me=this;"[object Array]"===Object.prototype.toString.call($me.options.animation)?$.merge($me.queue,$me.options.animation):$me.queue.push($me.options.animation),$me.options.cleanse&&$me.cleanse(),$me.animate(callback)},animate:function(callback){this.element.addClass("animated"),this.element.addClass(this.queue[0]),this.element.data("animo",this.queue[0]);for(var ai=this.prefixes.length;ai--;)this.element.css(this.prefixes[ai]+"animation-duration",this.options.duration+"s"),this.element.css(this.prefixes[ai]+"animation-iteration-count",this.options.iterate),this.element.css(this.prefixes[ai]+"animation-timing-function",this.options.timing);var $me=this,_cb=callback;$me.queue.length>1&&(_cb=null),this._end("AnimationEnd",function(){$me.element.hasClass($me.queue[0])&&($me.options.keep||$me.cleanse(),$me.queue.shift(),$me.queue.length&&$me.animate(callback))},_cb)},cleanse:function(){this.element.removeClass("animated"),this.element.removeClass(this.queue[0]),this.element.removeClass(this.element.data("animo"));for(var ai=this.prefixes.length;ai--;)this.element.css(this.prefixes[ai]+"animation-duration",""),this.element.css(this.prefixes[ai]+"animation-iteration-count",""),this.element.css(this.prefixes[ai]+"animation-timing-function",""),this.element.css(this.prefixes[ai]+"filter","")},_blur:function(callback){if(this.element.is("img")){var svg_id="svg_"+(16777216*(1+Math.random())|0).toString(16).substring(1),filter_id="filter_"+(16777216*(1+Math.random())|0).toString(16).substring(1);$("body").append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" id="'+svg_id+'" style="height:0;position:absolute;top:-1000px;"><filter id="'+filter_id+'"><feGaussianBlur stdDeviation="'+this.options.amount+'" /></filter></svg>');for(var ai=this.prefixes.length;ai--;)this.element.css(this.prefixes[ai]+"filter","blur("+this.options.amount+"px)"),this.element.css(this.prefixes[ai]+"transition",this.options.duration+"s all linear");this.element.css("filter","url(#"+filter_id+")"),this.element.data("svgid",svg_id)}else{for(var color=this.element.css("color"),ai=this.prefixes.length;ai--;)this.element.css(this.prefixes[ai]+"transition","all "+this.options.duration+"s linear");this.element.css("text-shadow","0 0 "+this.options.amount+"px "+color),this.element.css("color","transparent")}this._end("TransitionEnd",null,callback);var $me=this;if(this.options.focusAfter)var focus_wait=window.setTimeout(function(){$me._focus(),focus_wait=window.clearTimeout(focus_wait)},1e3*this.options.focusAfter)},_focus:function(){var ai=this.prefixes.length;if(this.element.is("img")){for(;ai--;)this.element.css(this.prefixes[ai]+"filter",""),this.element.css(this.prefixes[ai]+"transition","");var $svg=$("#"+this.element.data("svgid"));$svg.remove()}else{for(;ai--;)this.element.css(this.prefixes[ai]+"transition","");this.element.css("text-shadow",""),this.element.css("color","")}},_rotate:function(callback){for(var ai=this.prefixes.length;ai--;)this.element.css(this.prefixes[ai]+"transition","all "+this.options.duration+"s linear"),this.element.css(this.prefixes[ai]+"transform","rotate("+this.options.degrees+"deg)");this._end("TransitionEnd",null,callback)},_end:function(type,todo,callback){var $me=this,binding=type.toLowerCase()+" webkit"+type+" o"+type+" MS"+type;this.element.bind(binding,function(){$me.element.unbind(binding),"function"==typeof todo&&todo(),"function"==typeof callback&&callback($me)})}},$.fn.animo=function(options,callback,other_cb){return this.each(function(){new animo(this,options,callback,other_cb)})}}(jQuery,window,document),/*!
* FitVids 1.0
*
* Copyright 2013, Chris Coyier - http://css-tricks.com + Dave Rupert - http://daverupert.com
* Credit to Thierry Koblentz - http://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/
* Released under the WTFPL license - http://sam.zoy.org/wtfpl/
*
* Date: Thu Sept 01 18:00:00 2011 -0500
*/
function($){"use strict";$.fn.fitVids=function(options){var settings={customSelector:null};if(!document.getElementById("fit-vids-style")){var div=document.createElement("div"),ref=document.getElementsByTagName("base")[0]||document.getElementsByTagName("script")[0],cssStyles="&shy;<style>.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>";div.className="fit-vids-style",div.id="fit-vids-style",div.style.display="none",div.innerHTML=cssStyles,ref.parentNode.insertBefore(div,ref)}return options&&$.extend(settings,options),this.each(function(){var selectors=["iframe[src*='player.vimeo.com']","iframe[src*='youtube.com']","iframe[src*='youtube-nocookie.com']","iframe[src*='kickstarter.com'][src*='video.html']","object","embed"];settings.customSelector&&selectors.push(settings.customSelector);var $allVideos=$(this).find(selectors.join(","));$allVideos=$allVideos.not("object object"),$allVideos.each(function(){var $this=$(this);if(!("embed"===this.tagName.toLowerCase()&&$this.parent("object").length||$this.parent(".fluid-width-video-wrapper").length)){var height="object"===this.tagName.toLowerCase()||$this.attr("height")&&!isNaN(parseInt($this.attr("height"),10))?parseInt($this.attr("height"),10):$this.height(),width=isNaN(parseInt($this.attr("width"),10))?$this.width():parseInt($this.attr("width"),10),aspectRatio=height/width;if(!$this.attr("id")){var videoID="fitvid"+Math.floor(999999*Math.random());$this.attr("id",videoID)}$this.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*aspectRatio+"%"),$this.removeAttr("height").removeAttr("width")}})})}}(window.jQuery||window.Zepto),/*!
 * eventie v1.0.5
 * event binding helper
 *   eventie.bind( elem, 'click', myFn )
 *   eventie.unbind( elem, 'click', myFn )
 * MIT license
 */
function(window){"use strict";function getIEEvent(obj){var event=window.event;return event.target=event.target||event.srcElement||obj,event}var docElem=document.documentElement,bind=function(){};docElem.addEventListener?bind=function(obj,type,fn){obj.addEventListener(type,fn,!1)}:docElem.attachEvent&&(bind=function(obj,type,fn){obj[type+fn]=fn.handleEvent?function(){var event=getIEEvent(obj);fn.handleEvent.call(fn,event)}:function(){var event=getIEEvent(obj);fn.call(obj,event)},obj.attachEvent("on"+type,obj[type+fn])});var unbind=function(){};docElem.removeEventListener?unbind=function(obj,type,fn){obj.removeEventListener(type,fn,!1)}:docElem.detachEvent&&(unbind=function(obj,type,fn){obj.detachEvent("on"+type,obj[type+fn]);try{delete obj[type+fn]}catch(err){obj[type+fn]=void 0}});var eventie={bind:bind,unbind:unbind};"function"==typeof define&&define.amd?define(eventie):"object"==typeof exports?module.exports=eventie:window.eventie=eventie}(this),/*!
 * EventEmitter v4.2.8 - git.io/ee
 * Oliver Caldwell
 * MIT license
 * @preserve
 */
function(){"use strict";function EventEmitter(){}function indexOfListener(listeners,listener){for(var i=listeners.length;i--;)if(listeners[i].listener===listener)return i;return-1}function alias(name){return function(){return this[name].apply(this,arguments)}}var proto=EventEmitter.prototype,exports=this,originalGlobalValue=exports.EventEmitter;proto.getListeners=function(evt){var response,key,events=this._getEvents();if(evt instanceof RegExp){response={};for(key in events)events.hasOwnProperty(key)&&evt.test(key)&&(response[key]=events[key])}else response=events[evt]||(events[evt]=[]);return response},proto.flattenListeners=function(listeners){var i,flatListeners=[];for(i=0;i<listeners.length;i+=1)flatListeners.push(listeners[i].listener);return flatListeners},proto.getListenersAsObject=function(evt){var response,listeners=this.getListeners(evt);return listeners instanceof Array&&(response={},response[evt]=listeners),response||listeners},proto.addListener=function(evt,listener){var key,listeners=this.getListenersAsObject(evt),listenerIsWrapped="object"==typeof listener;for(key in listeners)listeners.hasOwnProperty(key)&&-1===indexOfListener(listeners[key],listener)&&listeners[key].push(listenerIsWrapped?listener:{listener:listener,once:!1});return this},proto.on=alias("addListener"),proto.addOnceListener=function(evt,listener){return this.addListener(evt,{listener:listener,once:!0})},proto.once=alias("addOnceListener"),proto.defineEvent=function(evt){return this.getListeners(evt),this},proto.defineEvents=function(evts){for(var i=0;i<evts.length;i+=1)this.defineEvent(evts[i]);return this},proto.removeListener=function(evt,listener){var index,key,listeners=this.getListenersAsObject(evt);for(key in listeners)listeners.hasOwnProperty(key)&&(index=indexOfListener(listeners[key],listener),-1!==index&&listeners[key].splice(index,1));return this},proto.off=alias("removeListener"),proto.addListeners=function(evt,listeners){return this.manipulateListeners(!1,evt,listeners)},proto.removeListeners=function(evt,listeners){return this.manipulateListeners(!0,evt,listeners)},proto.manipulateListeners=function(remove,evt,listeners){var i,value,single=remove?this.removeListener:this.addListener,multiple=remove?this.removeListeners:this.addListeners;if("object"!=typeof evt||evt instanceof RegExp)for(i=listeners.length;i--;)single.call(this,evt,listeners[i]);else for(i in evt)evt.hasOwnProperty(i)&&(value=evt[i])&&("function"==typeof value?single.call(this,i,value):multiple.call(this,i,value));return this},proto.removeEvent=function(evt){var key,type=typeof evt,events=this._getEvents();if("string"===type)delete events[evt];else if(evt instanceof RegExp)for(key in events)events.hasOwnProperty(key)&&evt.test(key)&&delete events[key];else delete this._events;return this},proto.removeAllListeners=alias("removeEvent"),proto.emitEvent=function(evt,args){var listener,i,key,response,listeners=this.getListenersAsObject(evt);for(key in listeners)if(listeners.hasOwnProperty(key))for(i=listeners[key].length;i--;)listener=listeners[key][i],listener.once===!0&&this.removeListener(evt,listener.listener),response=listener.listener.apply(this,args||[]),response===this._getOnceReturnValue()&&this.removeListener(evt,listener.listener);return this},proto.trigger=alias("emitEvent"),proto.emit=function(evt){var args=Array.prototype.slice.call(arguments,1);return this.emitEvent(evt,args)},proto.setOnceReturnValue=function(value){return this._onceReturnValue=value,this},proto._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},proto._getEvents=function(){return this._events||(this._events={})},EventEmitter.noConflict=function(){return exports.EventEmitter=originalGlobalValue,EventEmitter},"function"==typeof define&&define.amd?define(function(){return EventEmitter}):"object"==typeof module&&module.exports?module.exports=EventEmitter:this.EventEmitter=EventEmitter}.call(this),/*!
 * imagesLoaded v3.1.8
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
function(window,factory){"use strict";"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(EventEmitter,eventie){return factory(window,EventEmitter,eventie)}):"object"==typeof exports?module.exports=factory(window,require("wolfy87-eventemitter"),require("eventie")):window.imagesLoaded=factory(window,window.EventEmitter,window.eventie)}(window,function(window,EventEmitter,eventie){"use strict";function extend(a,b){for(var prop in b)a[prop]=b[prop];return a}function isArray(obj){return"[object Array]"===objToString.call(obj)}function makeArray(obj){var ary=[];if(isArray(obj))ary=obj;else if("number"==typeof obj.length)for(var i=0,len=obj.length;len>i;i++)ary.push(obj[i]);else ary.push(obj);return ary}function ImagesLoaded(elem,options,onAlways){if(!(this instanceof ImagesLoaded))return new ImagesLoaded(elem,options);"string"==typeof elem&&(elem=document.querySelectorAll(elem)),this.elements=makeArray(elem),this.options=extend({},this.options),"function"==typeof options?onAlways=options:extend(this.options,options),onAlways&&this.on("always",onAlways),this.getImages(),$&&(this.jqDeferred=new $.Deferred);var _this=this;setTimeout(function(){_this.check()})}function LoadingImage(img){this.img=img}function Resource(src){this.src=src,cache[src]=this}var $=window.jQuery,console=window.console,hasConsole="undefined"!=typeof console,objToString=Object.prototype.toString;ImagesLoaded.prototype=new EventEmitter,ImagesLoaded.prototype.options={},ImagesLoaded.prototype.getImages=function(){this.images=[];for(var i=0,len=this.elements.length;len>i;i++){var elem=this.elements[i];"IMG"===elem.nodeName&&this.addImage(elem);var nodeType=elem.nodeType;if(nodeType&&(1===nodeType||9===nodeType||11===nodeType))for(var childElems=elem.querySelectorAll("img"),j=0,jLen=childElems.length;jLen>j;j++){var img=childElems[j];this.addImage(img)}}},ImagesLoaded.prototype.addImage=function(img){var loadingImage=new LoadingImage(img);this.images.push(loadingImage)},ImagesLoaded.prototype.check=function(){function onConfirm(image,message){return _this.options.debug&&hasConsole&&console.log("confirm",image,message),_this.progress(image),checkedCount++,checkedCount===length&&_this.complete(),!0}var _this=this,checkedCount=0,length=this.images.length;if(this.hasAnyBroken=!1,!length)return void this.complete();for(var i=0;length>i;i++){var loadingImage=this.images[i];loadingImage.on("confirm",onConfirm),loadingImage.check()}},ImagesLoaded.prototype.progress=function(image){this.hasAnyBroken=this.hasAnyBroken||!image.isLoaded;var _this=this;setTimeout(function(){_this.emit("progress",_this,image),_this.jqDeferred&&_this.jqDeferred.notify&&_this.jqDeferred.notify(_this,image)})},ImagesLoaded.prototype.complete=function(){var eventName=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var _this=this;setTimeout(function(){if(_this.emit(eventName,_this),_this.emit("always",_this),_this.jqDeferred){var jqMethod=_this.hasAnyBroken?"reject":"resolve";_this.jqDeferred[jqMethod](_this)}})},$&&($.fn.imagesLoaded=function(options,callback){var instance=new ImagesLoaded(this,options,callback);return instance.jqDeferred.promise($(this))}),LoadingImage.prototype=new EventEmitter,LoadingImage.prototype.check=function(){var resource=cache[this.img.src]||new Resource(this.img.src);if(resource.isConfirmed)return void this.confirm(resource.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var _this=this;resource.on("confirm",function(resrc,message){return _this.confirm(resrc.isLoaded,message),!0}),resource.check()},LoadingImage.prototype.confirm=function(isLoaded,message){this.isLoaded=isLoaded,this.emit("confirm",this,message)};var cache={};return Resource.prototype=new EventEmitter,Resource.prototype.check=function(){if(!this.isChecked){var proxyImage=new Image;eventie.bind(proxyImage,"load",this),eventie.bind(proxyImage,"error",this),proxyImage.src=this.src,this.isChecked=!0}},Resource.prototype.handleEvent=function(event){var method="on"+event.type;this[method]&&this[method](event)},Resource.prototype.onload=function(event){this.confirm(!0,"onload"),this.unbindProxyEvents(event)},Resource.prototype.onerror=function(event){this.confirm(!1,"onerror"),this.unbindProxyEvents(event)},Resource.prototype.confirm=function(isLoaded,message){this.isConfirmed=!0,this.isLoaded=isLoaded,this.emit("confirm",this,message)},Resource.prototype.unbindProxyEvents=function(event){eventie.unbind(event.target,"load",this),eventie.unbind(event.target,"error",this)},ImagesLoaded}),function($,window){"use strict";function _init(opts){navtiveSupport&&($body=$("body"),$body.hasClass("pronto")||($.extend(!0,options,opts||{}),options.$container=$(options.container),options.render===$.noop&&(options.render=_renderState),currentURL=window.location.href,_saveState(),$window.on("popstate.pronto",_onPop),pub.enable()))}function _onClick(e){var url=e.currentTarget;if(!(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||window.location.protocol!==url.protocol||window.location.host!==url.host||"_blank"===url.target)){if(url.hash&&url.href.replace(url.hash,"")===window.location.href.replace(location.hash,"")||url.href===window.location.href+"#")return void _saveState();e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),currentURL===url.href?_saveState():_request(url.href)}}function _onPop(e){var data=e.originalEvent.state;data&&(options.modal&&0===visited&&data.url?window.location.href=data.url:data.url!==currentURL&&(options.force?_request(data.url):($window.trigger("pronto.request"),_process(data.url,data.data,data.scroll,!1))))}function _request(url){$window.trigger("pronto.request"),$.ajax({url:url+(url.indexOf("?")>-1?"&"+options.requestKey+"=true":"?"+options.requestKey+"=true"),dataType:"json",xhr:function(){var xhr=new window.XMLHttpRequest;return xhr.addEventListener("progress",function(e){if(e.lengthComputable){var percent=e.loaded/e.total;$window.trigger("pronto.progress",[percent])}},!1),xhr},success:function(response){response="string"==typeof response?$.parseJSON(response):response,_process(url,response,options.jump?0:!1,!0)},error:function(jqXHR,status,error){$window.trigger("pronto.error",[error]);try{var response=$.parseJSON(jqXHR.responseText);_process(url,response,0,!0)}catch(e){}}})}function _process(url,data,scrollTop,doPush){$window.trigger("pronto.load"),_track(url),_saveState(),options.render.call(this,data),currentURL=url,doPush?(history.pushState({url:currentURL,data:data,scroll:scrollTop},"state-"+currentURL,currentURL),visited++):_saveState(),$window.trigger("pronto.render"),scrollTop!==!1&&$window.scrollTop(scrollTop)}function _renderState(data){if("undefined"!=typeof data)for(var key in options.target)options.target.hasOwnProperty(key)&&data.hasOwnProperty(key)&&$(options.target[key]).html(data[key])}function _saveState(){var data=[];for(var key in options.target)options.target.hasOwnProperty(key)&&(data[key]=$(options.target[key]).html());history.replaceState({url:currentURL,data:data,scroll:$window.scrollTop()},"state-"+currentURL,currentURL)}function _track(url){if(url=url.replace(window.location.protocol+"//"+window.location.host,""),options.tracking.legacy)window._gaq=window._gaq||[],window._gaq.push(["_trackPageview",url]);else if(options.tracking.manager){var page={};page[options.tracking.variable]=url,window.dataLayer=window.dataLayer||[],window.dataLayer.push(page),window.dataLayer.push({event:options.tracking.event})}else"function"==typeof ga&&ga("send","pageview",url)}var $body,$window=$(window),navtiveSupport=window.history&&window.history.pushState&&window.history.replaceState,currentURL="",visited=0,options={force:!1,jump:!0,modal:!1,selector:"a",render:$.noop,requestKey:"pronto",target:{title:"title",content:"#pronto"},tracking:{legacy:!1,manager:!1,variable:"currentURL",event:"PageView"}},pub={defaults:function(opts){return options=$.extend(options,opts||{}),$(this)},disable:function(){$body&&$body.hasClass("pronto")&&$body.off("click.pronto").removeClass("pronto")},enable:function(){$body&&!$body.hasClass("pronto")&&$body.on("click.pronto",options.selector,_onClick).addClass("pronto")},load:function(url){navtiveSupport?url&&_request(url):window.location.href=url}};$.pronto=function(method){return pub[method]?pub[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?this:_init.apply(this,arguments)}}(jQuery,this),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return 0==t?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){return 0==t?b:t==d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin(2*(t*d-s)*Math.PI/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158,p=0,a=c;if(0==t)return b;if(2==(t/=d/2))return b+c;if(p||(p=.3*d*1.5),a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return 1>t?-.5*a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p)+b:a*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){return void 0==s&&(s=1.70158),c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){return void 0==s&&(s=1.70158),c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){return void 0==s&&(s=1.70158),(t/=d/2)<1?c/2*t*t*(((s*=1.525)+1)*t-s)+b:c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){return(t/=d)<1/2.75?7.5625*c*t*t+b:2/2.75>t?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:2.5/2.75>t?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},easeInOutBounce:function(x,t,b,c,d){return d/2>t?.5*jQuery.easing.easeInBounce(x,2*t,0,c,d)+b:.5*jQuery.easing.easeOutBounce(x,2*t-d,0,c,d)+.5*c+b}}),/*! iScroll v5.1.2 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
function(window,document,Math){function IScroll(el,options){this.wrapper="string"==typeof el?document.querySelector(el):el,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,mouseWheelScrollsHorizontally:!0,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,stopPropagation:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var i in options)this.options[i]=options[i];this.translateZ=this.options.HWCompositing&&utils.hasPerspective?" translateZ(0)":"",this.options.useTransition=utils.hasTransition&&this.options.useTransition,this.options.useTransform=utils.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function createDefaultScrollbar(direction,interactive,type){var scrollbar=document.createElement("div"),indicator=document.createElement("div");return type===!0&&(scrollbar.style.cssText="position:absolute;z-index:9999",indicator.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),indicator.className="iScrollIndicator","h"==direction?(type===!0&&(scrollbar.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",indicator.style.height="100%"),scrollbar.className="iScrollHorizontalScrollbar"):(type===!0&&(scrollbar.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",indicator.style.width="100%"),scrollbar.className="iScrollVerticalScrollbar"),scrollbar.style.cssText+=";overflow:hidden",interactive||(scrollbar.style.pointerEvents="none"),scrollbar.appendChild(indicator),scrollbar}function Indicator(scroller,options){this.wrapper="string"==typeof options.el?document.querySelector(options.el):options.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=scroller,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var i in options)this.options[i]=options[i];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(utils.addEvent(this.indicator,"touchstart",this),utils.addEvent(window,"touchend",this)),this.options.disablePointer||(utils.addEvent(this.indicator,utils.prefixPointerEvent("pointerdown"),this),utils.addEvent(window,utils.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(utils.addEvent(this.indicator,"mousedown",this),utils.addEvent(window,"mouseup",this))),this.options.fade&&(this.wrapperStyle[utils.style.transform]=this.scroller.translateZ,this.wrapperStyle[utils.style.transitionDuration]=utils.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)},utils=function(){function _prefixStyle(style){return _vendor===!1?!1:""===_vendor?style:_vendor+style.charAt(0).toUpperCase()+style.substr(1)}var me={},_elementStyle=document.createElement("div").style,_vendor=function(){for(var transform,vendors=["t","webkitT","MozT","msT","OT"],i=0,l=vendors.length;l>i;i++)if(transform=vendors[i]+"ransform",transform in _elementStyle)return vendors[i].substr(0,vendors[i].length-1);return!1}();me.getTime=Date.now||function(){return(new Date).getTime()},me.extend=function(target,obj){for(var i in obj)target[i]=obj[i]},me.addEvent=function(el,type,fn,capture){el.addEventListener(type,fn,!!capture)},me.removeEvent=function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture)},me.prefixPointerEvent=function(pointerEvent){return window.MSPointerEvent?"MSPointer"+pointerEvent.charAt(7).toUpperCase()+pointerEvent.substr(8):pointerEvent},me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration){var destination,duration,distance=current-start,speed=Math.abs(distance)/time;return deceleration=void 0===deceleration?6e-4:deceleration,destination=current+speed*speed/(2*deceleration)*(0>distance?-1:1),duration=speed/deceleration,lowerMargin>destination?(destination=wrapperSize?lowerMargin-wrapperSize/2.5*(speed/8):lowerMargin,distance=Math.abs(destination-current),duration=distance/speed):destination>0&&(destination=wrapperSize?wrapperSize/2.5*(speed/8):0,distance=Math.abs(current)+destination,duration=distance/speed),{destination:Math.round(destination),duration:duration}};var _transform=_prefixStyle("transform");return me.extend(me,{hasTransform:_transform!==!1,hasPerspective:_prefixStyle("perspective")in _elementStyle,hasTouch:"ontouchstart"in window,hasPointer:window.PointerEvent||window.MSPointerEvent,hasTransition:_prefixStyle("transition")in _elementStyle}),me.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!/Chrome\/\d/.test(window.navigator.appVersion),me.extend(me.style={},{transform:_transform,transitionTimingFunction:_prefixStyle("transitionTimingFunction"),transitionDuration:_prefixStyle("transitionDuration"),transitionDelay:_prefixStyle("transitionDelay"),transformOrigin:_prefixStyle("transformOrigin")}),me.hasClass=function(e,c){var re=new RegExp("(^|\\s)"+c+"(\\s|$)");return re.test(e.className)},me.addClass=function(e,c){if(!me.hasClass(e,c)){var newclass=e.className.split(" ");newclass.push(c),e.className=newclass.join(" ")}},me.removeClass=function(e,c){if(me.hasClass(e,c)){var re=new RegExp("(^|\\s)"+c+"(\\s|$)","g");e.className=e.className.replace(re," ")}},me.offset=function(el){for(var left=-el.offsetLeft,top=-el.offsetTop;el=el.offsetParent;)left-=el.offsetLeft,top-=el.offsetTop;return{left:left,top:top}},me.preventDefaultException=function(el,exceptions){for(var i in exceptions)if(exceptions[i].test(el[i]))return!0;return!1},me.extend(me.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),me.extend(me.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(k){return k*(2-k)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(k){return Math.sqrt(1- --k*k)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(k){var b=4;return(k-=1)*k*((b+1)*k+b)+1}},bounce:{style:"",fn:function(k){return(k/=1)<1/2.75?7.5625*k*k:2/2.75>k?7.5625*(k-=1.5/2.75)*k+.75:2.5/2.75>k?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375}},elastic:{style:"",fn:function(k){var f=.22,e=.4;return 0===k?0:1==k?1:e*Math.pow(2,-10*k)*Math.sin(2*(k-f/4)*Math.PI/f)+1}}}),me.tap=function(e,eventName){var ev=document.createEvent("Event");ev.initEvent(eventName,!0,!0),ev.pageX=e.pageX,ev.pageY=e.pageY,e.target.dispatchEvent(ev)},me.click=function(e){var ev,target=e.target;/(SELECT|INPUT|TEXTAREA)/i.test(target.tagName)||(ev=document.createEvent("MouseEvents"),ev.initMouseEvent("click",!0,!0,e.view,1,target.screenX,target.screenY,target.clientX,target.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),ev._constructed=!0,target.dispatchEvent(ev))},me}();IScroll.prototype={version:"5.1.2",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(e){if(!(1!=utils.eventType[e.type]&&0!==e.button||!this.enabled||this.initiated&&utils.eventType[e.type]!==this.initiated)){!this.options.preventDefault||utils.isBadAndroid||utils.preventDefaultException(e.target,this.options.preventDefaultException)||e.preventDefault();var pos,point=e.touches?e.touches[0]:e;this.initiated=utils.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=utils.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,pos=this.getComputedPosition(),this._translate(Math.round(pos.x),Math.round(pos.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=point.pageX,this.pointY=point.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&utils.eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault();var newX,newY,absDistX,absDistY,point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=utils.getTime();if(this.pointX=point.pageX,this.pointY=point.pageY,this.distX+=deltaX,this.distY+=deltaY,absDistX=Math.abs(this.distX),absDistY=Math.abs(this.distY),!(timestamp-this.endTime>300&&10>absDistX&&10>absDistY)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=absDistX>absDistY+this.options.directionLockThreshold?"h":absDistY>=absDistX+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)e.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);deltaY=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)e.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);deltaX=0}deltaX=this.hasHorizontalScroll?deltaX:0,deltaY=this.hasVerticalScroll?deltaY:0,newX=this.x+deltaX,newY=this.y+deltaY,(newX>0||newX<this.maxScrollX)&&(newX=this.options.bounce?this.x+deltaX/3:newX>0?0:this.maxScrollX),(newY>0||newY<this.maxScrollY)&&(newY=this.options.bounce?this.y+deltaY/3:newY>0?0:this.maxScrollY),this.directionX=deltaX>0?-1:0>deltaX?1:0,this.directionY=deltaY>0?-1:0>deltaY?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(newX,newY),timestamp-this.startTime>300&&(this.startTime=timestamp,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll")}}},_end:function(e){if(this.enabled&&utils.eventType[e.type]===this.initiated){this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var momentumX,momentumY,duration=(e.changedTouches?e.changedTouches[0]:e,utils.getTime()-this.startTime),newX=Math.round(this.x),newY=Math.round(this.y),distanceX=Math.abs(newX-this.startX),distanceY=Math.abs(newY-this.startY),time=0,easing="";if(this.isInTransition=0,this.initiated=0,this.endTime=utils.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(newX,newY),!this.moved)return this.options.tap&&utils.tap(e,this.options.tap),this.options.click&&utils.click(e),void this._execEvent("scrollCancel");if(this._events.flick&&200>duration&&100>distanceX&&100>distanceY)return void this._execEvent("flick");if(this.options.momentum&&300>duration&&(momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0},momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0},newX=momentumX.destination,newY=momentumY.destination,time=Math.max(momentumX.duration,momentumY.duration),this.isInTransition=1),this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap,time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1e3),Math.min(Math.abs(newY-snap.y),1e3)),300),newX=snap.x,newY=snap.y,this.directionX=0,this.directionY=0,easing=this.options.bounceEasing}return newX!=this.x||newY!=this.y?((newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY)&&(easing=utils.ease.quadratic),void this.scrollTo(newX,newY,time,easing)):void this._execEvent("scrollEnd")}}},_resize:function(){var that=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){that.refresh()},this.options.resizePolling)},resetPosition:function(time){var x=this.x,y=this.y;return time=time||0,!this.hasHorizontalScroll||this.x>0?x=0:this.x<this.maxScrollX&&(x=this.maxScrollX),!this.hasVerticalScroll||this.y>0?y=0:this.y<this.maxScrollY&&(y=this.maxScrollY),x==this.x&&y==this.y?!1:(this.scrollTo(x,y,time,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=utils.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(type,fn){this._events[type]||(this._events[type]=[]),this._events[type].push(fn)},off:function(type,fn){if(this._events[type]){var index=this._events[type].indexOf(fn);index>-1&&this._events[type].splice(index,1)}},_execEvent:function(type){if(this._events[type]){var i=0,l=this._events[type].length;if(l)for(;l>i;i++)this._events[type][i].apply(this,[].slice.call(arguments,1))}},scrollBy:function(x,y,time,easing){x=this.x+x,y=this.y+y,time=time||0,this.scrollTo(x,y,time,easing)},scrollTo:function(x,y,time,easing){easing=easing||utils.ease.circular,this.isInTransition=this.options.useTransition&&time>0,!time||this.options.useTransition&&easing.style?(this._transitionTimingFunction(easing.style),this._transitionTime(time),this._translate(x,y)):this._animate(x,y,time,easing.fn)},scrollToElement:function(el,time,offsetX,offsetY,easing){if(el=el.nodeType?el:this.scroller.querySelector(el)){var pos=utils.offset(el);pos.left-=this.wrapperOffset.left,pos.top-=this.wrapperOffset.top,offsetX===!0&&(offsetX=Math.round(el.offsetWidth/2-this.wrapper.offsetWidth/2)),offsetY===!0&&(offsetY=Math.round(el.offsetHeight/2-this.wrapper.offsetHeight/2)),pos.left-=offsetX||0,pos.top-=offsetY||0,pos.left=pos.left>0?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left,pos.top=pos.top>0?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top,time=void 0===time||null===time||"auto"===time?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time,this.scrollTo(pos.left,pos.top,time,easing)}},_transitionTime:function(time){if(time=time||0,this.scrollerStyle[utils.style.transitionDuration]=time+"ms",!time&&utils.isBadAndroid&&(this.scrollerStyle[utils.style.transitionDuration]="0.001s"),this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].transitionTime(time)},_transitionTimingFunction:function(easing){if(this.scrollerStyle[utils.style.transitionTimingFunction]=easing,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].transitionTimingFunction(easing)},_translate:function(x,y){if(this.options.useTransform?this.scrollerStyle[utils.style.transform]="translate("+x+"px,"+y+"px)"+this.translateZ:(x=Math.round(x),y=Math.round(y),this.scrollerStyle.left=x+"px",this.scrollerStyle.top=y+"px"),this.x=x,this.y=y,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].updatePosition()},_initEvents:function(remove){var eventType=remove?utils.removeEvent:utils.addEvent,target=this.options.bindToWrapper?this.wrapper:window;eventType(window,"orientationchange",this),eventType(window,"resize",this),this.options.click&&eventType(this.wrapper,"click",this,!0),this.options.disableMouse||(eventType(this.wrapper,"mousedown",this),eventType(target,"mousemove",this),eventType(target,"mousecancel",this),eventType(target,"mouseup",this)),utils.hasPointer&&!this.options.disablePointer&&(eventType(this.wrapper,utils.prefixPointerEvent("pointerdown"),this),eventType(target,utils.prefixPointerEvent("pointermove"),this),eventType(target,utils.prefixPointerEvent("pointercancel"),this),eventType(target,utils.prefixPointerEvent("pointerup"),this)),utils.hasTouch&&!this.options.disableTouch&&(eventType(this.wrapper,"touchstart",this),eventType(target,"touchmove",this),eventType(target,"touchcancel",this),eventType(target,"touchend",this)),eventType(this.scroller,"transitionend",this),eventType(this.scroller,"webkitTransitionEnd",this),eventType(this.scroller,"oTransitionEnd",this),eventType(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var x,y,matrix=window.getComputedStyle(this.scroller,null);return this.options.useTransform?(matrix=matrix[utils.style.transform].split(")")[0].split(", "),x=+(matrix[12]||matrix[4]),y=+(matrix[13]||matrix[5])):(x=+matrix.left.replace(/[^-\d.]/g,""),y=+matrix.top.replace(/[^-\d.]/g,"")),{x:x,y:y}},_initIndicators:function(){function _indicatorsMap(fn){for(var i=that.indicators.length;i--;)fn.call(that.indicators[i])}var indicator,interactive=this.options.interactiveScrollbars,customStyle="string"!=typeof this.options.scrollbars,indicators=[],that=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(indicator={el:createDefaultScrollbar("v",interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:!0,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(indicator.el),indicators.push(indicator)),this.options.scrollX&&(indicator={el:createDefaultScrollbar("h",interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:!0,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(indicator.el),indicators.push(indicator))),this.options.indicators&&(indicators=indicators.concat(this.options.indicators));for(var i=indicators.length;i--;)this.indicators.push(new Indicator(this,indicators[i]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){_indicatorsMap(function(){this.fade()})}),this.on("scrollCancel",function(){_indicatorsMap(function(){this.fade()})}),this.on("scrollStart",function(){_indicatorsMap(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){_indicatorsMap(function(){this.fade(1,!0)})})),this.on("refresh",function(){_indicatorsMap(function(){this.refresh()})}),this.on("destroy",function(){_indicatorsMap(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){utils.addEvent(this.wrapper,"wheel",this),utils.addEvent(this.wrapper,"mousewheel",this),utils.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){utils.removeEvent(this.wrapper,"wheel",this),utils.removeEvent(this.wrapper,"mousewheel",this),utils.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(this.enabled){e.preventDefault(),this.options.stopPropagation&&e.stopPropagation();var wheelDeltaX,wheelDeltaY,newX,newY,that=this;if(void 0===this.wheelTimeout&&that._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){that._execEvent("scrollEnd"),that.wheelTimeout=void 0},400),"deltaX"in e)multiply=1===e.deltaMode?this.options.mouseWheelSpeed:1,wheelDeltaX=-e.deltaX*multiply,wheelDeltaY=-e.deltaY*multiply;else if("wheelDeltaX"in e)wheelDeltaX=e.wheelDeltaX/120*this.options.mouseWheelSpeed,wheelDeltaY=e.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in e)wheelDeltaX=wheelDeltaY=e.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in e))return;wheelDeltaX=wheelDeltaY=-e.detail/3*this.options.mouseWheelSpeed}if(wheelDeltaX*=this.options.invertWheelDirection,wheelDeltaY*=this.options.invertWheelDirection,this.hasHorizontalScroll?!this.hasVerticalScroll&&this.options.mouseWheelScrollsHorizontally&&(Math.abs(wheelDeltaX)<Math.abs(wheelDeltaY)&&(wheelDeltaX=wheelDeltaY),wheelDeltaY=0):wheelDeltaX=0,this.hasVerticalScroll||(wheelDeltaY=0),this.options.snap)return newX=this.currentPage.pageX,newY=this.currentPage.pageY,wheelDeltaX>0?newX--:0>wheelDeltaX&&newX++,wheelDeltaY>0?newY--:0>wheelDeltaY&&newY++,void this.goToPage(newX,newY);newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0),newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0),newX>0?newX=0:newX<this.maxScrollX&&(newX=this.maxScrollX),newY>0?newY=0:newY<this.maxScrollY&&(newY=this.maxScrollY),this.scrollTo(newX,newY,0),this.options.probeType>1&&this._execEvent("scroll")}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var l,n,cx,cy,y,el,i=0,m=0,x=0,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(cx=Math.round(stepX/2),cy=Math.round(stepY/2);x>-this.scrollerWidth;){for(this.pages[i]=[],l=0,y=0;y>-this.scrollerHeight;)this.pages[i][l]={x:Math.max(x,this.maxScrollX),y:Math.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy},y-=stepY,l++;x-=stepX,i++}else for(el=this.options.snap,l=el.length,n=-1;l>i;i++)(0===i||el[i].offsetLeft<=el[i-1].offsetLeft)&&(m=0,n++),this.pages[m]||(this.pages[m]=[]),x=Math.max(-el[i].offsetLeft,this.maxScrollX),y=Math.max(-el[i].offsetTop,this.maxScrollY),cx=x-Math.round(el[i].offsetWidth/2),cy=y-Math.round(el[i].offsetHeight/2),this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy},x>this.maxScrollX&&m++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1e3),Math.min(Math.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,time)})},_nearestSnap:function(x,y){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0,l=this.pages.length,m=0;if(Math.abs(x-this.absStartX)<this.snapThresholdX&&Math.abs(y-this.absStartY)<this.snapThresholdY)return this.currentPage;for(x>0?x=0:x<this.maxScrollX&&(x=this.maxScrollX),y>0?y=0:y<this.maxScrollY&&(y=this.maxScrollY);l>i;i++)if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break}for(l=this.pages[i].length;l>m;m++)if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break}return i==this.currentPage.pageX&&(i+=this.directionX,0>i?i=0:i>=this.pages.length&&(i=this.pages.length-1),x=this.pages[i][0].x),m==this.currentPage.pageY&&(m+=this.directionY,0>m?m=0:m>=this.pages[0].length&&(m=this.pages[0].length-1),y=this.pages[0][m].y),{x:x,y:y,pageX:i,pageY:m}},goToPage:function(x,y,time,easing){easing=easing||this.options.bounceEasing,x>=this.pages.length?x=this.pages.length-1:0>x&&(x=0),y>=this.pages[x].length?y=this.pages[x].length-1:0>y&&(y=0);var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=void 0===time?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1e3),Math.min(Math.abs(posY-this.y),1e3)),300):time,this.currentPage={x:posX,y:posY,pageX:x,pageY:y},this.scrollTo(posX,posY,time,easing)},next:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++,x>=this.pages.length&&this.hasVerticalScroll&&(x=0,y++),this.goToPage(x,y,time,easing)},prev:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--,0>x&&this.hasVerticalScroll&&(x=0,y--),this.goToPage(x,y,time,easing)},_initKeys:function(){var i,keys={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in keys)this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i];utils.addEvent(window,"keydown",this),this.on("destroy",function(){utils.removeEvent(window,"keydown",this)})},_key:function(e){if(this.enabled){var pos,snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,newY=snap?this.currentPage.pageY:this.y,now=utils.getTime(),prevTime=this.keyTime||0,acceleration=.25;switch(this.options.useTransition&&this.isInTransition&&(pos=this.getComputedPosition(),this._translate(Math.round(pos.x),Math.round(pos.y)),this.isInTransition=!1),this.keyAcceleration=200>now-prevTime?Math.min(this.keyAcceleration+acceleration,50):0,e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?newX+=snap?1:this.wrapperWidth:newY+=snap?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?newX-=snap?1:this.wrapperWidth:newY-=snap?1:this.wrapperHeight;break;case this.options.keyBindings.end:newX=snap?this.pages.length-1:this.maxScrollX,newY=snap?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newX=0,newY=0;break;case this.options.keyBindings.left:newX+=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=snap?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=snap?1:5+this.keyAcceleration>>0;break;default:return}if(snap)return void this.goToPage(newX,newY);newX>0?(newX=0,this.keyAcceleration=0):newX<this.maxScrollX&&(newX=this.maxScrollX,this.keyAcceleration=0),newY>0?(newY=0,this.keyAcceleration=0):newY<this.maxScrollY&&(newY=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(newX,newY,0),this.keyTime=now}},_animate:function(destX,destY,duration,easingFn){function step(){var newX,newY,easing,now=utils.getTime();return now>=destTime?(that.isAnimating=!1,that._translate(destX,destY),void(that.resetPosition(that.options.bounceTime)||that._execEvent("scrollEnd"))):(now=(now-startTime)/duration,easing=easingFn(now),newX=(destX-startX)*easing+startX,newY=(destY-startY)*easing+startY,that._translate(newX,newY),that.isAnimating&&rAF(step),void(3==that.options.probeType&&that._execEvent("scroll")))}var that=this,startX=this.x,startY=this.y,startTime=utils.getTime(),destTime=startTime+duration;this.isAnimating=!0,step()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||(e.preventDefault(),e.stopPropagation())}}},Indicator.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(utils.removeEvent(this.indicator,"touchstart",this),utils.removeEvent(this.indicator,utils.prefixPointerEvent("pointerdown"),this),utils.removeEvent(this.indicator,"mousedown",this),utils.removeEvent(window,"touchmove",this),utils.removeEvent(window,utils.prefixPointerEvent("pointermove"),this),utils.removeEvent(window,"mousemove",this),utils.removeEvent(window,"touchend",this),utils.removeEvent(window,utils.prefixPointerEvent("pointerup"),this),utils.removeEvent(window,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault(),this.options.stopPropagation&&e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=point.pageX,this.lastPointY=point.pageY,this.startTime=utils.getTime(),this.options.disableTouch||utils.addEvent(window,"touchmove",this),this.options.disablePointer||utils.addEvent(window,utils.prefixPointerEvent("pointermove"),this),this.options.disableMouse||utils.addEvent(window,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var deltaX,deltaY,newX,newY,point=e.touches?e.touches[0]:e,timestamp=utils.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,deltaX=point.pageX-this.lastPointX,this.lastPointX=point.pageX,deltaY=point.pageY-this.lastPointY,this.lastPointY=point.pageY,newX=this.x+deltaX,newY=this.y+deltaY,this._pos(newX,newY),1==this.scroller.options.probeType&&timestamp-this.startTime>300?(this.startTime=timestamp,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),e.preventDefault(),e.stopPropagation()},_end:function(e){if(this.initiated){if(this.initiated=!1,e.preventDefault(),e.stopPropagation(),utils.removeEvent(window,"touchmove",this),utils.removeEvent(window,utils.prefixPointerEvent("pointermove"),this),utils.removeEvent(window,"mousemove",this),this.scroller.options.snap){var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1e3),Math.min(Math.abs(this.scroller.y-snap.y),1e3)),300);

(this.scroller.x!=snap.x||this.scroller.y!=snap.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=snap,this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(time){time=time||0,this.indicatorStyle[utils.style.transitionDuration]=time+"ms",!time&&utils.isBadAndroid&&(this.indicatorStyle[utils.style.transitionDuration]="0.001s")},transitionTimingFunction:function(easing){this.indicatorStyle[utils.style.transitionTimingFunction]=easing},refresh:function(){this.transitionTime(),this.indicatorStyle.display=this.options.listenX&&!this.options.listenY?this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.scroller.hasVerticalScroll?"block":"none":this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(utils.addClass(this.wrapper,"iScrollBothScrollbars"),utils.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(utils.removeClass(this.wrapper,"iScrollBothScrollbars"),utils.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(x<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=Math.max(this.indicatorWidth+x,8),this.indicatorStyle.width=this.width+"px"),x=this.minBoundaryX):x>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",x=this.maxPosX+this.indicatorWidth-this.width):x=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),y<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=Math.max(this.indicatorHeight+3*y,8),this.indicatorStyle.height=this.height+"px"),y=this.minBoundaryY):y>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=Math.max(this.indicatorHeight-3*(y-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",y=this.maxPosY+this.indicatorHeight-this.height):y=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=x,this.y=y,this.scroller.options.useTransform?this.indicatorStyle[utils.style.transform]="translate("+x+"px,"+y+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=x+"px",this.indicatorStyle.top=y+"px")},_pos:function(x,y){0>x?x=0:x>this.maxPosX&&(x=this.maxPosX),0>y?y=0:y>this.maxPosY&&(y=this.maxPosY),x=this.options.listenX?Math.round(x/this.sizeRatioX):this.scroller.x,y=this.options.listenY?Math.round(y/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(x,y)},fade:function(val,hold){if(!hold||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var time=val?250:500,delay=val?0:300;val=val?"1":"0",this.wrapperStyle[utils.style.transitionDuration]=time+"ms",this.fadeTimeout=setTimeout(function(val){this.wrapperStyle.opacity=val,this.visible=+val}.bind(this,val),delay)}}},IScroll.utils=utils,"undefined"!=typeof module&&module.exports?module.exports=IScroll:window.IScroll=IScroll}(window,document,Math),/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory("object"==typeof exports?require("jquery"):jQuery)}(function($){function encode(s){return config.raw?s:encodeURIComponent(s)}function decode(s){return config.raw?s:decodeURIComponent(s)}function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value))}function parseCookieValue(s){0===s.indexOf('"')&&(s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s=decodeURIComponent(s.replace(pluses," ")),config.json?JSON.parse(s):s}catch(e){}}function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value}var pluses=/\+/g,config=$.cookie=function(key,value,options){if(void 0!==value&&!$.isFunction(value)){if(options=$.extend({},config.defaults,options),"number"==typeof options.expires){var days=options.expires,t=options.expires=new Date;t.setTime(+t+864e5*days)}return document.cookie=[encode(key),"=",stringifyCookieValue(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}for(var result=key?void 0:{},cookies=document.cookie?document.cookie.split("; "):[],i=0,l=cookies.length;l>i;i++){var parts=cookies[i].split("="),name=decode(parts.shift()),cookie=parts.join("=");if(key&&key===name){result=read(cookie,value);break}key||void 0===(cookie=read(cookie))||(result[name]=cookie)}return result};config.defaults={},$.removeCookie=function(key,options){return void 0===$.cookie(key)?!1:($.cookie(key,"",$.extend({},options,{expires:-1})),!$.cookie(key))}}),function(window){function isArraylike(obj){var length=obj.length,type=$.type(obj);return"function"===type||$.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}if(!window.jQuery){var $=function(selector,context){return new $.fn.init(selector,context)};$.isWindow=function(obj){return null!=obj&&obj==obj.window},$.type=function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},$.isArray=Array.isArray||function(obj){return"array"===$.type(obj)},$.isPlainObject=function(obj){var key;if(!obj||"object"!==$.type(obj)||obj.nodeType||$.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(key in obj);return void 0===key||hasOwn.call(obj,key)},$.each=function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},$.data=function(node,key,value){if(void 0===value){var id=node[$.expando],store=id&&cache[id];if(void 0===key)return store;if(store&&key in store)return store[key]}else if(void 0!==key){var id=node[$.expando]||(node[$.expando]=++$.uuid);return cache[id]=cache[id]||{},cache[id][key]=value,value}},$.removeData=function(node,keys){var id=node[$.expando],store=id&&cache[id];store&&$.each(keys,function(_,key){delete store[key]})},$.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"!=typeof target&&"function"!==$.type(target)&&(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&($.isPlainObject(copy)||(copyIsArray=$.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&$.isArray(src)?src:[]):clone=src&&$.isPlainObject(src)?src:{},target[name]=$.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},$.queue=function(elem,type,data){function $makeArray(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?!function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;)first[i++]=second[j++];if(len!==len)for(;void 0!==second[j];)first[i++]=second[j++];return first.length=i,first}(ret,"string"==typeof arr?[arr]:arr):[].push.call(ret,arr)),ret}if(elem){type=(type||"fx")+"queue";var q=$.data(elem,type);return data?(!q||$.isArray(data)?q=$.data(elem,type,$makeArray(data)):q.push(data),q):q||[]}},$.dequeue=function(elems,type){$.each(elems.nodeType?[elems]:elems,function(i,elem){type=type||"fx";var queue=$.queue(elem,type),fn=queue.shift();"inprogress"===fn&&(fn=queue.shift()),fn&&("fx"===type&&queue.unshift("inprogress"),fn.call(elem,function(){$.dequeue(elem,type)}))})},$.fn=$.prototype={init:function(selector){if(selector.nodeType)return this[0]=selector,this;throw new Error("Not a DOM node.")},offset:function(){var box=this[0].getBoundingClientRect();return{top:box.top+(window.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:box.left+(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function offsetParent(){for(var offsetParent=this.offsetParent||document;offsetParent&&"html"===!offsetParent.nodeType.toLowerCase&&"static"===offsetParent.style.position;)offsetParent=offsetParent.offsetParent;return offsetParent||document}var elem=this[0],offsetParent=offsetParent.apply(elem),offset=this.offset(),parentOffset=/^(?:body|html)$/i.test(offsetParent.nodeName)?{top:0,left:0}:$(offsetParent).offset();return offset.top-=parseFloat(elem.style.marginTop)||0,offset.left-=parseFloat(elem.style.marginLeft)||0,offsetParent.style&&(parentOffset.top+=parseFloat(offsetParent.style.borderTopWidth)||0,parentOffset.left+=parseFloat(offsetParent.style.borderLeftWidth)||0),{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}}};var cache={};$.expando="velocity"+(new Date).getTime(),$.uuid=0;for(var class2type={},hasOwn=class2type.hasOwnProperty,toString=class2type.toString,types="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i<types.length;i++)class2type["[object "+types[i]+"]"]=types[i].toLowerCase();$.fn.init.prototype=$.fn,window.Velocity={Utilities:$}}}(window),function(factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=factory():"function"==typeof define&&define.amd?define(factory):factory()}(function(){return function(global,window,document,undefined){function compactSparseArray(array){for(var index=-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];value&&result.push(value)}return result}function sanitizeElements(elements){return Type.isWrapped(elements)?elements=[].slice.call(elements):Type.isNode(elements)&&(elements=[elements]),elements}function Data(element){var response=$.data(element,"velocity");return null===response?undefined:response}function generateStep(steps){return function(p){return Math.round(p*steps)*(1/steps)}}function generateBezier(mX1,mY1,mX2,mY2){function A(aA1,aA2){return 1-3*aA2+3*aA1}function B(aA1,aA2){return 3*aA2-6*aA1}function C(aA1){return 3*aA1}function calcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}function getSlope(aT,aA1,aA2){return 3*A(aA1,aA2)*aT*aT+2*B(aA1,aA2)*aT+C(aA1)}function newtonRaphsonIterate(aX,aGuessT){for(var i=0;NEWTON_ITERATIONS>i;++i){var currentSlope=getSlope(aGuessT,mX1,mX2);if(0===currentSlope)return aGuessT;var currentX=calcBezier(aGuessT,mX1,mX2)-aX;aGuessT-=currentX/currentSlope}return aGuessT}function calcSampleValues(){for(var i=0;kSplineTableSize>i;++i)mSampleValues[i]=calcBezier(i*kSampleStepSize,mX1,mX2)}function binarySubdivide(aX,aA,aB){var currentX,currentT,i=0;do currentT=aA+(aB-aA)/2,currentX=calcBezier(currentT,mX1,mX2)-aX,currentX>0?aB=currentT:aA=currentT;while(Math.abs(currentX)>SUBDIVISION_PRECISION&&++i<SUBDIVISION_MAX_ITERATIONS);return currentT}function getTForX(aX){for(var intervalStart=0,currentSample=1,lastSample=kSplineTableSize-1;currentSample!=lastSample&&mSampleValues[currentSample]<=aX;++currentSample)intervalStart+=kSampleStepSize;--currentSample;var dist=(aX-mSampleValues[currentSample])/(mSampleValues[currentSample+1]-mSampleValues[currentSample]),guessForT=intervalStart+dist*kSampleStepSize,initialSlope=getSlope(guessForT,mX1,mX2);return initialSlope>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(aX,guessForT):0==initialSlope?guessForT:binarySubdivide(aX,intervalStart,intervalStart+kSampleStepSize)}function precompute(){_precomputed=!0,(mX1!=mY1||mX2!=mY2)&&calcSampleValues()}var NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported="Float32Array"in window;if(4!==arguments.length)return!1;for(var i=0;4>i;++i)if("number"!=typeof arguments[i]||isNaN(arguments[i])||!isFinite(arguments[i]))return!1;mX1=Math.min(mX1,1),mX2=Math.min(mX2,1),mX1=Math.max(mX1,0),mX2=Math.max(mX2,0);var mSampleValues=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),_precomputed=!1,f=function(aX){return _precomputed||precompute(),mX1===mY1&&mX2===mY2?aX:0===aX?0:1===aX?1:calcBezier(getTForX(aX),mY1,mY2)};f.getControlPoints=function(){return[{x:mX1,y:mY1},{x:mX2,y:mY2}]};var str="generateBezier("+[mX1,mY1,mX2,mY2]+")";return f.toString=function(){return str},f}function getEasing(value,duration){var easing=value;return Type.isString(value)?Velocity.Easings[value]||(easing=!1):easing=Type.isArray(value)&&1===value.length?generateStep.apply(null,value):Type.isArray(value)&&2===value.length?generateSpringRK4.apply(null,value.concat([duration])):Type.isArray(value)&&4===value.length?generateBezier.apply(null,value):!1,easing===!1&&(easing=Velocity.Easings[Velocity.defaults.easing]?Velocity.defaults.easing:EASING_DEFAULT),easing}function tick(timestamp){if(timestamp)for(var timeCurrent=(new Date).getTime(),i=0,callsLength=Velocity.State.calls.length;callsLength>i;i++)if(Velocity.State.calls[i]){var callContainer=Velocity.State.calls[i],call=callContainer[0],opts=callContainer[2],timeStart=callContainer[3];timeStart||(timeStart=Velocity.State.calls[i][3]=timeCurrent-16);for(var percentComplete=Math.min((timeCurrent-timeStart)/opts.duration,1),j=0,callLength=call.length;callLength>j;j++){var tweensContainer=call[j],element=tweensContainer.element;if(Data(element)){var transformPropertyExists=!1;if(opts.display!==undefined&&null!==opts.display&&"none"!==opts.display){if("flex"===opts.display){var flexValues=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];$.each(flexValues,function(i,flexValue){CSS.setPropertyValue(element,"display",flexValue)})}CSS.setPropertyValue(element,"display",opts.display)}opts.visibility&&"hidden"!==opts.visibility&&CSS.setPropertyValue(element,"visibility",opts.visibility);for(var property in tweensContainer)if("element"!==property){var currentValue,tween=tweensContainer[property],easing=Type.isString(tween.easing)?Velocity.Easings[tween.easing]:tween.easing;if(currentValue=1===percentComplete?tween.endValue:tween.startValue+(tween.endValue-tween.startValue)*easing(percentComplete),tween.currentValue=currentValue,CSS.Hooks.registered[property]){var hookRoot=CSS.Hooks.getRoot(property),rootPropertyValueCache=Data(element).rootPropertyValueCache[hookRoot];rootPropertyValueCache&&(tween.rootPropertyValue=rootPropertyValueCache)}var adjustedSetData=CSS.setPropertyValue(element,property,tween.currentValue+(0===parseFloat(currentValue)?"":tween.unitType),tween.rootPropertyValue,tween.scrollData);CSS.Hooks.registered[property]&&(Data(element).rootPropertyValueCache[hookRoot]=CSS.Normalizations.registered[hookRoot]?CSS.Normalizations.registered[hookRoot]("extract",null,adjustedSetData[1]):adjustedSetData[1]),"transform"===adjustedSetData[0]&&(transformPropertyExists=!0)}opts.mobileHA&&Data(element).transformCache.translate3d===undefined&&(Data(element).transformCache.translate3d="(0px, 0px, 0px)",transformPropertyExists=!0),transformPropertyExists&&CSS.flushTransformCache(element)}}opts.display!==undefined&&"none"!==opts.display&&(Velocity.State.calls[i][2].display=!1),opts.visibility&&"hidden"!==opts.visibility&&(Velocity.State.calls[i][2].visibility=!1),opts.progress&&opts.progress.call(callContainer[1],callContainer[1],percentComplete,Math.max(0,timeStart+opts.duration-timeCurrent),timeStart),1===percentComplete&&completeCall(i)}Velocity.State.isTicking&&ticker(tick)}function completeCall(callIndex,isStopped){if(!Velocity.State.calls[callIndex])return!1;for(var call=Velocity.State.calls[callIndex][0],elements=Velocity.State.calls[callIndex][1],opts=Velocity.State.calls[callIndex][2],resolver=Velocity.State.calls[callIndex][4],remainingCallsExist=!1,i=0,callLength=call.length;callLength>i;i++){var element=call[i].element;if(isStopped||opts.loop||("none"===opts.display&&CSS.setPropertyValue(element,"display",opts.display),"hidden"===opts.visibility&&CSS.setPropertyValue(element,"visibility",opts.visibility)),($.queue(element)[1]===undefined||!/\.velocityQueueEntryFlag/i.test($.queue(element)[1]))&&Data(element)){Data(element).isAnimating=!1,Data(element).rootPropertyValueCache={};var transformHAPropertyExists=!1;$.each(CSS.Lists.transforms3D,function(i,transformName){var defaultValue=/^scale/.test(transformName)?1:0,currentValue=Data(element).transformCache[transformName];Data(element).transformCache[transformName]!==undefined&&new RegExp("^\\("+defaultValue+"[^.]").test(currentValue)&&(transformHAPropertyExists=!0,delete Data(element).transformCache[transformName])}),opts.mobileHA&&(transformHAPropertyExists=!0,delete Data(element).transformCache.translate3d),transformHAPropertyExists&&CSS.flushTransformCache(element),CSS.Values.removeClass(element,"velocity-animating")}if(!isStopped&&opts.complete&&!opts.loop&&i===callLength-1)try{opts.complete.call(elements,elements)}catch(error){setTimeout(function(){throw error},1)}resolver&&opts.loop!==!0&&resolver(elements),opts.loop!==!0||isStopped||($.each(Data(element).tweensContainer,function(propertyName,tweenContainer){/^rotate/.test(propertyName)&&360===parseFloat(tweenContainer.endValue)&&(tweenContainer.endValue=0,tweenContainer.startValue=360)}),Velocity(element,"reverse",{loop:!0,delay:opts.delay})),opts.queue!==!1&&$.dequeue(element,opts.queue)}Velocity.State.calls[callIndex]=!1;for(var j=0,callsLength=Velocity.State.calls.length;callsLength>j;j++)if(Velocity.State.calls[j]!==!1){remainingCallsExist=!0;break}remainingCallsExist===!1&&(Velocity.State.isTicking=!1,delete Velocity.State.calls,Velocity.State.calls=[])}var $,IE=function(){if(document.documentMode)return document.documentMode;for(var i=7;i>4;i--){var div=document.createElement("div");if(div.innerHTML="<!--[if IE "+i+"]><span></span><![endif]-->",div.getElementsByTagName("span").length)return div=null,i}return undefined}(),rAFShim=function(){var timeLast=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){var timeDelta,timeCurrent=(new Date).getTime();return timeDelta=Math.max(0,16-(timeCurrent-timeLast)),timeLast=timeCurrent+timeDelta,setTimeout(function(){callback(timeCurrent+timeDelta)},timeDelta)}}(),Type={isString:function(variable){return"string"==typeof variable},isArray:Array.isArray||function(variable){return"[object Array]"===Object.prototype.toString.call(variable)},isFunction:function(variable){return"[object Function]"===Object.prototype.toString.call(variable)},isNode:function(variable){return variable&&variable.nodeType},isNodeList:function(variable){return"object"==typeof variable&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(variable))&&variable.length!==undefined&&(0===variable.length||"object"==typeof variable[0]&&variable[0].nodeType>0)},isWrapped:function(variable){return variable&&(variable.jquery||window.Zepto&&window.Zepto.zepto.isZ(variable))},isSVG:function(variable){return window.SVGElement&&variable instanceof SVGElement},isEmptyObject:function(variable){var name;for(name in variable)return!1;return!0}},isJQuery=!1;if(global.fn&&global.fn.jquery?($=global,isJQuery=!0):$=window.Velocity.Utilities,8>=IE&&!isJQuery)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=IE)return void(jQuery.fn.velocity=jQuery.fn.animate);var DURATION_DEFAULT=400,EASING_DEFAULT="swing",Velocity={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:window.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:document.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:$,Sequences:{},Easings:{},Promise:window.Promise,defaults:{queue:"",duration:DURATION_DEFAULT,easing:EASING_DEFAULT,begin:null,complete:null,progress:null,display:undefined,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(element){$.data(element,"velocity",{isSVG:Type.isSVG(element),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},animate:null,hook:null,mock:!1,version:{major:1,minor:0,patch:0},debug:!1};window.pageYOffset!==undefined?(Velocity.State.scrollAnchor=window,Velocity.State.scrollPropertyLeft="pageXOffset",Velocity.State.scrollPropertyTop="pageYOffset"):(Velocity.State.scrollAnchor=document.documentElement||document.body.parentNode||document.body,Velocity.State.scrollPropertyLeft="scrollLeft",Velocity.State.scrollPropertyTop="scrollTop");var generateSpringRK4=function(){function springAccelerationForState(state){return-state.tension*state.x-state.friction*state.v}function springEvaluateStateWithDerivative(initialState,dt,derivative){var state={x:initialState.x+derivative.dx*dt,v:initialState.v+derivative.dv*dt,tension:initialState.tension,friction:initialState.friction};return{dx:state.v,dv:springAccelerationForState(state)}}function springIntegrateState(state,dt){var a={dx:state.v,dv:springAccelerationForState(state)},b=springEvaluateStateWithDerivative(state,.5*dt,a),c=springEvaluateStateWithDerivative(state,.5*dt,b),d=springEvaluateStateWithDerivative(state,dt,c),dxdt=1/6*(a.dx+2*(b.dx+c.dx)+d.dx),dvdt=1/6*(a.dv+2*(b.dv+c.dv)+d.dv);return state.x=state.x+dxdt*dt,state.v=state.v+dvdt*dt,state}return function springRK4Factory(tension,friction,duration){var have_duration,dt,last_state,initState={x:-1,v:0,tension:null,friction:null},path=[0],time_lapsed=0,tolerance=1e-4,DT=.016;for(tension=parseFloat(tension)||500,friction=parseFloat(friction)||20,duration=duration||null,initState.tension=tension,initState.friction=friction,have_duration=null!==duration,have_duration?(time_lapsed=springRK4Factory(tension,friction),dt=time_lapsed/duration*DT):dt=DT;;)if(last_state=springIntegrateState(last_state||initState,dt),path.push(1+last_state.x),time_lapsed+=16,!(Math.abs(last_state.x)>tolerance&&Math.abs(last_state.v)>tolerance))break;return have_duration?function(percentComplete){return path[percentComplete*(path.length-1)|0]}:time_lapsed}}();Velocity.Easings={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},spring:function(p){return 1-Math.cos(4.5*p*Math.PI)*Math.exp(6*-p)}},$.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(i,easingArray){Velocity.Easings[easingArray[0]]=generateBezier.apply(null,easingArray[1])});var CSS=Velocity.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var i=0;i<CSS.Lists.colors.length;i++)CSS.Hooks.templates[CSS.Lists.colors[i]]=["Red Green Blue Alpha","255 255 255 1"];var rootProperty,hookTemplate,hookNames;if(IE)for(rootProperty in CSS.Hooks.templates){hookTemplate=CSS.Hooks.templates[rootProperty],hookNames=hookTemplate[0].split(" ");var defaultValues=hookTemplate[1].match(CSS.RegEx.valueSplit);"Color"===hookNames[0]&&(hookNames.push(hookNames.shift()),defaultValues.push(defaultValues.shift()),CSS.Hooks.templates[rootProperty]=[hookNames.join(" "),defaultValues.join(" ")])}for(rootProperty in CSS.Hooks.templates){hookTemplate=CSS.Hooks.templates[rootProperty],hookNames=hookTemplate[0].split(" ");for(var i in hookNames){var fullHookName=rootProperty+hookNames[i],hookPosition=i;CSS.Hooks.registered[fullHookName]=[rootProperty,hookPosition]}}},getRoot:function(property){var hookData=CSS.Hooks.registered[property];return hookData?hookData[0]:property},cleanRootPropertyValue:function(rootProperty,rootPropertyValue){return CSS.RegEx.valueUnwrap.test(rootPropertyValue)&&(rootPropertyValue=rootPropertyValue.match(CSS.Hooks.RegEx.valueUnwrap)[1]),CSS.Values.isCSSNullValue(rootPropertyValue)&&(rootPropertyValue=CSS.Hooks.templates[rootProperty][1]),rootPropertyValue},extractValue:function(fullHookName,rootPropertyValue){var hookData=CSS.Hooks.registered[fullHookName];if(hookData){var hookRoot=hookData[0],hookPosition=hookData[1];return rootPropertyValue=CSS.Hooks.cleanRootPropertyValue(hookRoot,rootPropertyValue),rootPropertyValue.toString().match(CSS.RegEx.valueSplit)[hookPosition]}return rootPropertyValue},injectValue:function(fullHookName,hookValue,rootPropertyValue){var hookData=CSS.Hooks.registered[fullHookName];if(hookData){var rootPropertyValueParts,rootPropertyValueUpdated,hookRoot=hookData[0],hookPosition=hookData[1];return rootPropertyValue=CSS.Hooks.cleanRootPropertyValue(hookRoot,rootPropertyValue),rootPropertyValueParts=rootPropertyValue.toString().match(CSS.RegEx.valueSplit),rootPropertyValueParts[hookPosition]=hookValue,rootPropertyValueUpdated=rootPropertyValueParts.join(" ")}return rootPropertyValue}},Normalizations:{registered:{clip:function(type,element,propertyValue){switch(type){case"name":return"clip";case"extract":var extracted;return CSS.RegEx.wrappedValueAlreadyExtracted.test(propertyValue)?extracted=propertyValue:(extracted=propertyValue.toString().match(CSS.RegEx.valueUnwrap),extracted=extracted?extracted[1].replace(/,(\s+)?/g," "):propertyValue),extracted;case"inject":return"rect("+propertyValue+")"}},opacity:function(type,element,propertyValue){if(8>=IE)switch(type){case"name":return"filter";case"extract":var extracted=propertyValue.toString().match(/alpha\(opacity=(.*)\)/i);return propertyValue=extracted?extracted[1]/100:1;case"inject":return element.style.zoom=1,parseFloat(propertyValue)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(propertyValue),10)+")"}else switch(type){case"name":return"opacity";case"extract":return propertyValue;case"inject":return propertyValue}}},register:function(){9>=IE||Velocity.State.isGingerbread||(CSS.Lists.transformsBase=CSS.Lists.transformsBase.concat(CSS.Lists.transforms3D));for(var i=0;i<CSS.Lists.transformsBase.length;i++)!function(){var transformName=CSS.Lists.transformsBase[i];CSS.Normalizations.registered[transformName]=function(type,element,propertyValue){switch(type){case"name":return"transform";case"extract":return Data(element)===undefined||Data(element).transformCache[transformName]===undefined?/^scale/i.test(transformName)?1:0:Data(element).transformCache[transformName].replace(/[()]/g,"");case"inject":var invalid=!1;switch(transformName.substr(0,transformName.length-1)){case"translate":invalid=!/(%|px|em|rem|vw|vh|\d)$/i.test(propertyValue);break;case"scal":case"scale":Velocity.State.isAndroid&&Data(element).transformCache[transformName]===undefined&&1>propertyValue&&(propertyValue=1),invalid=!/(\d)$/i.test(propertyValue);break;case"skew":invalid=!/(deg|\d)$/i.test(propertyValue);break;case"rotate":invalid=!/(deg|\d)$/i.test(propertyValue)}return invalid||(Data(element).transformCache[transformName]="("+propertyValue+")"),Data(element).transformCache[transformName]}}}();for(var i=0;i<CSS.Lists.colors.length;i++)!function(){var colorName=CSS.Lists.colors[i];CSS.Normalizations.registered[colorName]=function(type,element,propertyValue){switch(type){case"name":return colorName;case"extract":var extracted;if(CSS.RegEx.wrappedValueAlreadyExtracted.test(propertyValue))extracted=propertyValue;else{var converted,colorNames={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(propertyValue)?converted=colorNames[propertyValue]!==undefined?colorNames[propertyValue]:colorNames.black:CSS.RegEx.isHex.test(propertyValue)?converted="rgb("+CSS.Values.hexToRgb(propertyValue).join(" ")+")":/^rgba?\(/i.test(propertyValue)||(converted=colorNames.black),extracted=(converted||propertyValue).toString().match(CSS.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=IE||3!==extracted.split(" ").length||(extracted+=" 1"),extracted;case"inject":return 8>=IE?4===propertyValue.split(" ").length&&(propertyValue=propertyValue.split(/\s+/).slice(0,3).join(" ")):3===propertyValue.split(" ").length&&(propertyValue+=" 1"),(8>=IE?"rgb":"rgba")+"("+propertyValue.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(property){return property.replace(/-(\w)/g,function(match,subMatch){return subMatch.toUpperCase()})},SVGAttribute:function(property){var SVGAttributes="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(IE||Velocity.State.isAndroid&&!Velocity.State.isChrome)&&(SVGAttributes+="|transform"),new RegExp("^("+SVGAttributes+")$","i").test(property)},prefixCheck:function(property){if(Velocity.State.prefixMatches[property])return[Velocity.State.prefixMatches[property],!0];for(var vendors=["","Webkit","Moz","ms","O"],i=0,vendorsLength=vendors.length;vendorsLength>i;i++){var propertyPrefixed;if(propertyPrefixed=0===i?property:vendors[i]+property.replace(/^\w/,function(match){return match.toUpperCase()}),Type.isString(Velocity.State.prefixElement.style[propertyPrefixed]))return Velocity.State.prefixMatches[property]=propertyPrefixed,[propertyPrefixed,!0]}return[property,!1]}},Values:{hexToRgb:function(hex){var rgbParts,shortformRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,longformRegex=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return hex=hex.replace(shortformRegex,function(m,r,g,b){return r+r+g+g+b+b}),rgbParts=longformRegex.exec(hex),rgbParts?[parseInt(rgbParts[1],16),parseInt(rgbParts[2],16),parseInt(rgbParts[3],16)]:[0,0,0]},isCSSNullValue:function(value){return 0==value||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(value)},getUnitType:function(property){return/^(rotate|skew)/i.test(property)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(property)?"":"px"},getDisplayType:function(element){var tagName=element.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(tagName)?"inline":/^(li)$/i.test(tagName)?"list-item":/^(tr)$/i.test(tagName)?"table-row":"block"},addClass:function(element,className){element.classList?element.classList.add(className):element.className+=(element.className.length?" ":"")+className},removeClass:function(element,className){element.classList?element.classList.remove(className):element.className=element.className.toString().replace(new RegExp("(^|\\s)"+className.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(element,property,rootPropertyValue,forceStyleLookup){function computePropertyValue(element,property){function revertDisplay(){toggleDisplay&&CSS.setPropertyValue(element,"display","none")}var computedValue=0;if(8>=IE)computedValue=$.css(element,property);else{var toggleDisplay=!1;if(/^(width|height)$/.test(property)&&0===CSS.getPropertyValue(element,"display")&&(toggleDisplay=!0,CSS.setPropertyValue(element,"display",CSS.Values.getDisplayType(element))),!forceStyleLookup){if("height"===property&&"border-box"!==CSS.getPropertyValue(element,"boxSizing").toString().toLowerCase()){var contentBoxHeight=element.offsetHeight-(parseFloat(CSS.getPropertyValue(element,"borderTopWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"borderBottomWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingTop"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingBottom"))||0);return revertDisplay(),contentBoxHeight}if("width"===property&&"border-box"!==CSS.getPropertyValue(element,"boxSizing").toString().toLowerCase()){var contentBoxWidth=element.offsetWidth-(parseFloat(CSS.getPropertyValue(element,"borderLeftWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"borderRightWidth"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingLeft"))||0)-(parseFloat(CSS.getPropertyValue(element,"paddingRight"))||0);return revertDisplay(),contentBoxWidth}}var computedStyle;computedStyle=Data(element)===undefined?window.getComputedStyle(element,null):Data(element).computedStyle?Data(element).computedStyle:Data(element).computedStyle=window.getComputedStyle(element,null),(IE||Velocity.State.isFirefox)&&"borderColor"===property&&(property="borderTopColor"),computedValue=9===IE&&"filter"===property?computedStyle.getPropertyValue(property):computedStyle[property],(""===computedValue||null===computedValue)&&(computedValue=element.style[property]),revertDisplay()}if("auto"===computedValue&&/^(top|right|bottom|left)$/i.test(property)){var position=computePropertyValue(element,"position");("fixed"===position||"absolute"===position&&/top|left/i.test(property))&&(computedValue=$(element).position()[property]+"px")}return computedValue}var propertyValue;if(CSS.Hooks.registered[property]){var hook=property,hookRoot=CSS.Hooks.getRoot(hook);rootPropertyValue===undefined&&(rootPropertyValue=CSS.getPropertyValue(element,CSS.Names.prefixCheck(hookRoot)[0])),CSS.Normalizations.registered[hookRoot]&&(rootPropertyValue=CSS.Normalizations.registered[hookRoot]("extract",element,rootPropertyValue)),propertyValue=CSS.Hooks.extractValue(hook,rootPropertyValue)}else if(CSS.Normalizations.registered[property]){var normalizedPropertyName,normalizedPropertyValue;normalizedPropertyName=CSS.Normalizations.registered[property]("name",element),"transform"!==normalizedPropertyName&&(normalizedPropertyValue=computePropertyValue(element,CSS.Names.prefixCheck(normalizedPropertyName)[0]),
CSS.Values.isCSSNullValue(normalizedPropertyValue)&&CSS.Hooks.templates[property]&&(normalizedPropertyValue=CSS.Hooks.templates[property][1])),propertyValue=CSS.Normalizations.registered[property]("extract",element,normalizedPropertyValue)}return/^[\d-]/.test(propertyValue)||(propertyValue=Data(element)&&Data(element).isSVG&&CSS.Names.SVGAttribute(property)?/^(height|width)$/i.test(property)?element.getBBox()[property]:element.getAttribute(property):computePropertyValue(element,CSS.Names.prefixCheck(property)[0])),CSS.Values.isCSSNullValue(propertyValue)&&(propertyValue=0),Velocity.debug>=2&&console.log("Get "+property+": "+propertyValue),propertyValue},setPropertyValue:function(element,property,propertyValue,rootPropertyValue,scrollData){var propertyName=property;if("scroll"===property)scrollData.container?scrollData.container["scroll"+scrollData.direction]=propertyValue:"Left"===scrollData.direction?window.scrollTo(propertyValue,scrollData.alternateValue):window.scrollTo(scrollData.alternateValue,propertyValue);else if(CSS.Normalizations.registered[property]&&"transform"===CSS.Normalizations.registered[property]("name",element))CSS.Normalizations.registered[property]("inject",element,propertyValue),propertyName="transform",propertyValue=Data(element).transformCache[property];else{if(CSS.Hooks.registered[property]){var hookName=property,hookRoot=CSS.Hooks.getRoot(property);rootPropertyValue=rootPropertyValue||CSS.getPropertyValue(element,hookRoot),propertyValue=CSS.Hooks.injectValue(hookName,propertyValue,rootPropertyValue),property=hookRoot}if(CSS.Normalizations.registered[property]&&(propertyValue=CSS.Normalizations.registered[property]("inject",element,propertyValue),property=CSS.Normalizations.registered[property]("name",element)),propertyName=CSS.Names.prefixCheck(property)[0],8>=IE)try{element.style[propertyName]=propertyValue}catch(error){Velocity.debug&&console.log("Browser does not support ["+propertyValue+"] for ["+propertyName+"]")}else Data(element)&&Data(element).isSVG&&CSS.Names.SVGAttribute(property)?element.setAttribute(property,propertyValue):element.style[propertyName]=propertyValue;Velocity.debug>=2&&console.log("Set "+property+" ("+propertyName+"): "+propertyValue)}return[propertyName,propertyValue]},flushTransformCache:function(element){function getTransformFloat(transformProperty){return parseFloat(CSS.getPropertyValue(element,transformProperty))}var transformString="";if((IE||Velocity.State.isAndroid&&!Velocity.State.isChrome)&&Data(element).isSVG){var SVGTransforms={translate:[getTransformFloat("translateX"),getTransformFloat("translateY")],skewX:[getTransformFloat("skewX")],skewY:[getTransformFloat("skewY")],scale:1!==getTransformFloat("scale")?[getTransformFloat("scale"),getTransformFloat("scale")]:[getTransformFloat("scaleX"),getTransformFloat("scaleY")],rotate:[getTransformFloat("rotateZ"),0,0]};$.each(Data(element).transformCache,function(transformName){/^translate/i.test(transformName)?transformName="translate":/^scale/i.test(transformName)?transformName="scale":/^rotate/i.test(transformName)&&(transformName="rotate"),SVGTransforms[transformName]&&(transformString+=transformName+"("+SVGTransforms[transformName].join(" ")+") ",delete SVGTransforms[transformName])})}else{var transformValue,perspective;$.each(Data(element).transformCache,function(transformName){return transformValue=Data(element).transformCache[transformName],"transformPerspective"===transformName?(perspective=transformValue,!0):(9===IE&&"rotateZ"===transformName&&(transformName="rotate"),void(transformString+=transformName+transformValue+" "))}),perspective&&(transformString="perspective"+perspective+" "+transformString)}CSS.setPropertyValue(element,"transform",transformString)}};CSS.Hooks.register(),CSS.Normalizations.register(),Velocity.hook=function(elements,arg2,arg3){var value=undefined;return elements=sanitizeElements(elements),$.each(elements,function(i,element){if(Data(element)===undefined&&Velocity.init(element),arg3===undefined)value===undefined&&(value=Velocity.CSS.getPropertyValue(element,arg2));else{var adjustedSet=Velocity.CSS.setPropertyValue(element,arg2,arg3);"transform"===adjustedSet[0]&&Velocity.CSS.flushTransformCache(element),value=adjustedSet}}),value};var animate=function(){function getChain(){return isUtility?promiseData.promise||null:elementsWrapped}function processElement(){function buildQueue(){function parsePropertyValue(valueData,skipResolvingEasing){var endValue=undefined,easing=undefined,startValue=undefined;return Type.isArray(valueData)?(endValue=valueData[0],!Type.isArray(valueData[1])&&/^[\d-]/.test(valueData[1])||Type.isFunction(valueData[1])||CSS.RegEx.isHex.test(valueData[1])?startValue=valueData[1]:(Type.isString(valueData[1])&&!CSS.RegEx.isHex.test(valueData[1])||Type.isArray(valueData[1]))&&(easing=skipResolvingEasing?valueData[1]:getEasing(valueData[1],opts.duration),valueData[2]!==undefined&&(startValue=valueData[2]))):endValue=valueData,skipResolvingEasing||(easing=easing||opts.easing),Type.isFunction(endValue)&&(endValue=endValue.call(element,elementsIndex,elementsLength)),Type.isFunction(startValue)&&(startValue=startValue.call(element,elementsIndex,elementsLength)),[endValue||0,easing,startValue]}function separateValue(property,value){var unitType,numericValue;return numericValue=(value||0).toString().toLowerCase().replace(/[%A-z]+$/,function(match){return unitType=match,""}),unitType||(unitType=CSS.Values.getUnitType(property)),[numericValue,unitType]}function calculateUnitRatios(){var sameRatioIndicators={myParent:element.parentNode||document.body,position:CSS.getPropertyValue(element,"position"),fontSize:CSS.getPropertyValue(element,"fontSize")},samePercentRatio=sameRatioIndicators.position===callUnitConversionData.lastPosition&&sameRatioIndicators.myParent===callUnitConversionData.lastParent,sameEmRatio=sameRatioIndicators.fontSize===callUnitConversionData.lastFontSize;callUnitConversionData.lastParent=sameRatioIndicators.myParent,callUnitConversionData.lastPosition=sameRatioIndicators.position,callUnitConversionData.lastFontSize=sameRatioIndicators.fontSize;var measurement=100,unitRatios={};if(sameEmRatio&&samePercentRatio)unitRatios.emToPx=callUnitConversionData.lastEmToPx,unitRatios.percentToPxWidth=callUnitConversionData.lastPercentToPxWidth,unitRatios.percentToPxHeight=callUnitConversionData.lastPercentToPxHeight;else{var dummy=Data(element).isSVG?document.createElementNS("http://www.w3.org/2000/svg","rect"):document.createElement("div");Velocity.init(dummy),sameRatioIndicators.myParent.appendChild(dummy),$.each(["overflow","overflowX","overflowY"],function(i,property){Velocity.CSS.setPropertyValue(dummy,property,"hidden")}),Velocity.CSS.setPropertyValue(dummy,"position",sameRatioIndicators.position),Velocity.CSS.setPropertyValue(dummy,"fontSize",sameRatioIndicators.fontSize),Velocity.CSS.setPropertyValue(dummy,"boxSizing","content-box"),$.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(i,property){Velocity.CSS.setPropertyValue(dummy,property,measurement+"%")}),Velocity.CSS.setPropertyValue(dummy,"paddingLeft",measurement+"em"),unitRatios.percentToPxWidth=callUnitConversionData.lastPercentToPxWidth=(parseFloat(CSS.getPropertyValue(dummy,"width",null,!0))||1)/measurement,unitRatios.percentToPxHeight=callUnitConversionData.lastPercentToPxHeight=(parseFloat(CSS.getPropertyValue(dummy,"height",null,!0))||1)/measurement,unitRatios.emToPx=callUnitConversionData.lastEmToPx=(parseFloat(CSS.getPropertyValue(dummy,"paddingLeft"))||1)/measurement,sameRatioIndicators.myParent.removeChild(dummy)}return null===callUnitConversionData.remToPx&&(callUnitConversionData.remToPx=parseFloat(CSS.getPropertyValue(document.body,"fontSize"))||16),null===callUnitConversionData.vwToPx&&(callUnitConversionData.vwToPx=parseFloat(window.innerWidth)/100,callUnitConversionData.vhToPx=parseFloat(window.innerHeight)/100),unitRatios.remToPx=callUnitConversionData.remToPx,unitRatios.vwToPx=callUnitConversionData.vwToPx,unitRatios.vhToPx=callUnitConversionData.vhToPx,Velocity.debug>=1&&console.log("Unit ratios: "+JSON.stringify(unitRatios),element),unitRatios}if(opts.begin&&0===elementsIndex)try{opts.begin.call(elements,elements)}catch(error){setTimeout(function(){throw error},1)}if("scroll"===action){var scrollPositionCurrent,scrollPositionCurrentAlternate,scrollPositionEnd,scrollDirection=/^x$/i.test(opts.axis)?"Left":"Top",scrollOffset=parseFloat(opts.offset)||0;opts.container?Type.isWrapped(opts.container)||Type.isNode(opts.container)?(opts.container=opts.container[0]||opts.container,scrollPositionCurrent=opts.container["scroll"+scrollDirection],scrollPositionEnd=scrollPositionCurrent+$(element).position()[scrollDirection.toLowerCase()]+scrollOffset):opts.container=null:(scrollPositionCurrent=Velocity.State.scrollAnchor[Velocity.State["scrollProperty"+scrollDirection]],scrollPositionCurrentAlternate=Velocity.State.scrollAnchor[Velocity.State["scrollProperty"+("Left"===scrollDirection?"Top":"Left")]],scrollPositionEnd=$(element).offset()[scrollDirection.toLowerCase()]+scrollOffset),tweensContainer={scroll:{rootPropertyValue:!1,startValue:scrollPositionCurrent,currentValue:scrollPositionCurrent,endValue:scrollPositionEnd,unitType:"",easing:opts.easing,scrollData:{container:opts.container,direction:scrollDirection,alternateValue:scrollPositionCurrentAlternate}},element:element},Velocity.debug&&console.log("tweensContainer (scroll): ",tweensContainer.scroll,element)}else if("reverse"===action){if(!Data(element).tweensContainer)return void $.dequeue(element,opts.queue);"none"===Data(element).opts.display&&(Data(element).opts.display="auto"),"hidden"===Data(element).opts.visibility&&(Data(element).opts.visibility="visible"),Data(element).opts.loop=!1,Data(element).opts.begin=null,Data(element).opts.complete=null,options.easing||delete opts.easing,options.duration||delete opts.duration,opts=$.extend({},Data(element).opts,opts);var lastTweensContainer=$.extend(!0,{},Data(element).tweensContainer);for(var lastTween in lastTweensContainer)if("element"!==lastTween){var lastStartValue=lastTweensContainer[lastTween].startValue;lastTweensContainer[lastTween].startValue=lastTweensContainer[lastTween].currentValue=lastTweensContainer[lastTween].endValue,lastTweensContainer[lastTween].endValue=lastStartValue,Type.isEmptyObject(options)||(lastTweensContainer[lastTween].easing=opts.easing),Velocity.debug&&console.log("reverse tweensContainer ("+lastTween+"): "+JSON.stringify(lastTweensContainer[lastTween]),element)}tweensContainer=lastTweensContainer}else if("start"===action){var lastTweensContainer;Data(element).tweensContainer&&Data(element).isAnimating===!0&&(lastTweensContainer=Data(element).tweensContainer),$.each(propertiesMap,function(property,value){if(RegExp("^"+CSS.Lists.colors.join("$|^")+"$").test(property)){var valueData=parsePropertyValue(value,!0),endValue=valueData[0],easing=valueData[1],startValue=valueData[2];if(CSS.RegEx.isHex.test(endValue)){for(var colorComponents=["Red","Green","Blue"],endValueRGB=CSS.Values.hexToRgb(endValue),startValueRGB=startValue?CSS.Values.hexToRgb(startValue):undefined,i=0;i<colorComponents.length;i++)propertiesMap[property+colorComponents[i]]=[endValueRGB[i],easing,startValueRGB?startValueRGB[i]:startValueRGB];delete propertiesMap[property]}}});for(var property in propertiesMap){var valueData=parsePropertyValue(propertiesMap[property]),endValue=valueData[0],easing=valueData[1],startValue=valueData[2];property=CSS.Names.camelCase(property);var rootProperty=CSS.Hooks.getRoot(property),rootPropertyValue=!1;if(Data(element).isSVG||CSS.Names.prefixCheck(rootProperty)[1]!==!1||CSS.Normalizations.registered[rootProperty]!==undefined){(opts.display!==undefined&&null!==opts.display&&"none"!==opts.display||opts.visibility&&"hidden"!==opts.visibility)&&/opacity|filter/.test(property)&&!startValue&&0!==endValue&&(startValue=0),opts._cacheValues&&lastTweensContainer&&lastTweensContainer[property]?(startValue===undefined&&(startValue=lastTweensContainer[property].endValue+lastTweensContainer[property].unitType),rootPropertyValue=Data(element).rootPropertyValueCache[rootProperty]):CSS.Hooks.registered[property]?startValue===undefined?(rootPropertyValue=CSS.getPropertyValue(element,rootProperty),startValue=CSS.getPropertyValue(element,property,rootPropertyValue)):rootPropertyValue=CSS.Hooks.templates[rootProperty][1]:startValue===undefined&&(startValue=CSS.getPropertyValue(element,property));var separatedValue,endValueUnitType,startValueUnitType,operator=!1;if(separatedValue=separateValue(property,startValue),startValue=separatedValue[0],startValueUnitType=separatedValue[1],separatedValue=separateValue(property,endValue),endValue=separatedValue[0].replace(/^([+-\/*])=/,function(match,subMatch){return operator=subMatch,""}),endValueUnitType=separatedValue[1],startValue=parseFloat(startValue)||0,endValue=parseFloat(endValue)||0,"%"===endValueUnitType&&(/^(fontSize|lineHeight)$/.test(property)?(endValue/=100,endValueUnitType="em"):/^scale/.test(property)?(endValue/=100,endValueUnitType=""):/(Red|Green|Blue)$/i.test(property)&&(endValue=endValue/100*255,endValueUnitType="")),/[\/*]/.test(operator))endValueUnitType=startValueUnitType;else if(startValueUnitType!==endValueUnitType&&0!==startValue)if(0===endValue)endValueUnitType=startValueUnitType;else{elementUnitConversionData=elementUnitConversionData||calculateUnitRatios();var axis=/margin|padding|left|right|width|text|word|letter/i.test(property)||/X$/.test(property)||"x"===property?"x":"y";switch(startValueUnitType){case"%":startValue*="x"===axis?elementUnitConversionData.percentToPxWidth:elementUnitConversionData.percentToPxHeight;break;case"px":break;default:startValue*=elementUnitConversionData[startValueUnitType+"ToPx"]}switch(endValueUnitType){case"%":startValue*=1/("x"===axis?elementUnitConversionData.percentToPxWidth:elementUnitConversionData.percentToPxHeight);break;case"px":break;default:startValue*=1/elementUnitConversionData[endValueUnitType+"ToPx"]}}switch(operator){case"+":endValue=startValue+endValue;break;case"-":endValue=startValue-endValue;break;case"*":endValue=startValue*endValue;break;case"/":endValue=startValue/endValue}tweensContainer[property]={rootPropertyValue:rootPropertyValue,startValue:startValue,currentValue:startValue,endValue:endValue,unitType:endValueUnitType,easing:easing},Velocity.debug&&console.log("tweensContainer ("+property+"): "+JSON.stringify(tweensContainer[property]),element)}else Velocity.debug&&console.log("Skipping ["+rootProperty+"] due to a lack of browser support.")}tweensContainer.element=element}tweensContainer.element&&(CSS.Values.addClass(element,"velocity-animating"),call.push(tweensContainer),""===opts.queue&&(Data(element).tweensContainer=tweensContainer,Data(element).opts=opts),Data(element).isAnimating=!0,elementsIndex===elementsLength-1?(Velocity.State.calls.length>1e4&&(Velocity.State.calls=compactSparseArray(Velocity.State.calls)),Velocity.State.calls.push([call,elements,opts,null,promiseData.resolver]),Velocity.State.isTicking===!1&&(Velocity.State.isTicking=!0,tick())):elementsIndex++)}var elementUnitConversionData,element=this,opts=$.extend({},Velocity.defaults,options),tweensContainer={};if(Data(element)===undefined&&Velocity.init(element),parseFloat(opts.delay)&&opts.queue!==!1&&$.queue(element,opts.queue,function(next){Velocity.velocityQueueEntryFlag=!0,Data(element).delayTimer={setTimeout:setTimeout(next,parseFloat(opts.delay)),next:next}}),Velocity.mock===!0)opts.duration=1;else switch(opts.duration.toString().toLowerCase()){case"fast":opts.duration=200;break;case"normal":opts.duration=DURATION_DEFAULT;break;case"slow":opts.duration=600;break;default:opts.duration=parseFloat(opts.duration)||1}opts.easing=getEasing(opts.easing,opts.duration),opts.begin&&!Type.isFunction(opts.begin)&&(opts.begin=null),opts.progress&&!Type.isFunction(opts.progress)&&(opts.progress=null),opts.complete&&!Type.isFunction(opts.complete)&&(opts.complete=null),opts.display!==undefined&&null!==opts.display&&(opts.display=opts.display.toString().toLowerCase(),"auto"===opts.display&&(opts.display=Velocity.CSS.Values.getDisplayType(element))),opts.visibility&&(opts.visibility=opts.visibility.toString().toLowerCase()),opts.mobileHA=opts.mobileHA&&Velocity.State.isMobile&&!Velocity.State.isGingerbread,opts.queue===!1?opts.delay?setTimeout(buildQueue,opts.delay):buildQueue():$.queue(element,opts.queue,function(next,clearQueue){return clearQueue===!0?(promiseData.promise&&promiseData.resolver(elements),!0):(Velocity.velocityQueueEntryFlag=!0,void buildQueue(next))}),""!==opts.queue&&"fx"!==opts.queue||"inprogress"===$.queue(element)[0]||$.dequeue(element)}var isUtility,elementsWrapped,argumentIndex,elements,propertiesMap,options,syntacticSugar=arguments[0]&&($.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||Type.isString(arguments[0].properties));if(Type.isWrapped(this)?(isUtility=!1,argumentIndex=0,elements=this,elementsWrapped=this):(isUtility=!0,argumentIndex=1,elements=syntacticSugar?arguments[0].elements:arguments[0]),elements=sanitizeElements(elements)){syntacticSugar?(propertiesMap=arguments[0].properties,options=arguments[0].options):(propertiesMap=arguments[argumentIndex],options=arguments[argumentIndex+1]);var elementsLength=elements.length,elementsIndex=0;if("stop"!==propertiesMap&&!$.isPlainObject(options)){var startingArgumentPosition=argumentIndex+1;options={};for(var i=startingArgumentPosition;i<arguments.length;i++)Type.isArray(arguments[i])||!/fast|normal|slow/i.test(arguments[i].toString())&&!/^\d/.test(arguments[i])?Type.isString(arguments[i])||Type.isArray(arguments[i])?options.easing=arguments[i]:Type.isFunction(arguments[i])&&(options.complete=arguments[i]):options.duration=arguments[i]}var promiseData={promise:null,resolver:null,rejecter:null};isUtility&&Velocity.Promise&&(promiseData.promise=new Velocity.Promise(function(resolve,reject){promiseData.resolver=resolve,promiseData.rejecter=reject}));var action;switch(propertiesMap){case"scroll":action="scroll";break;case"reverse":action="reverse";break;case"stop":$.each(elements,function(i,element){Data(element)&&Data(element).delayTimer&&(clearTimeout(Data(element).delayTimer.setTimeout),Data(element).delayTimer.next&&Data(element).delayTimer.next(),delete Data(element).delayTimer)});var callsToStop=[];return $.each(Velocity.State.calls,function(i,activeCall){activeCall&&$.each(activeCall[1],function(k,activeElement){var queueName=Type.isString(options)?options:"";return options!==undefined&&activeCall[2].queue!==queueName?!0:void $.each(elements,function(l,element){element===activeElement&&(options!==undefined&&($.each($.queue(element,queueName),function(_,item){Type.isFunction(item)&&item(null,!0)}),$.queue(element,queueName,[])),Data(element)&&""===queueName&&$.each(Data(element).tweensContainer,function(m,activeTween){activeTween.endValue=activeTween.currentValue}),callsToStop.push(i))})})}),$.each(callsToStop,function(i,j){completeCall(j,!0)}),promiseData.promise&&promiseData.resolver(elements),getChain();default:if(!$.isPlainObject(propertiesMap)||Type.isEmptyObject(propertiesMap)){if(Type.isString(propertiesMap)&&Velocity.Sequences[propertiesMap]){var opts=$.extend({},options),durationOriginal=opts.duration,delayOriginal=opts.delay||0;return opts.backwards===!0&&(elements=elements.reverse()),$.each(elements,function(elementIndex,element){parseFloat(opts.stagger)?opts.delay=delayOriginal+parseFloat(opts.stagger)*elementIndex:Type.isFunction(opts.stagger)&&(opts.delay=delayOriginal+opts.stagger.call(element,elementIndex,elementsLength)),opts.drag&&(opts.duration=parseFloat(durationOriginal)||(/^(callout|transition)/.test(propertiesMap)?1e3:DURATION_DEFAULT),opts.duration=Math.max(opts.duration*(opts.backwards?1-elementIndex/elementsLength:(elementIndex+1)/elementsLength),.75*opts.duration,200)),Velocity.Sequences[propertiesMap].call(element,element,opts||{},elementIndex,elementsLength,elements,promiseData.promise?promiseData:undefined)}),getChain()}var abortError="Velocity: First argument ("+propertiesMap+") was not a property map, a known action, or a registered sequence. Aborting.";return promiseData.promise?promiseData.rejecter(new Error(abortError)):console.log(abortError),getChain()}action="start"}var callUnitConversionData={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},call=[];$.each(elements,function(i,element){Type.isNode(element)&&processElement.call(element)});var reverseCallsCount,opts=$.extend({},Velocity.defaults,options);if(opts.loop=parseInt(opts.loop),reverseCallsCount=2*opts.loop-1,opts.loop)for(var x=0;reverseCallsCount>x;x++){var reverseOptions={delay:opts.delay};x===reverseCallsCount-1&&(reverseOptions.display=opts.display,reverseOptions.visibility=opts.visibility,reverseOptions.complete=opts.complete),animate(elements,"reverse",reverseOptions)}return getChain()}};Velocity=$.extend(animate,Velocity),Velocity.animate=animate;var ticker=window.requestAnimationFrame||rAFShim;return Velocity.State.isMobile||document.hidden===undefined||document.addEventListener("visibilitychange",function(){document.hidden?(ticker=function(callback){return setTimeout(function(){callback(!0)},16)},tick()):ticker=window.requestAnimationFrame||rAFShim}),global.Velocity=Velocity,global!==window&&(global.fn.velocity=animate,global.fn.velocity.defaults=Velocity.defaults),$.each(["Down","Up"],function(i,direction){Velocity.Sequences["slide"+direction]=function(element,options,elementsIndex,elementsSize,elements,promiseData){var opts=$.extend({},options),begin=opts.begin,complete=opts.complete,computedValues={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},inlineValues={};opts.display===undefined&&(opts.display="Down"===direction?"inline"===Velocity.CSS.Values.getDisplayType(element)?"inline-block":"block":"none"),opts.begin=function(){begin&&begin.call(elements,elements),inlineValues.overflow=element.style.overflow,element.style.overflow="hidden";for(var property in computedValues){inlineValues[property]=element.style[property];var propertyValue=Velocity.CSS.getPropertyValue(element,property);computedValues[property]="Down"===direction?[propertyValue,0]:[0,propertyValue]}},opts.complete=function(){for(var property in inlineValues)element.style[property]=inlineValues[property];complete&&complete.call(elements,elements),promiseData&&promiseData.resolver(elements)},Velocity(element,computedValues,opts)}}),$.each(["In","Out"],function(i,direction){Velocity.Sequences["fade"+direction]=function(element,options,elementsIndex,elementsSize,elements,promiseData){var opts=$.extend({},options),propertiesMap={opacity:"In"===direction?1:0},originalComplete=opts.complete;opts.complete=elementsIndex!==elementsSize-1?opts.begin=null:function(){originalComplete&&originalComplete.call(elements,elements),promiseData&&promiseData.resolver(elements)},opts.display===undefined&&(opts.display="In"===direction?"auto":"none"),Velocity(this,propertiesMap,opts)}}),Velocity}(window.jQuery||window.Zepto||window,window,document)}),/*!
 * Fotorama 4.6.3 | http://fotorama.io/license/
 */
fotoramaVersion="4.6.3",function(window,document,location,$,undefined){"use strict";function bez(coOrdArray){var encodedFuncName="bez_"+$.makeArray(arguments).join("_").replace(".","p");if("function"!=typeof $.easing[encodedFuncName]){var polyBez=function(p1,p2){var A=[null,null],B=[null,null],C=[null,null],bezCoOrd=function(t,ax){return C[ax]=3*p1[ax],B[ax]=3*(p2[ax]-p1[ax])-C[ax],A[ax]=1-C[ax]-B[ax],t*(C[ax]+t*(B[ax]+t*A[ax]))},xDeriv=function(t){return C[0]+t*(2*B[0]+3*A[0]*t)},xForT=function(t){for(var z,x=t,i=0;++i<14&&(z=bezCoOrd(x,0)-t,!(Math.abs(z)<.001));)x-=z/xDeriv(x);return x};return function(t){return bezCoOrd(xForT(t),1)}};$.easing[encodedFuncName]=function(x,t,b,c,d){return c*polyBez([coOrdArray[0],coOrdArray[1]],[coOrdArray[2],coOrdArray[3]])(t/d)+b}}return encodedFuncName}function noop(){}function minMaxLimit(value,min,max){return Math.max(isNaN(min)?-(1/0):min,Math.min(isNaN(max)?1/0:max,value))}function readTransform(css){return css.match(/ma/)&&css.match(/-?\d+(?!d)/g)[css.match(/3d/)?12:4]}function readPosition($el){return CSS3?+readTransform($el.css("transform")):+$el.css("left").replace("px","")}function getTranslate(pos){var obj={};return CSS3?obj.transform="translate3d("+pos+"px,0,0)":obj.left=pos,obj}function getDuration(time){return{"transition-duration":time+"ms"}}function unlessNaN(value,alternative){return isNaN(value)?alternative:value}function numberFromMeasure(value,measure){return unlessNaN(+String(value).replace(measure||"px",""))}function numberFromPercent(value){return/%$/.test(value)?numberFromMeasure(value,"%"):undefined}function numberFromWhatever(value,whole){return unlessNaN(numberFromPercent(value)/100*whole,numberFromMeasure(value))}function measureIsValid(value){return(!isNaN(numberFromMeasure(value))||!isNaN(numberFromMeasure(value,"%")))&&value}function getPosByIndex(index,side,margin,baseIndex){return(index-(baseIndex||0))*(side+(margin||0))}function getIndexByPos(pos,side,margin,baseIndex){return-Math.round(pos/(side+(margin||0))-(baseIndex||0))}function bindTransitionEnd($el){var elData=$el.data();if(!elData.tEnd){var el=$el[0],transitionEndEvent={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};addEvent(el,transitionEndEvent[Modernizr.prefixed("transition")],function(e){elData.tProp&&e.propertyName.match(elData.tProp)&&elData.onEndFn()}),elData.tEnd=!0}}function afterTransition($el,property,fn,time){var ok,elData=$el.data();elData&&(elData.onEndFn=function(){ok||(ok=!0,clearTimeout(elData.tT),fn())},elData.tProp=property,clearTimeout(elData.tT),elData.tT=setTimeout(function(){elData.onEndFn()},1.5*time),bindTransitionEnd($el))}function stop($el,left){if($el.length){var elData=$el.data();CSS3?($el.css(getDuration(0)),elData.onEndFn=noop,clearTimeout(elData.tT)):$el.stop();var lockedLeft=getNumber(left,function(){return readPosition($el)});return $el.css(getTranslate(lockedLeft)),lockedLeft}}function getNumber(){for(var number,_i=0,_l=arguments.length;_l>_i&&(number=_i?arguments[_i]():arguments[_i],"number"!=typeof number);_i++);return number}function edgeResistance(pos,edge){return Math.round(pos+(edge-pos)/1.5)}function getProtocol(){return getProtocol.p=getProtocol.p||("https:"===location.protocol?"https://":"http://"),getProtocol.p}function parseHref(href){var a=document.createElement("a");return a.href=href,a}function findVideoId(href,forceVideo){if("string"!=typeof href)return href;href=parseHref(href);var id,type;if(href.host.match(/youtube\.com/)&&href.search){if(id=href.search.split("v=")[1]){var ampersandPosition=id.indexOf("&");-1!==ampersandPosition&&(id=id.substring(0,ampersandPosition)),type="youtube"}}else href.host.match(/youtube\.com|youtu\.be/)?(id=href.pathname.replace(/^\/(embed\/|v\/)?/,"").replace(/\/.*/,""),type="youtube"):href.host.match(/vimeo\.com/)&&(type="vimeo",id=href.pathname.replace(/^\/(video\/)?/,"").replace(/\/.*/,""));return id&&type||!forceVideo||(id=href.href,type="custom"),id?{id:id,type:type,s:href.search.replace(/^\?/,""),p:getProtocol()}:!1}function getVideoThumbs(dataFrame,data,fotorama){var img,thumb,video=dataFrame.video;return"youtube"===video.type?(thumb=getProtocol()+"img.youtube.com/vi/"+video.id+"/default.jpg",img=thumb.replace(/\/default.jpg$/,"/hqdefault.jpg"),dataFrame.thumbsReady=!0):"vimeo"===video.type?$.ajax({url:getProtocol()+"vimeo.com/api/v2/video/"+video.id+".json",dataType:"jsonp",success:function(json){dataFrame.thumbsReady=!0,updateData(data,{img:json[0].thumbnail_large,thumb:json[0].thumbnail_small},dataFrame.i,fotorama)}}):dataFrame.thumbsReady=!0,{img:img,thumb:thumb}}function updateData(data,_dataFrame,i,fotorama){for(var _i=0,_l=data.length;_l>_i;_i++){var dataFrame=data[_i];if(dataFrame.i===i&&dataFrame.thumbsReady){var clear={videoReady:!0};clear[STAGE_FRAME_KEY]=clear[NAV_THUMB_FRAME_KEY]=clear[NAV_DOT_FRAME_KEY]=!1,fotorama.splice(_i,1,$.extend({},dataFrame,clear,_dataFrame));break}}}function getDataFromHtml($el){function getDataFromImg($img,imgData,checkVideo){var $child=$img.children("img").eq(0),_imgHref=$img.attr("href"),_imgSrc=$img.attr("src"),_thumbSrc=$child.attr("src"),_video=imgData.video,video=checkVideo?findVideoId(_imgHref,_video===!0):!1;video?_imgHref=!1:video=_video,getDimensions($img,$child,$.extend(imgData,{video:video,img:imgData.img||_imgHref||_imgSrc||_thumbSrc,thumb:imgData.thumb||_thumbSrc||_imgSrc||_imgHref}))}function getDimensions($img,$child,imgData){var separateThumbFLAG=imgData.thumb&&imgData.img!==imgData.thumb,width=numberFromMeasure(imgData.width||$img.attr("width")),height=numberFromMeasure(imgData.height||$img.attr("height"));$.extend(imgData,{width:width,height:height,thumbratio:getRatio(imgData.thumbratio||numberFromMeasure(imgData.thumbwidth||$child&&$child.attr("width")||separateThumbFLAG||width)/numberFromMeasure(imgData.thumbheight||$child&&$child.attr("height")||separateThumbFLAG||height))})}var data=[];return $el.children().each(function(){var $this=$(this),dataFrame=optionsToLowerCase($.extend($this.data(),{id:$this.attr("id")}));if($this.is("a, img"))getDataFromImg($this,dataFrame,!0);else{if($this.is(":empty"))return;getDimensions($this,null,$.extend(dataFrame,{html:this,_html:$this.html()}))}data.push(dataFrame)}),data}function isHidden(el){return 0===el.offsetWidth&&0===el.offsetHeight}function isDetached(el){return!$.contains(document.documentElement,el)}function waitFor(test,fn,timeout,i){return waitFor.i||(waitFor.i=1,waitFor.ii=[!0]),i=i||waitFor.i,"undefined"==typeof waitFor.ii[i]&&(waitFor.ii[i]=!0),test()?fn():waitFor.ii[i]&&setTimeout(function(){waitFor.ii[i]&&waitFor(test,fn,timeout,i)},timeout||100),waitFor.i++}function setHash(hash){location.replace(location.protocol+"//"+location.host+location.pathname.replace(/^\/?/,"/")+location.search+"#"+hash)}function fit($el,measuresToFit,method,position){var elData=$el.data(),measures=elData.measures;if(measures&&(!elData.l||elData.l.W!==measures.width||elData.l.H!==measures.height||elData.l.r!==measures.ratio||elData.l.w!==measuresToFit.w||elData.l.h!==measuresToFit.h||elData.l.m!==method||elData.l.p!==position)){var width=measures.width,height=measures.height,ratio=measuresToFit.w/measuresToFit.h,biggerRatioFLAG=measures.ratio>=ratio,fitFLAG="scaledown"===method,containFLAG="contain"===method,coverFLAG="cover"===method,pos=parsePosition(position);biggerRatioFLAG&&(fitFLAG||containFLAG)||!biggerRatioFLAG&&coverFLAG?(width=minMaxLimit(measuresToFit.w,0,fitFLAG?width:1/0),height=width/measures.ratio):(biggerRatioFLAG&&coverFLAG||!biggerRatioFLAG&&(fitFLAG||containFLAG))&&(height=minMaxLimit(measuresToFit.h,0,fitFLAG?height:1/0),width=height*measures.ratio),$el.css({width:width,height:height,left:numberFromWhatever(pos.x,measuresToFit.w-width),top:numberFromWhatever(pos.y,measuresToFit.h-height)}),elData.l={W:measures.width,H:measures.height,r:measures.ratio,w:measuresToFit.w,h:measuresToFit.h,m:method,p:position}}return!0}function setStyle($el,style){var el=$el[0];el.styleSheet?el.styleSheet.cssText=style:$el.html(style)}function findShadowEdge(pos,min,max){return min===max?!1:min>=pos?"left":pos>=max?"right":"left right"}function getIndexFromHash(hash,data,ok,startindex){if(!ok)return!1;if(!isNaN(hash))return hash-(startindex?0:1);for(var index,_i=0,_l=data.length;_l>_i;_i++){var dataFrame=data[_i];if(dataFrame.id===hash){index=_i;break}}return index}function smartClick($el,fn,_options){_options=_options||{},$el.each(function(){var startEvent,$this=$(this),thisData=$this.data();thisData.clickOn||(thisData.clickOn=!0,$.extend(touch($this,{onStart:function(e){startEvent=e,(_options.onStart||noop).call(this,e)},onMove:_options.onMove||noop,onTouchEnd:_options.onTouchEnd||noop,onEnd:function(result){result.moved||fn.call(this,startEvent)}}),{noMove:!0}))})}function div(classes,child){return'<div class="'+classes+'">'+(child||"")+"</div>"}function shuffle(array){for(var l=array.length;l;){var i=Math.floor(Math.random()*l--),t=array[l];array[l]=array[i],array[i]=t}return array}function clone(array){return"[object Array]"==Object.prototype.toString.call(array)&&$.map(array,function(frame){return $.extend({},frame)})}function lockScroll($el,left,top){$el.scrollLeft(left||0).scrollTop(top||0)}function optionsToLowerCase(options){if(options){var opts={};return $.each(options,function(key,value){opts[key.toLowerCase()]=value}),opts}}function getRatio(_ratio){if(_ratio){var ratio=+_ratio;return isNaN(ratio)?(ratio=_ratio.split("/"),+ratio[0]/+ratio[1]||undefined):ratio}}function addEvent(el,e,fn,bool){e&&(el.addEventListener?el.addEventListener(e,fn,!!bool):el.attachEvent("on"+e,fn))}function elIsDisabled(el){return!!el.getAttribute("disabled")}function disableAttr(FLAG){return{tabindex:-1*FLAG+"",disabled:FLAG}}function addEnterUp(el,fn){addEvent(el,"keyup",function(e){elIsDisabled(el)||13==e.keyCode&&fn.call(el,e)})}function addFocus(el,fn){addEvent(el,"focus",el.onfocusin=function(e){fn.call(el,e)},!0)}function stopEvent(e,stopPropagation){e.preventDefault?e.preventDefault():e.returnValue=!1,stopPropagation&&e.stopPropagation&&e.stopPropagation()}function getDirectionSign(forward){return forward?">":"<"}function parsePosition(rule){return rule=(rule+"").split(/\s+/),{x:measureIsValid(rule[0])||FIFTYFIFTY,y:measureIsValid(rule[1])||FIFTYFIFTY}}function slide($el,options){var elData=$el.data(),elPos=Math.round(options.pos),onEndFn=function(){elData.sliding=!1,(options.onEnd||noop)()};"undefined"!=typeof options.overPos&&options.overPos!==options.pos&&(elPos=options.overPos,onEndFn=function(){slide($el,$.extend({},options,{overPos:options.pos,time:Math.max(TRANSITION_DURATION,options.time/2)}))});var translate=$.extend(getTranslate(elPos),options.width&&{width:options.width});elData.sliding=!0,CSS3?($el.css($.extend(getDuration(options.time),translate)),options.time>10?afterTransition($el,"transform",onEndFn,options.time):onEndFn()):$el.stop().animate(translate,options.time,BEZIER,onEndFn)}function fade($el1,$el2,$frames,options,fadeStack,chain){var chainedFLAG="undefined"!=typeof chain;if(chainedFLAG||(fadeStack.push(arguments),Array.prototype.push.call(arguments,fadeStack.length),!(fadeStack.length>1))){$el1=$el1||$($el1),$el2=$el2||$($el2);var _$el1=$el1[0],_$el2=$el2[0],crossfadeFLAG="crossfade"===options.method,onEndFn=function(){if(!onEndFn.done){onEndFn.done=!0;var args=(chainedFLAG||fadeStack.shift())&&fadeStack.shift();args&&fade.apply(this,args),(options.onEnd||noop)(!!args)}},time=options.time/(chain||1);$frames.removeClass(fadeRearClass+" "+fadeFrontClass),$el1.stop().addClass(fadeRearClass),$el2.stop().addClass(fadeFrontClass),crossfadeFLAG&&_$el2&&$el1.fadeTo(0,0),$el1.fadeTo(crossfadeFLAG?time:0,1,crossfadeFLAG&&onEndFn),$el2.fadeTo(time,0,onEndFn),_$el1&&crossfadeFLAG||_$el2||onEndFn()}}function extendEvent(e){var touch=(e.touches||[])[0]||e;e._x=touch.pageX,e._y=touch.clientY,e._now=$.now()}function touch($el,options){function onStart(e){return $target=$(e.target),tail.checked=targetIsSelectFLAG=targetIsLinkFlag=moved=!1,touchEnabledFLAG||tail.flow||e.touches&&e.touches.length>1||e.which>1||lastEvent&&lastEvent.type!==e.type&&preventEvent||(targetIsSelectFLAG=options.select&&$target.is(options.select,el))?targetIsSelectFLAG:(touchFLAG="touchstart"===e.type,targetIsLinkFlag=$target.is("a, a *",el),controlTouch=tail.control,tolerance=tail.noMove||tail.noSwipe||controlTouch?16:tail.snap?0:4,extendEvent(e),startEvent=lastEvent=e,moveEventType=e.type.replace(/down|start/,"move").replace(/Down/,"Move"),(options.onStart||noop).call(el,e,{control:controlTouch,$target:$target}),touchEnabledFLAG=tail.flow=!0,void((!touchFLAG||tail.go)&&stopEvent(e)))}function onMove(e){if(e.touches&&e.touches.length>1||MS_POINTER&&!e.isPrimary||moveEventType!==e.type||!touchEnabledFLAG)return touchEnabledFLAG&&onEnd(),void(options.onTouchEnd||noop)();extendEvent(e);var xDiff=Math.abs(e._x-startEvent._x),yDiff=Math.abs(e._y-startEvent._y),xyDiff=xDiff-yDiff,xWin=(tail.go||tail.x||xyDiff>=0)&&!tail.noSwipe,yWin=0>xyDiff;touchFLAG&&!tail.checked?(touchEnabledFLAG=xWin)&&stopEvent(e):(stopEvent(e),(options.onMove||noop).call(el,e,{touch:touchFLAG})),!moved&&Math.sqrt(Math.pow(xDiff,2)+Math.pow(yDiff,2))>tolerance&&(moved=!0),tail.checked=tail.checked||xWin||yWin}function onEnd(e){(options.onTouchEnd||noop)();var _touchEnabledFLAG=touchEnabledFLAG;tail.control=touchEnabledFLAG=!1,_touchEnabledFLAG&&(tail.flow=!1),!_touchEnabledFLAG||targetIsLinkFlag&&!tail.checked||(e&&stopEvent(e),preventEvent=!0,clearTimeout(preventEventTimeout),preventEventTimeout=setTimeout(function(){preventEvent=!1},1e3),(options.onEnd||noop).call(el,{moved:moved,$target:$target,control:controlTouch,touch:touchFLAG,startEvent:startEvent,aborted:!e||"MSPointerCancel"===e.type}))}function onOtherStart(){tail.flow||setTimeout(function(){tail.flow=!0},10)}function onOtherEnd(){tail.flow&&setTimeout(function(){tail.flow=!1},TOUCH_TIMEOUT)}var touchEnabledFLAG,startEvent,$target,controlTouch,touchFLAG,targetIsSelectFLAG,targetIsLinkFlag,tolerance,moved,el=$el[0],tail={};return MS_POINTER?(addEvent(el,"MSPointerDown",onStart),addEvent(document,"MSPointerMove",onMove),addEvent(document,"MSPointerCancel",onEnd),addEvent(document,"MSPointerUp",onEnd)):(addEvent(el,"touchstart",onStart),addEvent(el,"touchmove",onMove),addEvent(el,"touchend",onEnd),addEvent(document,"touchstart",onOtherStart),addEvent(document,"touchend",onOtherEnd),addEvent(document,"touchcancel",onOtherEnd),$WINDOW.on("scroll",onOtherEnd),$el.on("mousedown",onStart),$DOCUMENT.on("mousemove",onMove).on("mouseup",onEnd)),$el.on("click","a",function(e){tail.checked&&stopEvent(e)}),tail}function moveOnTouch($el,options){function startTracking(e,noStop){tracked=!0,startCoo=coo=e._x,startTime=e._now,moveTrack=[[startTime,startCoo]],startElPos=moveElPos=tail.noMove||noStop?0:stop($el,(options.getPos||noop)()),(options.onStart||noop).call(el,e)}function onStart(e,result){min=tail.min,max=tail.max,snap=tail.snap,slowFLAG=e.altKey,tracked=moved=!1,controlFLAG=result.control,controlFLAG||elData.sliding||startTracking(e)}function onMove(e,result){tail.noSwipe||(tracked||startTracking(e),coo=e._x,moveTrack.push([e._now,coo]),moveElPos=startElPos-(startCoo-coo),edge=findShadowEdge(moveElPos,min,max),min>=moveElPos?moveElPos=edgeResistance(moveElPos,min):moveElPos>=max&&(moveElPos=edgeResistance(moveElPos,max)),tail.noMove||($el.css(getTranslate(moveElPos)),moved||(moved=!0,result.touch||MS_POINTER||$el.addClass(grabbingClass)),(options.onMove||noop).call(el,e,{pos:moveElPos,edge:edge})))}function onEnd(result){if(!tail.noSwipe||!result.moved){tracked||startTracking(result.startEvent,!0),result.touch||MS_POINTER||$el.removeClass(grabbingClass),endTime=$.now();for(var _backTime,_timeDiff,_timeDiffLast,backCoo,virtualPos,limitPos,newPos,overPos,speed,_backTimeIdeal=endTime-TOUCH_TIMEOUT,backTime=null,time=TRANSITION_DURATION,friction=options.friction,_i=moveTrack.length-1;_i>=0;_i--){if(_backTime=moveTrack[_i][0],_timeDiff=Math.abs(_backTime-_backTimeIdeal),null===backTime||_timeDiffLast>_timeDiff)backTime=_backTime,backCoo=moveTrack[_i][1];else if(backTime===_backTimeIdeal||_timeDiff>_timeDiffLast)break;_timeDiffLast=_timeDiff}newPos=minMaxLimit(moveElPos,min,max);var cooDiff=backCoo-coo,forwardFLAG=cooDiff>=0,timeDiff=endTime-backTime,longTouchFLAG=timeDiff>TOUCH_TIMEOUT,swipeFLAG=!longTouchFLAG&&moveElPos!==startElPos&&newPos===moveElPos;snap&&(newPos=minMaxLimit(Math[swipeFLAG?forwardFLAG?"floor":"ceil":"round"](moveElPos/snap)*snap,min,max),min=max=newPos),swipeFLAG&&(snap||newPos===moveElPos)&&(speed=-(cooDiff/timeDiff),time*=minMaxLimit(Math.abs(speed),options.timeLow,options.timeHigh),virtualPos=Math.round(moveElPos+speed*time/friction),snap||(newPos=virtualPos),(!forwardFLAG&&virtualPos>max||forwardFLAG&&min>virtualPos)&&(limitPos=forwardFLAG?min:max,overPos=virtualPos-limitPos,snap||(newPos=limitPos),overPos=minMaxLimit(newPos+.03*overPos,limitPos-50,limitPos+50),time=Math.abs((moveElPos-overPos)/(speed/friction)))),time*=slowFLAG?10:1,(options.onEnd||noop).call(el,$.extend(result,{moved:result.moved||longTouchFLAG&&snap,pos:moveElPos,newPos:newPos,overPos:overPos,time:time}))}}var startCoo,coo,startElPos,moveElPos,edge,moveTrack,startTime,endTime,min,max,snap,slowFLAG,controlFLAG,moved,tracked,el=$el[0],elData=$el.data(),tail={};return tail=$.extend(touch(options.$wrap,$.extend({},options,{onStart:onStart,onMove:onMove,onEnd:onEnd})),tail)}function wheel($el,options){var lockFLAG,lastDirection,lastNow,el=$el[0],tail={prevent:{}};return addEvent(el,WHEEL,function(e){var yDelta=e.wheelDeltaY||-1*e.deltaY||0,xDelta=e.wheelDeltaX||-1*e.deltaX||0,xWin=Math.abs(xDelta)&&!Math.abs(yDelta),direction=getDirectionSign(0>xDelta),sameDirection=lastDirection===direction,now=$.now(),tooFast=TOUCH_TIMEOUT>now-lastNow;lastDirection=direction,lastNow=now,xWin&&tail.ok&&(!tail.prevent[direction]||lockFLAG)&&(stopEvent(e,!0),lockFLAG&&sameDirection&&tooFast||(options.shift&&(lockFLAG=!0,clearTimeout(tail.t),tail.t=setTimeout(function(){lockFLAG=!1},SCROLL_LOCK_TIMEOUT)),(options.onEnd||noop)(e,options.shift?direction:xDelta)))}),tail}function calculateIndexes(){$.each($.Fotorama.instances,function(index,instance){instance.index=index})}function addInstance(instance){$.Fotorama.instances.push(instance),calculateIndexes()}function hideInstance(instance){$.Fotorama.instances.splice(instance.index,1),calculateIndexes()}var _fotoramaClass="fotorama",_fullscreenClass="fullscreen",wrapClass=_fotoramaClass+"__wrap",wrapCss2Class=wrapClass+"--css2",wrapCss3Class=wrapClass+"--css3",wrapVideoClass=wrapClass+"--video",wrapFadeClass=wrapClass+"--fade",wrapSlideClass=wrapClass+"--slide",wrapNoControlsClass=wrapClass+"--no-controls",wrapNoShadowsClass=wrapClass+"--no-shadows",wrapPanYClass=wrapClass+"--pan-y",wrapRtlClass=wrapClass+"--rtl",wrapOnlyActiveClass=wrapClass+"--only-active",wrapNoCaptionsClass=wrapClass+"--no-captions",wrapToggleArrowsClass=wrapClass+"--toggle-arrows",stageClass=_fotoramaClass+"__stage",stageFrameClass=stageClass+"__frame",stageFrameVideoClass=stageFrameClass+"--video",stageShaftClass=stageClass+"__shaft",grabClass=_fotoramaClass+"__grab",pointerClass=_fotoramaClass+"__pointer",arrClass=_fotoramaClass+"__arr",arrDisabledClass=arrClass+"--disabled",arrPrevClass=arrClass+"--prev",arrNextClass=arrClass+"--next",navClass=_fotoramaClass+"__nav",navWrapClass=navClass+"-wrap",navShaftClass=navClass+"__shaft",navDotsClass=navClass+"--dots",navThumbsClass=navClass+"--thumbs",navFrameClass=navClass+"__frame",navFrameDotClass=navFrameClass+"--dot",navFrameThumbClass=navFrameClass+"--thumb",fadeClass=_fotoramaClass+"__fade",fadeFrontClass=fadeClass+"-front",fadeRearClass=fadeClass+"-rear",shadowClass=_fotoramaClass+"__shadow",shadowsClass=shadowClass+"s",shadowsLeftClass=shadowsClass+"--left",shadowsRightClass=shadowsClass+"--right",activeClass=_fotoramaClass+"__active",selectClass=_fotoramaClass+"__select",hiddenClass=_fotoramaClass+"--hidden",fullscreenClass=_fotoramaClass+"--fullscreen",fullscreenIconClass=_fotoramaClass+"__fullscreen-icon",errorClass=_fotoramaClass+"__error",loadingClass=_fotoramaClass+"__loading",loadedClass=_fotoramaClass+"__loaded",loadedFullClass=loadedClass+"--full",loadedImgClass=loadedClass+"--img",grabbingClass=_fotoramaClass+"__grabbing",imgClass=_fotoramaClass+"__img",imgFullClass=imgClass+"--full",dotClass=_fotoramaClass+"__dot",thumbClass=_fotoramaClass+"__thumb",thumbBorderClass=thumbClass+"-border",htmlClass=_fotoramaClass+"__html",videoClass=_fotoramaClass+"__video",videoPlayClass=videoClass+"-play",videoCloseClass=videoClass+"-close",captionClass=_fotoramaClass+"__caption",captionWrapClass=_fotoramaClass+"__caption__wrap",spinnerClass=_fotoramaClass+"__spinner",buttonAttributes='" tabindex="0" role="button',JQUERY_VERSION=$&&$.fn.jquery.split(".");if(!JQUERY_VERSION||JQUERY_VERSION[0]<1||1==JQUERY_VERSION[0]&&JQUERY_VERSION[1]<8)throw"Fotorama requires jQuery 1.8 or later and will not run without it.";var _={},Modernizr=function(window,document,undefined){function setCss(str){mStyle.cssText=str}function is(obj,type){return typeof obj===type}function contains(str,substr){return!!~(""+str).indexOf(substr)}function testProps(props,prefixed){for(var i in props){var prop=props[i];if(!contains(prop,"-")&&mStyle[prop]!==undefined)return"pfx"==prefixed?prop:!0}return!1}function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined)return elem===!1?props[i]:is(item,"function")?item.bind(elem||obj):item}return!1}function testPropsAll(prop,prefixed,elem){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+" "+cssomPrefixes.join(ucProp+" ")+ucProp).split(" ");return is(prefixed,"string")||is(prefixed,"undefined")?testProps(props,prefixed):(props=(prop+" "+domPrefixes.join(ucProp+" ")+ucProp).split(" "),testDOMProps(props,prefixed,elem))}var inputElem,featureName,hasOwnProp,version="2.6.2",Modernizr={},docElement=document.documentElement,mod="modernizr",modElem=document.createElement(mod),mStyle=modElem.style,prefixes=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),omPrefixes="Webkit Moz O ms",cssomPrefixes=omPrefixes.split(" "),domPrefixes=omPrefixes.toLowerCase().split(" "),tests={},classes=[],slice=classes.slice,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement("div"),body=document.body,fakeBody=body||document.createElement("body");if(parseInt(nodes,10))for(;nodes--;)node=document.createElement("div"),node.id=testnames?testnames[nodes]:mod+(nodes+1),div.appendChild(node);return style=["&#173;",'<style id="s',mod,'">',rule,"</style>"].join(""),div.id=mod,(body?div:fakeBody).innerHTML+=style,fakeBody.appendChild(div),body||(fakeBody.style.background="",fakeBody.style.overflow="hidden",docOverflow=docElement.style.overflow,docElement.style.overflow="hidden",docElement.appendChild(fakeBody)),ret=callback(div,rule),body?div.parentNode.removeChild(div):(fakeBody.parentNode.removeChild(fakeBody),docElement.style.overflow=docOverflow),!!ret},_hasOwnProperty={}.hasOwnProperty;hasOwnProp=is(_hasOwnProperty,"undefined")||is(_hasOwnProperty.call,"undefined")?function(object,property){return property in object&&is(object.constructor.prototype[property],"undefined")}:function(object,property){return _hasOwnProperty.call(object,property)},Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError;var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F,result=target.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return target.apply(that,args.concat(slice.call(arguments)))};return bound}),tests.csstransforms3d=function(){var ret=!!testPropsAll("perspective");return ret};for(var feature in tests)hasOwnProp(tests,feature)&&(featureName=feature.toLowerCase(),Modernizr[featureName]=tests[feature](),classes.push((Modernizr[featureName]?"":"no-")+featureName));return Modernizr.addTest=function(feature,test){if("object"==typeof feature)for(var key in feature)hasOwnProp(feature,key)&&Modernizr.addTest(key,feature[key]);else{if(feature=feature.toLowerCase(),Modernizr[feature]!==undefined)return Modernizr;test="function"==typeof test?test():test,"undefined"!=typeof enableClasses&&enableClasses&&(docElement.className+=" "+(test?"":"no-")+feature),Modernizr[feature]=test}return Modernizr},setCss(""),modElem=inputElem=null,Modernizr._version=version,Modernizr._prefixes=prefixes,Modernizr._domPrefixes=domPrefixes,Modernizr._cssomPrefixes=cssomPrefixes,Modernizr.testProp=function(prop){return testProps([prop])},Modernizr.testAllProps=testPropsAll,Modernizr.testStyles=injectElementWithStyles,Modernizr.prefixed=function(prop,obj,elem){return obj?testPropsAll(prop,obj,elem):testPropsAll(prop,"pfx")},Modernizr}(window,document),fullScreenApi={ok:!1,is:function(){return!1},request:function(){},cancel:function(){},event:"",prefix:""},browserPrefixes="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)fullScreenApi.ok=!0;else for(var i=0,il=browserPrefixes.length;il>i;i++)if(fullScreenApi.prefix=browserPrefixes[i],"undefined"!=typeof document[fullScreenApi.prefix+"CancelFullScreen"]){fullScreenApi.ok=!0;break}fullScreenApi.ok&&(fullScreenApi.event=fullScreenApi.prefix+"fullscreenchange",fullScreenApi.is=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},fullScreenApi.request=function(el){return""===this.prefix?el.requestFullScreen():el[this.prefix+"RequestFullScreen"]()},fullScreenApi.cancel=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()});var Spinner,spinnerDefaults={lines:12,length:5,width:2,radius:7,corners:1,rotate:15,color:"rgba(128, 128, 128, .75)",hwaccel:!0},spinnerOverride={top:"auto",left:"auto",className:""};!function(root,factory){Spinner=factory()}(this,function(){function createEl(tag,prop){var n,el=document.createElement(tag||"div");for(n in prop)el[n]=prop[n];return el}function ins(parent){for(var i=1,n=arguments.length;n>i;i++)parent.appendChild(arguments[i]);return parent}function addAnimation(alpha,trail,i,lines){var name=["opacity",trail,~~(100*alpha),i,lines].join("-"),start=.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf("Animation")).toLowerCase(),pre=prefix&&"-"+prefix+"-"||"";return animations[name]||(sheet.insertRule("@"+pre+"keyframes "+name+"{0%{opacity:"+z+"}"+start+"%{opacity:"+alpha+"}"+(start+.01)+"%{opacity:1}"+(start+trail)%100+"%{opacity:"+alpha+"}100%{opacity:"+z+"}}",sheet.cssRules.length),animations[name]=1),name}function vendor(el,prop){var pp,i,s=el.style;for(prop=prop.charAt(0).toUpperCase()+prop.slice(1),i=0;i<prefixes.length;i++)if(pp=prefixes[i]+prop,s[pp]!==undefined)return pp;return s[prop]!==undefined?prop:void 0}function css(el,prop){for(var n in prop)el.style[vendor(el,n)||n]=prop[n];return el}function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def)obj[n]===undefined&&(obj[n]=def[n])}return obj}function pos(el){for(var o={x:el.offsetLeft,y:el.offsetTop};el=el.offsetParent;)o.x+=el.offsetLeft,o.y+=el.offsetTop;return o}function getColor(color,idx){return"string"==typeof color?color:color[idx%color.length]}function Spinner(o){return"undefined"==typeof this?new Spinner(o):void(this.opts=merge(o||{},Spinner.defaults,defaults))}function initVML(){function vml(tag,attr){return createEl("<"+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}sheet.addRule(".spin-vml","behavior:url(#default#VML)"),Spinner.prototype.lines=function(el,o){function grp(){return css(vml("group",{coordsize:s+" "+s,coordorigin:-r+" "+-r}),{width:s,height:s})}function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+"deg",left:~~dx}),ins(css(vml("roundrect",{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml("fill",{color:getColor(o.color,i),opacity:o.opacity}),vml("stroke",{opacity:0}))))}var i,r=o.length+o.width,s=2*r,margin=2*-(o.width+o.length)+"px",g=css(grp(),{position:"absolute",top:margin,left:margin});if(o.shadow)for(i=1;i<=o.lines;i++)seg(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=o.lines;i++)seg(i);return ins(el,g)},Spinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0,c&&i+o<c.childNodes.length&&(c=c.childNodes[i+o],c=c&&c.firstChild,c=c&&c.firstChild,c&&(c.opacity=val))}}var useCssAnimations,prefixes=["webkit","Moz","ms","O"],animations={},sheet=function(){var el=createEl("style",{type:"text/css"});return ins(document.getElementsByTagName("head")[0],el),el.sheet||el.styleSheet}(),defaults={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};Spinner.defaults={},merge(Spinner.prototype,{spin:function(target){this.stop();var ep,tp,self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width;if(target&&(target.insertBefore(el,target.firstChild||null),tp=pos(target),ep=pos(el),css(el,{left:("auto"==o.left?tp.x-ep.x+(target.offsetWidth>>1):parseInt(o.left,10)+mid)+"px",top:("auto"==o.top?tp.y-ep.y+(target.offsetHeight>>1):parseInt(o.top,10)+mid)+"px"})),el.setAttribute("role","progressbar"),self.lines(el,self.opts),!useCssAnimations){var alpha,i=0,start=(o.lines-1)*(1-o.direction)/2,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;!function anim(){i++;for(var j=0;j<o.lines;j++)alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity),self.opacity(el,j*o.direction+start,alpha,o);self.timeout=self.el&&setTimeout(anim,~~(1e3/fps))}()}return self},stop:function(){var el=this.el;return el&&(clearTimeout(this.timeout),el.parentNode&&el.parentNode.removeChild(el),this.el=undefined),this},lines:function(el,o){function fill(color,shadow){return css(createEl(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:color,boxShadow:shadow,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*i+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var seg,i=0,start=(o.lines-1)*(1-o.direction)/2;i<o.lines;i++)seg=css(createEl(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&ins(seg,css(fill("#000","0 0 4px #000"),{top:"2px"})),ins(el,ins(seg,fill(getColor(o.color,i),"0 0 1px rgba(0,0,0,.1)")));return el},opacity:function(el,i,val){i<el.childNodes.length&&(el.childNodes[i].style.opacity=val)}});var probe=css(createEl("group"),{behavior:"url(#default#VML)"});return!vendor(probe,"transform")&&probe.adj?initVML():useCssAnimations=vendor(probe,"animation"),Spinner});var $HTML,$BODY,$WINDOW=$(window),$DOCUMENT=$(document),QUIRKS_FORCE="quirks"===location.hash.replace("#",""),TRANSFORMS3D=Modernizr.csstransforms3d,CSS3=TRANSFORMS3D&&!QUIRKS_FORCE,COMPAT=TRANSFORMS3D||"CSS1Compat"===document.compatMode,FULLSCREEN=fullScreenApi.ok,MOBILE=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),SLOW=!CSS3||MOBILE,MS_POINTER=navigator.msPointerEnabled,WHEEL="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll",TOUCH_TIMEOUT=250,TRANSITION_DURATION=300,SCROLL_LOCK_TIMEOUT=1400,AUTOPLAY_INTERVAL=5e3,MARGIN=2,THUMB_SIZE=64,WIDTH=500,HEIGHT=333,STAGE_FRAME_KEY="$stageFrame",NAV_DOT_FRAME_KEY="$navDotFrame",NAV_THUMB_FRAME_KEY="$navThumbFrame",AUTO="auto",BEZIER=bez([.1,0,.25,1]),MAX_WIDTH=99999,FIFTYFIFTY="50%",OPTIONS={
width:null,minwidth:null,maxwidth:"100%",height:null,minheight:null,maxheight:null,ratio:null,margin:MARGIN,glimpse:0,fit:"contain",position:FIFTYFIFTY,thumbposition:FIFTYFIFTY,nav:"dots",navposition:"bottom",navwidth:null,thumbwidth:THUMB_SIZE,thumbheight:THUMB_SIZE,thumbmargin:MARGIN,thumbborderwidth:MARGIN,thumbfit:"cover",allowfullscreen:!1,transition:"slide",clicktransition:null,transitionduration:TRANSITION_DURATION,captions:!0,hash:!1,startindex:0,loop:!1,autoplay:!1,stopautoplayontouch:!0,keyboard:!1,arrows:!0,click:!0,swipe:!0,trackpad:!1,enableifsingleframe:!1,controlsonstart:!0,shuffle:!1,direction:"ltr",shadows:!0,spinner:null},KEYBOARD_OPTIONS={left:!0,right:!0,down:!1,up:!1,space:!1,home:!1,end:!1};waitFor.stop=function(i){waitFor.ii[i]=!1};var lastEvent,moveEventType,preventEvent,preventEventTimeout;jQuery.Fotorama=function($fotorama,opts){function checkForVideo(){$.each(data,function(i,dataFrame){if(!dataFrame.i){dataFrame.i=dataFrameCount++;var video=findVideoId(dataFrame.video,!0);if(video){var thumbs={};dataFrame.video=video,dataFrame.img||dataFrame.thumb?dataFrame.thumbsReady=!0:thumbs=getVideoThumbs(dataFrame,data,that),updateData(data,{img:thumbs.img,thumb:thumbs.thumb},dataFrame.i,that)}}})}function allowKey(key){return o_keyboard[key]||that.fullScreen}function bindGlobalEvents(FLAG){var keydownCommon="keydown."+_fotoramaClass,localStamp=_fotoramaClass+stamp,keydownLocal="keydown."+localStamp,resizeLocal="resize."+localStamp+" orientationchange."+localStamp;FLAG?($DOCUMENT.on(keydownLocal,function(e){var catched,index;$videoPlaying&&27===e.keyCode?(catched=!0,unloadVideo($videoPlaying,!0,!0)):(that.fullScreen||opts.keyboard&&!that.index)&&(27===e.keyCode?(catched=!0,that.cancelFullScreen()):e.shiftKey&&32===e.keyCode&&allowKey("space")||37===e.keyCode&&allowKey("left")||38===e.keyCode&&allowKey("up")?index="<":32===e.keyCode&&allowKey("space")||39===e.keyCode&&allowKey("right")||40===e.keyCode&&allowKey("down")?index=">":36===e.keyCode&&allowKey("home")?index="<<":35===e.keyCode&&allowKey("end")&&(index=">>")),(catched||index)&&stopEvent(e),index&&that.show({index:index,slow:e.altKey,user:!0})}),that.index||$DOCUMENT.off(keydownCommon).on(keydownCommon,"textarea, input, select",function(e){!$BODY.hasClass(_fullscreenClass)&&e.stopPropagation()}),$WINDOW.on(resizeLocal,that.resize)):($DOCUMENT.off(keydownLocal),$WINDOW.off(resizeLocal))}function appendElements(FLAG){FLAG!==appendElements.f&&(FLAG?($fotorama.html("").addClass(_fotoramaClass+" "+stampClass).append($wrap).before($style).before($anchor),addInstance(that)):($wrap.detach(),$style.detach(),$anchor.detach(),$fotorama.html(fotoramaData.urtext).removeClass(stampClass),hideInstance(that)),bindGlobalEvents(FLAG),appendElements.f=FLAG)}function setData(){data=that.data=data||clone(opts.data)||getDataFromHtml($fotorama),size=that.size=data.length,!ready.ok&&opts.shuffle&&shuffle(data),checkForVideo(),activeIndex=limitIndex(activeIndex),size&&appendElements(!0)}function stageNoMove(){var _noMove=2>size&&!opts.enableifsingleframe||$videoPlaying;stageShaftTouchTail.noMove=_noMove||o_fade,stageShaftTouchTail.noSwipe=_noMove||!opts.swipe,!o_transition&&$stageShaft.toggleClass(grabClass,!opts.click&&!stageShaftTouchTail.noMove&&!stageShaftTouchTail.noSwipe),MS_POINTER&&$wrap.toggleClass(wrapPanYClass,!stageShaftTouchTail.noSwipe)}function setAutoplayInterval(interval){interval===!0&&(interval=""),opts.autoplay=Math.max(+interval||AUTOPLAY_INTERVAL,1.5*o_transitionDuration)}function setOptions(){function addOrRemoveClass(FLAG,value){classes[FLAG?"add":"remove"].push(value)}that.options=opts=optionsToLowerCase(opts),o_fade="crossfade"===opts.transition||"dissolve"===opts.transition,o_loop=opts.loop&&(size>2||o_fade&&(!o_transition||"slide"!==o_transition)),o_transitionDuration=+opts.transitionduration||TRANSITION_DURATION,o_rtl="rtl"===opts.direction,o_keyboard=$.extend({},opts.keyboard&&KEYBOARD_OPTIONS,opts.keyboard);var classes={add:[],remove:[]};size>1||opts.enableifsingleframe?(o_nav=opts.nav,o_navTop="top"===opts.navposition,classes.remove.push(selectClass),$arrs.toggle(!!opts.arrows)):(o_nav=!1,$arrs.hide()),spinnerStop(),spinner=new Spinner($.extend(spinnerDefaults,opts.spinner,spinnerOverride,{direction:o_rtl?-1:1})),arrsUpdate(),stageWheelUpdate(),opts.autoplay&&setAutoplayInterval(opts.autoplay),o_thumbSide=numberFromMeasure(opts.thumbwidth)||THUMB_SIZE,o_thumbSide2=numberFromMeasure(opts.thumbheight)||THUMB_SIZE,stageWheelTail.ok=navWheelTail.ok=opts.trackpad&&!SLOW,stageNoMove(),extendMeasures(opts,[measures]),o_navThumbs="thumbs"===o_nav,o_navThumbs?(frameDraw(size,"navThumb"),$navFrame=$navThumbFrame,navFrameKey=NAV_THUMB_FRAME_KEY,setStyle($style,$.Fotorama.jst.style({w:o_thumbSide,h:o_thumbSide2,b:opts.thumbborderwidth,m:opts.thumbmargin,s:stamp,q:!COMPAT})),$nav.addClass(navThumbsClass).removeClass(navDotsClass)):"dots"===o_nav?(frameDraw(size,"navDot"),$navFrame=$navDotFrame,navFrameKey=NAV_DOT_FRAME_KEY,$nav.addClass(navDotsClass).removeClass(navThumbsClass)):(o_nav=!1,$nav.removeClass(navThumbsClass+" "+navDotsClass)),o_nav&&(o_navTop?$navWrap.insertBefore($stage):$navWrap.insertAfter($stage),frameAppend.nav=!1,frameAppend($navFrame,$navShaft,"nav")),o_allowFullScreen=opts.allowfullscreen,o_allowFullScreen?($fullscreenIcon.prependTo($stage),o_nativeFullScreen=FULLSCREEN&&"native"===o_allowFullScreen):($fullscreenIcon.detach(),o_nativeFullScreen=!1),addOrRemoveClass(o_fade,wrapFadeClass),addOrRemoveClass(!o_fade,wrapSlideClass),addOrRemoveClass(!opts.captions,wrapNoCaptionsClass),addOrRemoveClass(o_rtl,wrapRtlClass),addOrRemoveClass("always"!==opts.arrows,wrapToggleArrowsClass),o_shadows=opts.shadows&&!SLOW,addOrRemoveClass(!o_shadows,wrapNoShadowsClass),$wrap.addClass(classes.add.join(" ")).removeClass(classes.remove.join(" ")),lastOptions=$.extend({},opts)}function normalizeIndex(index){return 0>index?(size+index%size)%size:index>=size?index%size:index}function limitIndex(index){return minMaxLimit(index,0,size-1)}function edgeIndex(index){return o_loop?normalizeIndex(index):limitIndex(index)}function getPrevIndex(index){return index>0||o_loop?index-1:!1}function getNextIndex(index){return size-1>index||o_loop?index+1:!1}function setStageShaftMinmaxAndSnap(){stageShaftTouchTail.min=o_loop?-(1/0):-getPosByIndex(size-1,measures.w,opts.margin,repositionIndex),stageShaftTouchTail.max=o_loop?1/0:-getPosByIndex(0,measures.w,opts.margin,repositionIndex),stageShaftTouchTail.snap=measures.w+opts.margin}function setNavShaftMinMax(){navShaftTouchTail.min=Math.min(0,measures.nw-$navShaft.width()),navShaftTouchTail.max=0,$navShaft.toggleClass(grabClass,!(navShaftTouchTail.noMove=navShaftTouchTail.min===navShaftTouchTail.max))}function eachIndex(indexes,type,fn){if("number"==typeof indexes){indexes=new Array(indexes);var rangeFLAG=!0}return $.each(indexes,function(i,index){if(rangeFLAG&&(index=i),"number"==typeof index){var dataFrame=data[normalizeIndex(index)];if(dataFrame){var key="$"+type+"Frame",$frame=dataFrame[key];fn.call(this,i,index,dataFrame,$frame,key,$frame&&$frame.data())}}})}function setMeasures(width,height,ratio,index){(!measuresSetFLAG||"*"===measuresSetFLAG&&index===startIndex)&&(width=measureIsValid(opts.width)||measureIsValid(width)||WIDTH,height=measureIsValid(opts.height)||measureIsValid(height)||HEIGHT,that.resize({width:width,ratio:opts.ratio||ratio||width/height},0,index!==startIndex&&"*"))}function loadImg(indexes,type,specialMeasures,method,position,again){eachIndex(indexes,type,function(i,index,dataFrame,$frame,key,frameData){function triggerTriggerEvent(event){var _index=normalizeIndex(index);triggerEvent(event,{index:_index,src:src,frame:data[_index]})}function error(){$img.remove(),$.Fotorama.cache[src]="error",dataFrame.html&&"stage"===type||!dummy||dummy===src?(!src||dataFrame.html||fullFLAG?"stage"===type&&($frame.trigger("f:load").removeClass(loadingClass+" "+errorClass).addClass(loadedClass),triggerTriggerEvent("load"),setMeasures()):($frame.trigger("f:error").removeClass(loadingClass).addClass(errorClass),triggerTriggerEvent("error")),frameData.state="error",!(size>1&&data[index]===dataFrame)||dataFrame.html||dataFrame.deleted||dataFrame.video||fullFLAG||(dataFrame.deleted=!0,that.splice(index,1))):(dataFrame[srcKey]=src=dummy,loadImg([index],type,specialMeasures,method,position,!0))}function loaded(){$.Fotorama.measures[src]=imgData.measures=$.Fotorama.measures[src]||{width:img.width,height:img.height,ratio:img.width/img.height},setMeasures(imgData.measures.width,imgData.measures.height,imgData.measures.ratio,index),$img.off("load error").addClass(imgClass+(fullFLAG?" "+imgFullClass:"")).prependTo($frame),fit($img,($.isFunction(specialMeasures)?specialMeasures():specialMeasures)||measures,method||dataFrame.fit||opts.fit,position||dataFrame.position||opts.position),$.Fotorama.cache[src]=frameData.state="loaded",setTimeout(function(){$frame.trigger("f:load").removeClass(loadingClass+" "+errorClass).addClass(loadedClass+" "+(fullFLAG?loadedFullClass:loadedImgClass)),"stage"===type?triggerTriggerEvent("load"):(dataFrame.thumbratio===AUTO||!dataFrame.thumbratio&&opts.thumbratio===AUTO)&&(dataFrame.thumbratio=imgData.measures.ratio,reset())},0)}function waitAndLoad(){var _i=10;waitFor(function(){return!touchedFLAG||!_i--&&!SLOW},function(){loaded()})}if($frame){var fullFLAG=that.fullScreen&&dataFrame.full&&dataFrame.full!==dataFrame.img&&!frameData.$full&&"stage"===type;if(!frameData.$img||again||fullFLAG){var img=new Image,$img=$(img),imgData=$img.data();frameData[fullFLAG?"$full":"$img"]=$img;var srcKey="stage"===type?fullFLAG?"full":"img":"thumb",src=dataFrame[srcKey],dummy=fullFLAG?null:dataFrame["stage"===type?"thumb":"img"];if("navThumb"===type&&($frame=frameData.$wrap),!src)return void error();$.Fotorama.cache[src]?!function justWait(){"error"===$.Fotorama.cache[src]?error():"loaded"===$.Fotorama.cache[src]?setTimeout(waitAndLoad,0):setTimeout(justWait,100)}():($.Fotorama.cache[src]="*",$img.on("load",waitAndLoad).on("error",error)),frameData.state="",img.src=src}}})}function spinnerSpin($el){$spinner.append(spinner.spin().el).appendTo($el)}function spinnerStop(){$spinner.detach(),spinner&&spinner.stop()}function updateFotoramaState(){var $frame=activeFrame[STAGE_FRAME_KEY];$frame&&!$frame.data().state&&(spinnerSpin($frame),$frame.on("f:load f:error",function(){$frame.off("f:load f:error"),spinnerStop()}))}function addNavFrameEvents(frame){addEnterUp(frame,onNavFrameClick),addFocus(frame,function(){setTimeout(function(){lockScroll($nav)},0),slideNavShaft({time:o_transitionDuration,guessIndex:$(this).data().eq,minMax:navShaftTouchTail})})}function frameDraw(indexes,type){eachIndex(indexes,type,function(i,index,dataFrame,$frame,key,frameData){if(!$frame){$frame=dataFrame[key]=$wrap[key].clone(),frameData=$frame.data(),frameData.data=dataFrame;var frame=$frame[0];"stage"===type?(dataFrame.html&&$('<div class="'+htmlClass+'"></div>').append(dataFrame._html?$(dataFrame.html).removeAttr("id").html(dataFrame._html):dataFrame.html).appendTo($frame),dataFrame.caption&&$(div(captionClass,div(captionWrapClass,dataFrame.caption))).appendTo($frame),dataFrame.video&&$frame.addClass(stageFrameVideoClass).append($videoPlay.clone()),addFocus(frame,function(){setTimeout(function(){lockScroll($stage)},0),clickToShow({index:frameData.eq,user:!0})}),$stageFrame=$stageFrame.add($frame)):"navDot"===type?(addNavFrameEvents(frame),$navDotFrame=$navDotFrame.add($frame)):"navThumb"===type&&(addNavFrameEvents(frame),frameData.$wrap=$frame.children(":first"),$navThumbFrame=$navThumbFrame.add($frame),dataFrame.video&&frameData.$wrap.append($videoPlay.clone()))}})}function callFit($img,measuresToFit,method,position){return $img&&$img.length&&fit($img,measuresToFit,method,position)}function stageFramePosition(indexes){eachIndex(indexes,"stage",function(i,index,dataFrame,$frame,key,frameData){if($frame){var normalizedIndex=normalizeIndex(index),method=dataFrame.fit||opts.fit,position=dataFrame.position||opts.position;frameData.eq=normalizedIndex,toDetach[STAGE_FRAME_KEY][normalizedIndex]=$frame.css($.extend({left:o_fade?0:getPosByIndex(index,measures.w,opts.margin,repositionIndex)},o_fade&&getDuration(0))),isDetached($frame[0])&&($frame.appendTo($stageShaft),unloadVideo(dataFrame.$video)),callFit(frameData.$img,measures,method,position),callFit(frameData.$full,measures,method,position)}})}function thumbsDraw(pos,loadFLAG){if("thumbs"===o_nav&&!isNaN(pos)){var leftLimit=-pos,rightLimit=-pos+measures.nw;$navThumbFrame.each(function(){var $this=$(this),thisData=$this.data(),eq=thisData.eq,getSpecialMeasures=function(){return{h:o_thumbSide2,w:thisData.w}},specialMeasures=getSpecialMeasures(),dataFrame=data[eq]||{},method=dataFrame.thumbfit||opts.thumbfit,position=dataFrame.thumbposition||opts.thumbposition;specialMeasures.w=thisData.w,thisData.l+thisData.w<leftLimit||thisData.l>rightLimit||callFit(thisData.$img,specialMeasures,method,position)||loadFLAG&&loadImg([eq],"navThumb",getSpecialMeasures,method,position)})}}function frameAppend($frames,$shaft,type){if(!frameAppend[type]){var thumbsFLAG="nav"===type&&o_navThumbs,left=0;$shaft.append($frames.filter(function(){for(var actual,$this=$(this),frameData=$this.data(),_i=0,_l=data.length;_l>_i;_i++)if(frameData.data===data[_i]){actual=!0,frameData.eq=_i;break}return actual||$this.remove()&&!1}).sort(function(a,b){return $(a).data().eq-$(b).data().eq}).each(function(){if(thumbsFLAG){var $this=$(this),frameData=$this.data(),thumbwidth=Math.round(o_thumbSide2*frameData.data.thumbratio)||o_thumbSide;frameData.l=left,frameData.w=thumbwidth,$this.css({width:thumbwidth}),left+=thumbwidth+opts.thumbmargin}})),frameAppend[type]=!0}}function getDirection(x){return x-stageLeft>measures.w/3}function disableDirrection(i){return!(o_loop||activeIndex+i&&activeIndex-size+i||$videoPlaying)}function arrsUpdate(){var disablePrev=disableDirrection(0),disableNext=disableDirrection(1);$arrPrev.toggleClass(arrDisabledClass,disablePrev).attr(disableAttr(disablePrev)),$arrNext.toggleClass(arrDisabledClass,disableNext).attr(disableAttr(disableNext))}function stageWheelUpdate(){stageWheelTail.ok&&(stageWheelTail.prevent={"<":disableDirrection(0),">":disableDirrection(1)})}function getNavFrameBounds($navFrame){var left,width,navFrameData=$navFrame.data();return o_navThumbs?(left=navFrameData.l,width=navFrameData.w):(left=$navFrame.position().left,width=$navFrame.width()),{c:left+width/2,min:-left+10*opts.thumbmargin,max:-left+measures.w-width-10*opts.thumbmargin}}function slideThumbBorder(time){var navFrameData=activeFrame[navFrameKey].data();slide($thumbBorder,{time:1.2*time,pos:navFrameData.l,width:navFrameData.w-2*opts.thumbborderwidth})}function slideNavShaft(options){var $guessNavFrame=data[options.guessIndex][navFrameKey];if($guessNavFrame){var overflowFLAG=navShaftTouchTail.min!==navShaftTouchTail.max,minMax=options.minMax||overflowFLAG&&getNavFrameBounds(activeFrame[navFrameKey]),l=overflowFLAG&&(options.keep&&slideNavShaft.l?slideNavShaft.l:minMaxLimit((options.coo||measures.nw/2)-getNavFrameBounds($guessNavFrame).c,minMax.min,minMax.max)),pos=overflowFLAG&&minMaxLimit(l,navShaftTouchTail.min,navShaftTouchTail.max),time=1.1*options.time;slide($navShaft,{time:time,pos:pos||0,onEnd:function(){thumbsDraw(pos,!0)}}),setShadow($nav,findShadowEdge(pos,navShaftTouchTail.min,navShaftTouchTail.max)),slideNavShaft.l=l}}function navUpdate(){deactivateFrames(navFrameKey),toDeactivate[navFrameKey].push(activeFrame[navFrameKey].addClass(activeClass))}function deactivateFrames(key){for(var _toDeactivate=toDeactivate[key];_toDeactivate.length;)_toDeactivate.shift().removeClass(activeClass)}function detachFrames(key){var _toDetach=toDetach[key];$.each(activeIndexes,function(i,index){delete _toDetach[normalizeIndex(index)]}),$.each(_toDetach,function(index,$frame){delete _toDetach[index],$frame.detach()})}function stageShaftReposition(skipOnEnd){repositionIndex=dirtyIndex=activeIndex;var $frame=activeFrame[STAGE_FRAME_KEY];$frame&&(deactivateFrames(STAGE_FRAME_KEY),toDeactivate[STAGE_FRAME_KEY].push($frame.addClass(activeClass)),skipOnEnd||that.show.onEnd(!0),stop($stageShaft,0,!0),detachFrames(STAGE_FRAME_KEY),stageFramePosition(activeIndexes),setStageShaftMinmaxAndSnap(),setNavShaftMinMax())}function extendMeasures(options,measuresArray){options&&$.each(measuresArray,function(i,measures){measures&&$.extend(measures,{width:options.width||measures.width,height:options.height,minwidth:options.minwidth,maxwidth:options.maxwidth,minheight:options.minheight,maxheight:options.maxheight,ratio:getRatio(options.ratio)})})}function triggerEvent(event,extra){$fotorama.trigger(_fotoramaClass+":"+event,[that,extra])}function onTouchStart(){clearTimeout(onTouchEnd.t),touchedFLAG=1,opts.stopautoplayontouch?that.stopAutoplay():pausedAutoplayFLAG=!0}function onTouchEnd(){touchedFLAG&&(opts.stopautoplayontouch||(releaseAutoplay(),changeAutoplay()),onTouchEnd.t=setTimeout(function(){touchedFLAG=0},TRANSITION_DURATION+TOUCH_TIMEOUT))}function releaseAutoplay(){pausedAutoplayFLAG=!(!$videoPlaying&&!stoppedAutoplayFLAG)}function changeAutoplay(){if(clearTimeout(changeAutoplay.t),waitFor.stop(changeAutoplay.w),!opts.autoplay||pausedAutoplayFLAG)return void(that.autoplay&&(that.autoplay=!1,triggerEvent("stopautoplay")));that.autoplay||(that.autoplay=!0,triggerEvent("startautoplay"));var _activeIndex=activeIndex,frameData=activeFrame[STAGE_FRAME_KEY].data();changeAutoplay.w=waitFor(function(){return frameData.state||_activeIndex!==activeIndex},function(){changeAutoplay.t=setTimeout(function(){if(!pausedAutoplayFLAG&&_activeIndex===activeIndex){var _nextAutoplayIndex=nextAutoplayIndex,nextFrameData=data[_nextAutoplayIndex][STAGE_FRAME_KEY].data();changeAutoplay.w=waitFor(function(){return nextFrameData.state||_nextAutoplayIndex!==nextAutoplayIndex},function(){pausedAutoplayFLAG||_nextAutoplayIndex!==nextAutoplayIndex||that.show(o_loop?getDirectionSign(!o_rtl):nextAutoplayIndex)})}},opts.autoplay)})}function cancelFullScreen(){that.fullScreen&&(that.fullScreen=!1,FULLSCREEN&&fullScreenApi.cancel(fotorama),$BODY.removeClass(_fullscreenClass),$HTML.removeClass(_fullscreenClass),$fotorama.removeClass(fullscreenClass).insertAfter($anchor),measures=$.extend({},measuresStash),unloadVideo($videoPlaying,!0,!0),updateTouchTails("x",!1),that.resize(),loadImg(activeIndexes,"stage"),lockScroll($WINDOW,scrollLeft,scrollTop),triggerEvent("fullscreenexit"))}function setShadow($el,edge){o_shadows&&($el.removeClass(shadowsLeftClass+" "+shadowsRightClass),edge&&!$videoPlaying&&$el.addClass(edge.replace(/^|\s/g," "+shadowsClass+"--")))}function unloadVideo($video,unloadActiveFLAG,releaseAutoplayFLAG){unloadActiveFLAG&&($wrap.removeClass(wrapVideoClass),$videoPlaying=!1,stageNoMove()),$video&&$video!==$videoPlaying&&($video.remove(),triggerEvent("unloadvideo")),releaseAutoplayFLAG&&(releaseAutoplay(),changeAutoplay())}function toggleControlsClass(FLAG){$wrap.toggleClass(wrapNoControlsClass,FLAG)}function stageCursor(e){if(!stageShaftTouchTail.flow){var x=e?e.pageX:stageCursor.x,pointerFLAG=x&&!disableDirrection(getDirection(x))&&opts.click;stageCursor.p!==pointerFLAG&&$stage.toggleClass(pointerClass,pointerFLAG)&&(stageCursor.p=pointerFLAG,stageCursor.x=x)}}function clickToShow(showOptions){clearTimeout(clickToShow.t),opts.clicktransition&&opts.clicktransition!==opts.transition?setTimeout(function(){var _o_transition=opts.transition;that.setOptions({transition:opts.clicktransition}),o_transition=_o_transition,clickToShow.t=setTimeout(function(){that.show(showOptions)},10)},0):that.show(showOptions)}function onStageTap(e,toggleControlsFLAG){var target=e.target,$target=$(target);$target.hasClass(videoPlayClass)?that.playVideo():target===fullscreenIcon?that.toggleFullScreen():$videoPlaying?target===videoClose&&unloadVideo($videoPlaying,!0,!0):toggleControlsFLAG?toggleControlsClass():opts.click&&clickToShow({index:e.shiftKey||getDirectionSign(getDirection(e._x)),slow:e.altKey,user:!0})}function updateTouchTails(key,value){stageShaftTouchTail[key]=navShaftTouchTail[key]=value}function onNavFrameClick(e){var index=$(this).data().eq;clickToShow({index:index,slow:e.altKey,user:!0,coo:e._x-$nav.offset().left})}function onArrClick(e){clickToShow({index:$arrs.index(this)?">":"<",slow:e.altKey,user:!0})}function addFocusOnControls(el){addFocus(el,function(){setTimeout(function(){lockScroll($stage)},0),toggleControlsClass(!1)})}function reset(){if(setData(),setOptions(),!reset.i){reset.i=!0;var _startindex=opts.startindex;(_startindex||opts.hash&&location.hash)&&(startIndex=getIndexFromHash(_startindex||location.hash.replace(/^#/,""),data,0===that.index||_startindex,_startindex)),activeIndex=repositionIndex=dirtyIndex=lastActiveIndex=startIndex=edgeIndex(startIndex)||0}if(size){if(changeToRtl())return;$videoPlaying&&unloadVideo($videoPlaying,!0),activeIndexes=[],detachFrames(STAGE_FRAME_KEY),reset.ok=!0,that.show({index:activeIndex,time:0}),that.resize()}else that.destroy()}function changeToRtl(){return!changeToRtl.f===o_rtl?(changeToRtl.f=o_rtl,activeIndex=size-1-activeIndex,that.reverse(),!0):void 0}function ready(){ready.ok||(ready.ok=!0,triggerEvent("ready"))}$HTML=$("html"),$BODY=$("body");var data,size,$navFrame,spinner,$videoPlaying,activeFrame,activeIndexes,repositionIndex,dirtyIndex,lastActiveIndex,prevIndex,nextIndex,nextAutoplayIndex,startIndex,o_loop,o_nav,o_navThumbs,o_navTop,o_allowFullScreen,o_nativeFullScreen,o_fade,o_thumbSide,o_thumbSide2,o_transitionDuration,o_transition,o_shadows,o_rtl,o_keyboard,measuresSetFLAG,scrollTop,scrollLeft,showedFLAG,pausedAutoplayFLAG,stoppedAutoplayFLAG,measuresStash,touchedFLAG,hoverFLAG,navFrameKey,that=this,stamp=$.now(),stampClass=_fotoramaClass+stamp,fotorama=$fotorama[0],dataFrameCount=1,fotoramaData=$fotorama.data(),$style=$("<style></style>"),$anchor=$(div(hiddenClass)),$wrap=$(div(wrapClass)),$stage=$(div(stageClass)).appendTo($wrap),$stageShaft=($stage[0],$(div(stageShaftClass)).appendTo($stage)),$stageFrame=$(),$arrPrev=$(div(arrClass+" "+arrPrevClass+buttonAttributes)),$arrNext=$(div(arrClass+" "+arrNextClass+buttonAttributes)),$arrs=$arrPrev.add($arrNext).appendTo($stage),$navWrap=$(div(navWrapClass)),$nav=$(div(navClass)).appendTo($navWrap),$navShaft=$(div(navShaftClass)).appendTo($nav),$navDotFrame=$(),$navThumbFrame=$(),$thumbBorder=($stageShaft.data(),$navShaft.data(),$(div(thumbBorderClass)).appendTo($navShaft)),$fullscreenIcon=$(div(fullscreenIconClass+buttonAttributes)),fullscreenIcon=$fullscreenIcon[0],$videoPlay=$(div(videoPlayClass)),$videoClose=$(div(videoCloseClass)).appendTo($stage),videoClose=$videoClose[0],$spinner=$(div(spinnerClass)),activeIndex=!1,lastOptions={},measures={},stageShaftTouchTail={},stageWheelTail={},navShaftTouchTail={},navWheelTail={},toDeactivate={},toDetach={},stageLeft=0,fadeStack=[];$wrap[STAGE_FRAME_KEY]=$(div(stageFrameClass)),$wrap[NAV_THUMB_FRAME_KEY]=$(div(navFrameClass+" "+navFrameThumbClass+buttonAttributes,div(thumbClass))),$wrap[NAV_DOT_FRAME_KEY]=$(div(navFrameClass+" "+navFrameDotClass+buttonAttributes,div(dotClass))),toDeactivate[STAGE_FRAME_KEY]=[],toDeactivate[NAV_THUMB_FRAME_KEY]=[],toDeactivate[NAV_DOT_FRAME_KEY]=[],toDetach[STAGE_FRAME_KEY]={},$wrap.addClass(CSS3?wrapCss3Class:wrapCss2Class).toggleClass(wrapNoControlsClass,!opts.controlsonstart),fotoramaData.fotorama=this,that.startAutoplay=function(interval){return that.autoplay?this:(pausedAutoplayFLAG=stoppedAutoplayFLAG=!1,setAutoplayInterval(interval||opts.autoplay),changeAutoplay(),this)},that.stopAutoplay=function(){return that.autoplay&&(pausedAutoplayFLAG=stoppedAutoplayFLAG=!0,changeAutoplay()),this},that.show=function(options){var index;"object"!=typeof options?(index=options,options={}):index=options.index,index=">"===index?dirtyIndex+1:"<"===index?dirtyIndex-1:"<<"===index?0:">>"===index?size-1:index,index=isNaN(index)?getIndexFromHash(index,data,!0):index,index="undefined"==typeof index?activeIndex||0:index,that.activeIndex=activeIndex=edgeIndex(index),prevIndex=getPrevIndex(activeIndex),nextIndex=getNextIndex(activeIndex),nextAutoplayIndex=normalizeIndex(activeIndex+(o_rtl?-1:1)),activeIndexes=[activeIndex,prevIndex,nextIndex],dirtyIndex=o_loop?index:activeIndex;var diffIndex=Math.abs(lastActiveIndex-dirtyIndex),time=getNumber(options.time,function(){return Math.min(o_transitionDuration*(1+(diffIndex-1)/12),2*o_transitionDuration)}),overPos=options.overPos;options.slow&&(time*=10);var _activeFrame=activeFrame;that.activeFrame=activeFrame=data[activeIndex];var silent=_activeFrame===activeFrame&&!options.user;unloadVideo($videoPlaying,activeFrame.i!==data[normalizeIndex(repositionIndex)].i),frameDraw(activeIndexes,"stage"),stageFramePosition(SLOW?[dirtyIndex]:[dirtyIndex,getPrevIndex(dirtyIndex),getNextIndex(dirtyIndex)]),updateTouchTails("go",!0),silent||triggerEvent("show",{user:options.user,time:time}),pausedAutoplayFLAG=!0;var onEnd=that.show.onEnd=function(skipReposition){if(!onEnd.ok){if(onEnd.ok=!0,skipReposition||stageShaftReposition(!0),silent||triggerEvent("showend",{user:options.user}),!skipReposition&&o_transition&&o_transition!==opts.transition)return that.setOptions({transition:o_transition}),void(o_transition=!1);updateFotoramaState(),loadImg(activeIndexes,"stage"),updateTouchTails("go",!1),stageWheelUpdate(),stageCursor(),releaseAutoplay(),changeAutoplay()}};if(o_fade){var $activeFrame=activeFrame[STAGE_FRAME_KEY],$prevActiveFrame=activeIndex!==lastActiveIndex?data[lastActiveIndex][STAGE_FRAME_KEY]:null;fade($activeFrame,$prevActiveFrame,$stageFrame,{time:time,method:opts.transition,onEnd:onEnd},fadeStack)}else slide($stageShaft,{pos:-getPosByIndex(dirtyIndex,measures.w,opts.margin,repositionIndex),overPos:overPos,time:time,onEnd:onEnd});if(arrsUpdate(),o_nav){navUpdate();var guessIndex=limitIndex(activeIndex+minMaxLimit(dirtyIndex-lastActiveIndex,-1,1));slideNavShaft({time:time,coo:guessIndex!==activeIndex&&options.coo,guessIndex:"undefined"!=typeof options.coo?guessIndex:activeIndex,keep:silent}),o_navThumbs&&slideThumbBorder(time)}return showedFLAG="undefined"!=typeof lastActiveIndex&&lastActiveIndex!==activeIndex,lastActiveIndex=activeIndex,opts.hash&&showedFLAG&&!that.eq&&setHash(activeFrame.id||activeIndex+1),this},that.requestFullScreen=function(){return o_allowFullScreen&&!that.fullScreen&&(scrollTop=$WINDOW.scrollTop(),scrollLeft=$WINDOW.scrollLeft(),lockScroll($WINDOW),updateTouchTails("x",!0),measuresStash=$.extend({},measures),$fotorama.addClass(fullscreenClass).appendTo($BODY.addClass(_fullscreenClass)),$HTML.addClass(_fullscreenClass),unloadVideo($videoPlaying,!0,!0),that.fullScreen=!0,o_nativeFullScreen&&fullScreenApi.request(fotorama),that.resize(),loadImg(activeIndexes,"stage"),updateFotoramaState(),triggerEvent("fullscreenenter")),this},that.cancelFullScreen=function(){return o_nativeFullScreen&&fullScreenApi.is()?fullScreenApi.cancel(document):cancelFullScreen(),this},that.toggleFullScreen=function(){return that[(that.fullScreen?"cancel":"request")+"FullScreen"]()},addEvent(document,fullScreenApi.event,function(){!data||fullScreenApi.is()||$videoPlaying||cancelFullScreen()}),that.resize=function(options){if(!data)return this;var time=arguments[1]||0,setFLAG=arguments[2];extendMeasures(that.fullScreen?{width:"100%",maxwidth:null,minwidth:null,height:"100%",maxheight:null,minheight:null}:optionsToLowerCase(options),[measures,setFLAG||that.fullScreen||opts]);var width=measures.width,height=measures.height,ratio=measures.ratio,windowHeight=$WINDOW.height()-(o_nav?$nav.height():0);return measureIsValid(width)&&($wrap.addClass(wrapOnlyActiveClass).css({width:width,minWidth:measures.minwidth||0,maxWidth:measures.maxwidth||MAX_WIDTH}),width=measures.W=measures.w=$wrap.width(),measures.nw=o_nav&&numberFromWhatever(opts.navwidth,width)||width,opts.glimpse&&(measures.w-=Math.round(2*(numberFromWhatever(opts.glimpse,width)||0))),$stageShaft.css({width:measures.w,marginLeft:(measures.W-measures.w)/2}),height=numberFromWhatever(height,windowHeight),height=height||ratio&&width/ratio,height&&(width=Math.round(width),height=measures.h=Math.round(minMaxLimit(height,numberFromWhatever(measures.minheight,windowHeight),numberFromWhatever(measures.maxheight,windowHeight))),$stage.stop().animate({width:width,height:height},time,function(){$wrap.removeClass(wrapOnlyActiveClass)}),stageShaftReposition(),o_nav&&($nav.stop().animate({width:measures.nw},time),slideNavShaft({guessIndex:activeIndex,time:time,keep:!0}),o_navThumbs&&frameAppend.nav&&slideThumbBorder(time)),measuresSetFLAG=setFLAG||!0,ready())),stageLeft=$stage.offset().left,this},that.setOptions=function(options){return $.extend(opts,options),reset(),this},that.shuffle=function(){return data&&shuffle(data)&&reset(),this},that.destroy=function(){return that.cancelFullScreen(),that.stopAutoplay(),data=that.data=null,appendElements(),activeIndexes=[],detachFrames(STAGE_FRAME_KEY),reset.ok=!1,this},that.playVideo=function(){var dataFrame=activeFrame,video=dataFrame.video,_activeIndex=activeIndex;return"object"==typeof video&&dataFrame.videoReady&&(o_nativeFullScreen&&that.fullScreen&&that.cancelFullScreen(),waitFor(function(){return!fullScreenApi.is()||_activeIndex!==activeIndex},function(){_activeIndex===activeIndex&&(dataFrame.$video=dataFrame.$video||$($.Fotorama.jst.video(video)),dataFrame.$video.appendTo(dataFrame[STAGE_FRAME_KEY]),$wrap.addClass(wrapVideoClass),$videoPlaying=dataFrame.$video,stageNoMove(),$arrs.blur(),$fullscreenIcon.blur(),triggerEvent("loadvideo"))})),this},that.stopVideo=function(){return unloadVideo($videoPlaying,!0,!0),this},$stage.on("mousemove",stageCursor),stageShaftTouchTail=moveOnTouch($stageShaft,{onStart:onTouchStart,onMove:function(e,result){setShadow($stage,result.edge)},onTouchEnd:onTouchEnd,onEnd:function(result){setShadow($stage);var toggleControlsFLAG=(MS_POINTER&&!hoverFLAG||result.touch)&&opts.arrows&&"always"!==opts.arrows;if(result.moved||toggleControlsFLAG&&result.pos!==result.newPos&&!result.control){var index=getIndexByPos(result.newPos,measures.w,opts.margin,repositionIndex);that.show({index:index,time:o_fade?o_transitionDuration:result.time,overPos:result.overPos,user:!0})}else result.aborted||result.control||onStageTap(result.startEvent,toggleControlsFLAG)},timeLow:1,timeHigh:1,friction:2,select:"."+selectClass+", ."+selectClass+" *",$wrap:$stage}),navShaftTouchTail=moveOnTouch($navShaft,{onStart:onTouchStart,onMove:function(e,result){setShadow($nav,result.edge)},onTouchEnd:onTouchEnd,onEnd:function(result){function onEnd(){slideNavShaft.l=result.newPos,releaseAutoplay(),changeAutoplay(),thumbsDraw(result.newPos,!0)}if(result.moved)result.pos!==result.newPos?(pausedAutoplayFLAG=!0,slide($navShaft,{time:result.time,pos:result.newPos,overPos:result.overPos,onEnd:onEnd}),thumbsDraw(result.newPos),o_shadows&&setShadow($nav,findShadowEdge(result.newPos,navShaftTouchTail.min,navShaftTouchTail.max))):onEnd();else{var target=result.$target.closest("."+navFrameClass,$navShaft)[0];target&&onNavFrameClick.call(target,result.startEvent)}},timeLow:.5,timeHigh:2,friction:5,$wrap:$nav}),stageWheelTail=wheel($stage,{shift:!0,onEnd:function(e,direction){onTouchStart(),onTouchEnd(),that.show({index:direction,slow:e.altKey})}}),navWheelTail=wheel($nav,{onEnd:function(e,direction){onTouchStart(),onTouchEnd();var newPos=stop($navShaft)+.25*direction;$navShaft.css(getTranslate(minMaxLimit(newPos,navShaftTouchTail.min,navShaftTouchTail.max))),o_shadows&&setShadow($nav,findShadowEdge(newPos,navShaftTouchTail.min,navShaftTouchTail.max)),navWheelTail.prevent={"<":newPos>=navShaftTouchTail.max,">":newPos<=navShaftTouchTail.min},clearTimeout(navWheelTail.t),navWheelTail.t=setTimeout(function(){slideNavShaft.l=newPos,thumbsDraw(newPos,!0)},TOUCH_TIMEOUT),thumbsDraw(newPos)}}),$wrap.hover(function(){setTimeout(function(){touchedFLAG||toggleControlsClass(!(hoverFLAG=!0))},0)},function(){hoverFLAG&&toggleControlsClass(!(hoverFLAG=!1))}),smartClick($arrs,function(e){stopEvent(e),onArrClick.call(this,e);

},{onStart:function(){onTouchStart(),stageShaftTouchTail.control=!0},onTouchEnd:onTouchEnd}),$arrs.each(function(){addEnterUp(this,function(e){onArrClick.call(this,e)}),addFocusOnControls(this)}),addEnterUp(fullscreenIcon,that.toggleFullScreen),addFocusOnControls(fullscreenIcon),$.each("load push pop shift unshift reverse sort splice".split(" "),function(i,method){that[method]=function(){return data=data||[],"load"!==method?Array.prototype[method].apply(data,arguments):arguments[0]&&"object"==typeof arguments[0]&&arguments[0].length&&(data=clone(arguments[0])),reset(),that}}),reset()},$.fn.fotorama=function(opts){return this.each(function(){var that=this,$fotorama=$(this),fotoramaData=$fotorama.data(),fotorama=fotoramaData.fotorama;fotorama?fotorama.setOptions(opts,!0):waitFor(function(){return!isHidden(that)},function(){fotoramaData.urtext=$fotorama.html(),new $.Fotorama($fotorama,$.extend({},OPTIONS,window.fotoramaDefaults,opts,fotoramaData))})})},$.Fotorama.instances=[],$.Fotorama.cache={},$.Fotorama.measures={},$=$||{},$.Fotorama=$.Fotorama||{},$.Fotorama.jst=$.Fotorama.jst||{},$.Fotorama.jst.style=function(v){{var __t,__p="";_.escape}return __p+=".fotorama"+(null==(__t=v.s)?"":__t)+" .fotorama__nav--thumbs .fotorama__nav__frame{\npadding:"+(null==(__t=v.m)?"":__t)+"px;\nheight:"+(null==(__t=v.h)?"":__t)+"px}\n.fotorama"+(null==(__t=v.s)?"":__t)+" .fotorama__thumb-border{\nheight:"+(null==(__t=v.h-v.b*(v.q?0:2))?"":__t)+"px;\nborder-width:"+(null==(__t=v.b)?"":__t)+"px;\nmargin-top:"+(null==(__t=v.m)?"":__t)+"px}"},$.Fotorama.jst.video=function(v){function print(){__p+=__j.call(arguments,"")}var __p="",__j=(_.escape,Array.prototype.join);return __p+='<div class="fotorama__video"><iframe src="',print(("youtube"==v.type?v.p+"youtube.com/embed/"+v.id+"?autoplay=1":"vimeo"==v.type?v.p+"player.vimeo.com/video/"+v.id+"?autoplay=1&badge=0":v.id)+(v.s&&"custom"!=v.type?"&"+v.s:"")),__p+='" frameborder="0" allowfullscreen></iframe></div>\n'},$(function(){$("."+_fotoramaClass+':not([data-auto="false"])').fotorama()})}(window,document,location,"undefined"!=typeof jQuery&&jQuery),function($){$._jqache={},$._assigned=Array(),$._jqns=Array(),$._jqnsAssigned=Array(),$.q=function(selector,clear){var clear="undefined"!=typeof clear?clear:!1;return"undefined"==typeof $._jqache[selector]||clear?$._jqache[selector]=$("undefined"!=typeof $._assigned[selector]?$._assigned[selector]:selector):$._jqache[selector]},$.q.assign=function(options){var defaults={interval:0,namespace:void 0};return"undefined"==typeof options.selector?!1:("undefined"==typeof options.name&&(options.name=options.selector),options=$.extend({},defaults,options),"undefined"==typeof options.namespace?($._jqache[options.name]=$(options.selector),$._assigned[options.name]=options.selector,options.interval>0&&window.setInterval(function(){$._jqache[options.name]=$(options.selector)},1e3*options.interval),$._jqache[options.name]):($._jqache[options.namespace]="undefined"!=typeof $._jqache[options.namespace]?$._jqache[options.namespace]:Array(),$._jqache[options.namespace][options.name]=$(options.selector),$._jqns[options.namespace]="undefined"!=typeof $._jqns[options.namespace]?$._jqns[options.namespace]:Array(),$._jqns[options.namespace].push(options.name),$._jqnsAssigned[options.namespace]="undefined"!=typeof $._jqnsAssigned[options.namespace]?$._jqnsAssigned[options.namespace]:Array(),$._jqnsAssigned[options.namespace][options.name]=options.selector,options.interval>0&&window.setInterval(function(){$._jqache[options.namespace][options.name]=$(options.selector)},1e3*options.interval),"function"!=typeof $.q[options.namespace]&&($.q[options.namespace]=function(selector,clear){if("undefined"==typeof selector){var result=Array();for(var i in $._jqache[options.namespace])$._jqache[options.namespace].hasOwnProperty(i)&&result.push($.q[options.namespace](i)[0]);return $(result)}var clear="undefined"!=typeof clear?clear:!1;return"undefined"==typeof $._jqache[options.namespace][selector]||clear?"undefined"!=typeof $._jqache[options.namespace][selector]&&clear?$._jqache[options.namespace][selector]=$($._jqnsAssigned[options.namespace][selector]):void 0:$._jqache[options.namespace][selector]}),void 0))},$.q.clear=function(ns){"undefined"==typeof ns?$.each($._jqache,function(i){"undefined"==typeof $._jqns[i]?$.q(i,!0):$.q.clear(i)}):$.each($._jqns[ns],function(i,val){$.q[ns](val,!0)})}}(jQuery),function($){var $special,resizeTimeout,$event=$.event;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(event,execAsap){var context=this,args=arguments,dispatch=function(){event.type="debouncedresize",$event.dispatch.apply(context,args)};resizeTimeout&&clearTimeout(resizeTimeout),execAsap?dispatch():resizeTimeout=setTimeout(dispatch,$special.threshold)},threshold:150}}(jQuery),/*!
 * hoverIntent r7 // 2013.03.11 // jQuery 1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2013 Brian Cherne
 */
function($){$.fn.hoverIntent=function(handlerIn,handlerOut,selector){var cfg={interval:100,sensitivity:7,timeout:0};cfg="object"==typeof handlerIn?$.extend(cfg,handlerIn):$.isFunction(handlerOut)?$.extend(cfg,{over:handlerIn,out:handlerOut,selector:selector}):$.extend(cfg,{over:handlerIn,out:handlerIn,selector:handlerOut});var cX,cY,pX,pY,track=function(ev){cX=ev.pageX,cY=ev.pageY},compare=function(ev,ob){return ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t),Math.abs(pX-cX)+Math.abs(pY-cY)<cfg.sensitivity?($(ob).off("mousemove.hoverIntent",track),ob.hoverIntent_s=1,cfg.over.apply(ob,[ev])):(pX=cX,pY=cY,ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval),void 0)},delay=function(ev,ob){return ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t),ob.hoverIntent_s=0,cfg.out.apply(ob,[ev])},handleHover=function(e){var ev=jQuery.extend({},e),ob=this;ob.hoverIntent_t&&(ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)),"mouseenter"==e.type?(pX=ev.pageX,pY=ev.pageY,$(ob).on("mousemove.hoverIntent",track),1!=ob.hoverIntent_s&&(ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval))):($(ob).off("mousemove.hoverIntent",track),1==ob.hoverIntent_s&&(ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)))};return this.on({"mouseenter.hoverIntent":handleHover,"mouseleave.hoverIntent":handleHover},cfg.selector)}}(jQuery),function($,window,document,undefined){function Plugin(element,options){this.element=element,this.options=$.extend(!0,{},defaults,options),this.options.share=options.share,this._defaults=defaults,this._name=pluginName,this.init()}var pluginName="sharrre",defaults={className:"sharrre",share:{googlePlus:!1,facebook:!1,twitter:!1,digg:!1,delicious:!1,stumbleupon:!1,linkedin:!1,pinterest:!1},shareTotal:0,template:"",title:"",url:document.location.href,text:document.title,urlCurl:"sharrre.php",count:{},total:0,shorterTotal:!0,enableHover:!0,enableCounter:!0,enableTracking:!1,hover:function(){},hide:function(){},click:function(){},render:function(){},buttons:{googlePlus:{url:"",urlCount:!1,size:"medium",lang:"en-US",annotation:""},facebook:{url:"",urlCount:!1,action:"like",layout:"button_count",width:"",send:"false",faces:"false",colorscheme:"",font:"",lang:"en_US"},twitter:{url:"",urlCount:!1,count:"horizontal",hashtags:"",via:"",related:"",lang:"en"},digg:{url:"",urlCount:!1,type:"DiggCompact"},delicious:{url:"",urlCount:!1,size:"medium"},stumbleupon:{url:"",urlCount:!1,layout:"1"},linkedin:{url:"",urlCount:!1,counter:""},pinterest:{url:"",media:"",description:"",layout:"horizontal"}}},urlJson={googlePlus:"",facebook:"https://graph.facebook.com/fql?q=SELECT%20url,%20normalized_url,%20share_count,%20like_count,%20comment_count,%20total_count,commentsbox_count,%20comments_fbid,%20click_count%20FROM%20link_stat%20WHERE%20url=%27{url}%27&callback=?",twitter:"http://cdn.api.twitter.com/1/urls/count.json?url={url}&callback=?",digg:"http://services.digg.com/2.0/story.getInfo?links={url}&type=javascript&callback=?",delicious:"http://feeds.delicious.com/v2/json/urlinfo/data?url={url}&callback=?",stumbleupon:"",linkedin:"http://www.linkedin.com/countserv/count/share?format=jsonp&url={url}&callback=?",pinterest:"http://api.pinterest.com/v1/urls/count.json?url={url}&callback=?"},loadButton={googlePlus:function(self){var sett=self.options.buttons.googlePlus;$(self.element).find(".buttons").append('<div class="button googleplus"><div class="g-plusone" data-size="'+sett.size+'" data-href="'+(""!==sett.url?sett.url:self.options.url)+'" data-annotation="'+sett.annotation+'"></div></div>'),window.___gcfg={lang:self.options.buttons.googlePlus.lang};var loading=0;"undefined"==typeof gapi&&0==loading?(loading=1,function(){var po=document.createElement("script");po.type="text/javascript",po.async=!0,po.src="//apis.google.com/js/plusone.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(po,s)}()):gapi.plusone.go()},facebook:function(self){var sett=self.options.buttons.facebook;$(self.element).find(".buttons").append('<div class="button facebook"><div id="fb-root"></div><div class="fb-like" data-href="'+(""!==sett.url?sett.url:self.options.url)+'" data-send="'+sett.send+'" data-layout="'+sett.layout+'" data-width="'+sett.width+'" data-show-faces="'+sett.faces+'" data-action="'+sett.action+'" data-colorscheme="'+sett.colorscheme+'" data-font="'+sett.font+'" data-via="'+sett.via+'"></div></div>');var loading=0;"undefined"==typeof FB&&0==loading?(loading=1,function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src="//connect.facebook.net/"+sett.lang+"/all.js#xfbml=1",fjs.parentNode.insertBefore(js,fjs))}(document,"script","facebook-jssdk")):FB.XFBML.parse()},twitter:function(self){var sett=self.options.buttons.twitter;$(self.element).find(".buttons").append('<div class="button twitter"><a href="https://twitter.com/share" class="twitter-share-button" data-url="'+(""!==sett.url?sett.url:self.options.url)+'" data-count="'+sett.count+'" data-text="'+self.options.text+'" data-via="'+sett.via+'" data-hashtags="'+sett.hashtags+'" data-related="'+sett.related+'" data-lang="'+sett.lang+'">Tweet</a></div>');var loading=0;"undefined"==typeof twttr&&0==loading?(loading=1,function(){var twitterScriptTag=document.createElement("script");twitterScriptTag.type="text/javascript",twitterScriptTag.async=!0,twitterScriptTag.src="//platform.twitter.com/widgets.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(twitterScriptTag,s)}()):$.ajax({url:"//platform.twitter.com/widgets.js",dataType:"script",cache:!0})},digg:function(self){var sett=self.options.buttons.digg;$(self.element).find(".buttons").append('<div class="button digg"><a class="DiggThisButton '+sett.type+'" rel="nofollow external" href="http://digg.com/submit?url='+encodeURIComponent(""!==sett.url?sett.url:self.options.url)+'"></a></div>');var loading=0;"undefined"==typeof __DBW&&0==loading&&(loading=1,function(){var s=document.createElement("SCRIPT"),s1=document.getElementsByTagName("SCRIPT")[0];s.type="text/javascript",s.async=!0,s.src="//widgets.digg.com/buttons.js",s1.parentNode.insertBefore(s,s1)}())},delicious:function(self){if("tall"==self.options.buttons.delicious.size)var css="width:50px;",cssCount="height:35px;width:50px;font-size:15px;line-height:35px;",cssShare="height:18px;line-height:18px;margin-top:3px;";else var css="width:93px;",cssCount="float:right;padding:0 3px;height:20px;width:26px;line-height:20px;",cssShare="float:left;height:20px;line-height:20px;";var count=self.shorterTotal(self.options.count.delicious);"undefined"==typeof count&&(count=0),$(self.element).find(".buttons").append('<div class="button delicious"><div style="'+css+'font:12px Arial,Helvetica,sans-serif;cursor:pointer;color:#666666;display:inline-block;float:none;height:20px;line-height:normal;margin:0;padding:0;text-indent:0;vertical-align:baseline;"><div style="'+cssCount+'background-color:#fff;margin-bottom:5px;overflow:hidden;text-align:center;border:1px solid #ccc;border-radius:3px;">'+count+'</div><div style="'+cssShare+'display:block;padding:0;text-align:center;text-decoration:none;width:50px;background-color:#7EACEE;border:1px solid #40679C;border-radius:3px;color:#fff;"><img src="http://www.delicious.com/static/img/delicious.small.gif" height="10" width="10" alt="Delicious" /> Add</div></div></div>'),$(self.element).find(".delicious").on("click",function(){self.openPopup("delicious")})},stumbleupon:function(self){var sett=self.options.buttons.stumbleupon;$(self.element).find(".buttons").append('<div class="button stumbleupon"><su:badge layout="'+sett.layout+'" location="'+(""!==sett.url?sett.url:self.options.url)+'"></su:badge></div>');var loading=0;"undefined"==typeof STMBLPN&&0==loading?(loading=1,function(){var li=document.createElement("script");li.type="text/javascript",li.async=!0,li.src="//platform.stumbleupon.com/1/widgets.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(li,s)}(),s=window.setTimeout(function(){"undefined"!=typeof STMBLPN&&(STMBLPN.processWidgets(),clearInterval(s))},500)):STMBLPN.processWidgets()},linkedin:function(self){var sett=self.options.buttons.linkedin;$(self.element).find(".buttons").append('<div class="button linkedin"><script type="in/share" data-url="'+(""!==sett.url?sett.url:self.options.url)+'" data-counter="'+sett.counter+'"></script></div>');var loading=0;"undefined"==typeof window.IN&&0==loading?(loading=1,function(){var li=document.createElement("script");li.type="text/javascript",li.async=!0,li.src="//platform.linkedin.com/in.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(li,s)}()):window.IN.init()},pinterest:function(self){var sett=self.options.buttons.pinterest;$(self.element).find(".buttons").append('<div class="button pinterest"><a href="http://pinterest.com/pin/create/button/?url='+(""!==sett.url?sett.url:self.options.url)+"&media="+sett.media+"&description="+sett.description+'" class="pin-it-button" count-layout="'+sett.layout+'">Pin It</a></div>'),function(){var li=document.createElement("script");li.type="text/javascript",li.async=!0,li.src="//assets.pinterest.com/js/pinit.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(li,s)}()}},tracking={googlePlus:function(){},facebook:function(){fb=window.setInterval(function(){"undefined"!=typeof FB&&(FB.Event.subscribe("edge.create",function(targetUrl){_gaq.push(["_trackSocial","facebook","like",targetUrl])}),FB.Event.subscribe("edge.remove",function(targetUrl){_gaq.push(["_trackSocial","facebook","unlike",targetUrl])}),FB.Event.subscribe("message.send",function(targetUrl){_gaq.push(["_trackSocial","facebook","send",targetUrl])}),clearInterval(fb))},1e3)},twitter:function(){tw=window.setInterval(function(){"undefined"!=typeof twttr&&(twttr.events.bind("tweet",function(event){event&&_gaq.push(["_trackSocial","twitter","tweet"])}),clearInterval(tw))},1e3)},digg:function(){},delicious:function(){},stumbleupon:function(){},linkedin:function(){},pinterest:function(){}},popup={googlePlus:function(opt){window.open("https://plus.google.com/share?hl="+opt.buttons.googlePlus.lang+"&url="+encodeURIComponent(""!==opt.buttons.googlePlus.url?opt.buttons.googlePlus.url:opt.url),"","toolbar=0, status=0, width=900, height=500")},facebook:function(opt){window.open("http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(""!==opt.buttons.facebook.url?opt.buttons.facebook.url:opt.url)+"&t="+opt.text,"","toolbar=0, status=0, width=900, height=500")},twitter:function(opt){window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(opt.text)+"&url="+encodeURIComponent(""!==opt.buttons.twitter.url?opt.buttons.twitter.url:opt.url)+(""!==opt.buttons.twitter.via?"&via="+opt.buttons.twitter.via:""),"","toolbar=0, status=0, width=650, height=360")},digg:function(opt){window.open("http://digg.com/tools/diggthis/submit?url="+encodeURIComponent(""!==opt.buttons.digg.url?opt.buttons.digg.url:opt.url)+"&title="+opt.text+"&related=true&style=true","","toolbar=0, status=0, width=650, height=360")},delicious:function(opt){window.open("http://www.delicious.com/save?v=5&noui&jump=close&url="+encodeURIComponent(""!==opt.buttons.delicious.url?opt.buttons.delicious.url:opt.url)+"&title="+opt.text,"delicious","toolbar=no,width=550,height=550")},stumbleupon:function(opt){window.open("http://www.stumbleupon.com/badge/?url="+encodeURIComponent(""!==opt.buttons.delicious.url?opt.buttons.delicious.url:opt.url),"stumbleupon","toolbar=no,width=550,height=550")},linkedin:function(opt){window.open("https://www.linkedin.com/cws/share?url="+encodeURIComponent(""!==opt.buttons.delicious.url?opt.buttons.delicious.url:opt.url)+"&token=&isFramed=true","linkedin","toolbar=no,width=550,height=550")},pinterest:function(opt){window.open("http://pinterest.com/pin/create/button/?url="+encodeURIComponent(""!==opt.buttons.pinterest.url?opt.buttons.pinterest.url:opt.url)+"&media="+encodeURIComponent(opt.buttons.pinterest.media)+"&description="+opt.buttons.pinterest.description,"pinterest","toolbar=no,width=700,height=300")}};Plugin.prototype.init=function(){var self=this;""!==this.options.urlCurl&&(urlJson.googlePlus=this.options.urlCurl+"?url={url}&type=googlePlus",urlJson.stumbleupon=this.options.urlCurl+"?url={url}&type=stumbleupon"),$(this.element).addClass(this.options.className),"undefined"!=typeof $(this.element).data("title")&&(this.options.title=$(this.element).attr("data-title")),"undefined"!=typeof $(this.element).data("url")&&(this.options.url=$(this.element).data("url")),"undefined"!=typeof $(this.element).data("text")&&(this.options.text=$(this.element).data("text")),$.each(this.options.share,function(name,val){val===!0&&self.options.shareTotal++}),self.options.enableCounter===!0?$.each(this.options.share,function(name,val){if(val===!0)try{self.getSocialJson(name)}catch(e){}}):""!==self.options.template?this.options.render(this,this.options):this.loadButtons(),$(this.element).hover(function(){0===$(this).find(".buttons").length&&self.options.enableHover===!0&&self.loadButtons(),self.options.hover(self,self.options)},function(){self.options.hide(self,self.options)})},Plugin.prototype.loadButtons=function(){var self=this;$(this.element).append('<div class="buttons"></div>'),$.each(self.options.share,function(name,val){1==val&&(loadButton[name](self),self.options.enableTracking===!0&&tracking[name]())})},Plugin.prototype.getSocialJson=function(name){var self=this,count=0,url=urlJson[name].replace("{url}",encodeURIComponent(this.options.url));this.options.buttons[name].urlCount===!0&&""!==this.options.buttons[name].url&&(url=urlJson[name].replace("{url}",this.options.buttons[name].url)),""!=url&&""!==self.options.urlCurl?$.getJSON(url,function(json){if("undefined"!=typeof json.count){var temp=json.count+"";temp=temp.replace("",""),count+=parseInt(temp,10)}else json.data&&json.data.length>0&&"undefined"!=typeof json.data[0].total_count?count+=parseInt(json.data[0].total_count,10):"undefined"!=typeof json[0]?count+=parseInt(json[0].total_posts,10):"undefined"!=typeof json[0];self.options.count[name]=count,self.options.total+=count,self.renderer(),self.rendererPerso()}).error(function(){self.options.count[name]=0,self.rendererPerso()}):(self.renderer(),self.options.count[name]=0,self.rendererPerso())},Plugin.prototype.rendererPerso=function(){var shareCount=0;for(e in this.options.count)shareCount++;shareCount===this.options.shareTotal&&this.options.render(this,this.options)},Plugin.prototype.renderer=function(){var total=this.options.total,template=this.options.template;this.options.shorterTotal===!0&&(total=this.shorterTotal(total)),""!==template?(template=template.replace("{total}",total),$(this.element).html(template)):$(this.element).html('<div class="box"><a class="count" href="#">'+total+"</a>"+(""!==this.options.title?'<a class="share" href="#">'+this.options.title+"</a>":"")+"</div>")},Plugin.prototype.shorterTotal=function(num){return num>=1e6?num=(num/1e6).toFixed(2)+"M":num>=1e3&&(num=(num/1e3).toFixed(1)+"k"),num},Plugin.prototype.openPopup=function(site){if(popup[site](this.options),this.options.enableTracking===!0){var tracking={googlePlus:{site:"Google",action:"+1"},facebook:{site:"facebook",action:"like"},twitter:{site:"twitter",action:"tweet"},digg:{site:"digg",action:"add"},delicious:{site:"delicious",action:"add"},stumbleupon:{site:"stumbleupon",action:"add"},linkedin:{site:"linkedin",action:"share"},pinterest:{site:"pinterest",action:"pin"}};_gaq.push(["_trackSocial",tracking[site].site,tracking[site].action])}},Plugin.prototype.simulateClick=function(){var html=$(this.element).html();$(this.element).html(html.replace(this.options.total,this.options.total+1))},Plugin.prototype.update=function(url,text){""!==url&&(this.options.url=url),""!==text&&(this.options.text=text)},$.fn[pluginName]=function(options){var args=arguments;return options===undefined||"object"==typeof options?this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new Plugin(this,options))}):"string"==typeof options&&"_"!==options[0]&&"init"!==options?this.each(function(){var instance=$.data(this,"plugin_"+pluginName);instance instanceof Plugin&&"function"==typeof instance[options]&&instance[options].apply(instance,Array.prototype.slice.call(args,1))}):void 0}}(jQuery,window,document),/*! Superslides - v0.6.3-wip - 2013-12-17
* https://github.com/nicinabox/superslides
* Copyright (c) 2013 Nic Aitch; Licensed MIT */
function(window,$){var Superslides,plugin="superslides";Superslides=function(el,options){this.options=$.extend({play:!1,animation_speed:600,animation_easing:"swing",animation:"slide",inherit_width_from:window,inherit_height_from:window,pagination:!0,hashchange:!1,scrollable:!0,key_navigation:!0,elements:{preserve:".preserve",nav:".slides-navigation",container:".slides-container",pagination:".slides-pagination"}},options);var that=this,$control=$("<div>",{"class":"slides-control"}),multiplier=1;this.$el=$(el),this.$container=this.$el.find(this.options.elements.container);var initialize=function(){return multiplier=that._findMultiplier(),that.$el.on("click",that.options.elements.nav+" a",function(e){e.preventDefault(),that.stop(),$(this).hasClass("next")?that.animate("next",function(){that.start()}):that.animate("prev",function(){that.start()})}),that.options.key_navigation&&$(document).on("keyup",function(e){37===e.keyCode&&that.animate("prev"),39===e.keyCode&&that.animate("next")}),$(window).on("resize",function(){setTimeout(function(){var $children=that.$container.children();that.width=that._findWidth(),that.height=that._findHeight(),$children.css({width:that.width,left:that.width}),that.css.containers(),that.css.images()},10)}),that.options.hashchange&&$(window).on("hashchange",function(){var index,hash=that._parseHash();index=that._upcomingSlide(hash),index>=0&&index!==that.current&&that.animate(index)}),that.pagination._events(),that.start(),that},css={containers:function(){that.init?(that.$el.css({height:that.height}),that.$control.css({width:that.width*multiplier,left:-that.width}),that.$container.css({})):($("body").css({margin:0}),that.$el.css({position:"relative",overflow:"hidden",width:"100%",height:that.height}),that.$control.css({position:"relative",transform:"translate3d(0)",height:"100%",width:that.width*multiplier,left:-that.width}),that.$container.css({display:"none",margin:"0",padding:"0",listStyle:"none",position:"relative",height:"100%"})),1===that.size()&&that.$el.find(that.options.elements.nav).hide()},images:function(){var $images=that.$container.find("img").not(that.options.elements.preserve);$images.removeAttr("width").removeAttr("height").css({"-webkit-backface-visibility":"hidden","-ms-interpolation-mode":"bicubic",position:"absolute",left:"0",top:"0","z-index":"-1","max-width":"none"}),$images.each(function(){var image_aspect_ratio=that.image._aspectRatio(this),image=this;if($.data(this,"processed"))that.image._scale(image,image_aspect_ratio),that.image._center(image,image_aspect_ratio);else{var img=new Image;img.onload=function(){that.image._scale(image,image_aspect_ratio),that.image._center(image,image_aspect_ratio),$.data(image,"processed",!0)},img.src=this.src}})},children:function(){var $children=that.$container.children();$children.is("img")&&($children.each(function(){if($(this).is("img")){$(this).wrap("<div>");var id=$(this).attr("id");$(this).removeAttr("id"),$(this).parent().attr("id",id)}}),$children=that.$container.children()),that.init||$children.css({display:"none",left:2*that.width}),$children.css({position:"absolute",overflow:"hidden",height:"100%",width:that.width,top:0,zIndex:0})}},fx={slide:function(orientation,complete){var $children=that.$container.children(),$target=$children.eq(orientation.upcoming_slide);$target.css({left:orientation.upcoming_position,display:"block"}),that.$control.animate({left:orientation.offset},that.options.animation_speed,that.options.animation_easing,function(){that.size()>1&&(that.$control.css({left:-that.width}),$children.eq(orientation.upcoming_slide).css({left:that.width,zIndex:2}),orientation.outgoing_slide>=0&&$children.eq(orientation.outgoing_slide).css({left:that.width,display:"none",zIndex:0})),complete()})},fade:function(orientation,complete){var that=this,$children=that.$container.children(),$outgoing=$children.eq(orientation.outgoing_slide),$target=$children.eq(orientation.upcoming_slide);$target.css({left:this.width,opacity:0,display:"block"}).animate({opacity:1},that.options.animation_speed,that.options.animation_easing),orientation.outgoing_slide>=0?$outgoing.animate({opacity:0},that.options.animation_speed,that.options.animation_easing,function(){that.size()>1&&($children.eq(orientation.upcoming_slide).css({zIndex:2}),orientation.outgoing_slide>=0&&$children.eq(orientation.outgoing_slide).css({opacity:1,display:"none",zIndex:0})),complete()}):($target.css({zIndex:2}),complete())}};fx=$.extend(fx,$.fn.superslides.fx);var image={_centerY:function(image){var $img=$(image);$img.css({top:(that.height-$img.height())/2})},_centerX:function(image){var $img=$(image);$img.css({left:(that.width-$img.width())/2})},_center:function(image){that.image._centerX(image),that.image._centerY(image)},_aspectRatio:function(image){if(!image.naturalHeight&&!image.naturalWidth){var img=new Image;img.src=image.src,image.naturalHeight=img.height,image.naturalWidth=img.width}return image.naturalHeight/image.naturalWidth},_scale:function(image,image_aspect_ratio){image_aspect_ratio=image_aspect_ratio||that.image._aspectRatio(image);var container_aspect_ratio=that.height/that.width,$img=$(image);$img.css(container_aspect_ratio>image_aspect_ratio?{height:that.height,width:that.height/image_aspect_ratio}:{height:that.width*image_aspect_ratio,width:that.width})}},pagination={_setCurrent:function(i){if(that.$pagination){var $pagination_children=that.$pagination.children();$pagination_children.removeClass("current"),$pagination_children.eq(i).addClass("current")}},_addItem:function(i){var slide_number=i+1,href=slide_number,$slide=that.$container.children().eq(i),slide_id=$slide.attr("id");slide_id&&(href=slide_id);var $item=$("<a>",{href:"#"+href,text:href});$item.appendTo(that.$pagination)},_setup:function(){if(that.options.pagination&&1!==that.size()){var $pagination=$("<nav>",{"class":that.options.elements.pagination.replace(/^\./,"")});that.$pagination=$pagination.appendTo(that.$el);for(var i=0;i<that.size();i++)that.pagination._addItem(i)}},_events:function(){that.$el.on("click",that.options.elements.pagination+" a",function(e){e.preventDefault();var index,hash=that._parseHash(this.hash);index=that._upcomingSlide(hash,!0),index!==that.current&&that.animate(index,function(){that.start()})})}};return this.css=css,this.image=image,this.pagination=pagination,this.fx=fx,this.animation=this.fx[this.options.animation],this.$control=this.$container.wrap($control).parent(".slides-control"),that._findPositions(),that.width=that._findWidth(),that.height=that._findHeight(),this.css.children(),this.css.containers(),this.css.images(),this.pagination._setup(),initialize()},Superslides.prototype={_findWidth:function(){return $(this.options.inherit_width_from).width()},_findHeight:function(){return $(this.options.inherit_height_from).height()},_findMultiplier:function(){return 1===this.size()?1:3},_upcomingSlide:function(direction,from_hash_change){if(from_hash_change&&!isNaN(direction)&&(direction-=1),/next/.test(direction))return this._nextInDom();if(/prev/.test(direction))return this._prevInDom();if(/\d/.test(direction))return+direction;if(direction&&/\w/.test(direction)){var index=this._findSlideById(direction);return index>=0?index:0}return 0},_findSlideById:function(id){return this.$container.find("#"+id).index()},_findPositions:function(current,thisRef){thisRef=thisRef||this,void 0===current&&(current=-1),thisRef.current=current,thisRef.next=thisRef._nextInDom(),thisRef.prev=thisRef._prevInDom()},_nextInDom:function(){var index=this.current+1;return index===this.size()&&(index=0),index},_prevInDom:function(){var index=this.current-1;return 0>index&&(index=this.size()-1),index},_parseHash:function(hash){return hash=hash||window.location.hash,hash=hash.replace(/^#/,""),hash&&!isNaN(+hash)&&(hash=+hash),hash},size:function(){return this.$container.children().length},destroy:function(){return this.$el.removeData()},update:function(){this.css.children(),this.css.containers(),this.css.images(),this.pagination._addItem(this.size()),this._findPositions(this.current),this.$el.trigger("updated.slides")},stop:function(){clearInterval(this.play_id),delete this.play_id,this.$el.trigger("stopped.slides")},start:function(){var that=this;that.options.hashchange?$(window).trigger("hashchange"):this.animate(),this.options.play&&(this.play_id&&this.stop(),this.play_id=setInterval(function(){that.animate()},this.options.play)),this.$el.trigger("started.slides")},animate:function(direction,userCallback){var that=this,orientation={};if(!(this.animating||(this.animating=!0,void 0===direction&&(direction="next"),orientation.upcoming_slide=this._upcomingSlide(direction),orientation.upcoming_slide>=this.size()))){if(orientation.outgoing_slide=this.current,orientation.upcoming_position=2*this.width,orientation.offset=-orientation.upcoming_position,("prev"===direction||direction<orientation.outgoing_slide)&&(orientation.upcoming_position=0,orientation.offset=0),that.size()>1&&that.pagination._setCurrent(orientation.upcoming_slide),that.options.hashchange){var hash=orientation.upcoming_slide+1,id=that.$container.children(":eq("+orientation.upcoming_slide+")").attr("id");window.location.hash=id?id:hash}that.$el.trigger("animating.slides",[orientation]),that.animation(orientation,function(){that._findPositions(orientation.upcoming_slide,that),"function"==typeof userCallback&&userCallback(),that.animating=!1,that.$el.trigger("animated.slides"),that.init||(that.$el.trigger("init.slides"),that.init=!0,that.$container.fadeIn("fast"))})}}},$.fn[plugin]=function(option,args){var result=[];return this.each(function(){var $this,data,options;return $this=$(this),data=$this.data(plugin),options="object"==typeof option&&option,data||(result=$this.data(plugin,data=new Superslides(this,options))),"string"==typeof option&&(result=data[option],"function"==typeof result)?result=result.call(data,args):void 0}),result},$.fn[plugin].fx={}}(this,jQuery);